"use strict";!function(){var e="undefined"!=typeof exports?exports:self,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function r(e){this.message=e}r.prototype=new Error,r.prototype.name="InvalidCharacterError",e.btoa||(e.btoa=function(e){for(var i,s,n=String(e),a=0,o=t,d="";n.charAt(0|a)||(o="=",a%1);d+=o.charAt(63&i>>8-a%1*8)){if((s=n.charCodeAt(a+=.75))>255)throw new r("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");i=i<<8|s}return d}),e.atob||(e.atob=function(e){var i=String(e).replace(/=+$/,"");if(i.length%4==1)throw new r("'atob' failed: The string to be decoded is not correctly encoded.");for(var s,n,a=0,o=0,d="";n=i.charAt(o++);~n&&(s=a%4?64*s+n:n,a++%4)?d+=String.fromCharCode(255&s>>(-2*a&6)):0)n=t.indexOf(n);return d})}();var Sha1={};Sha1.hash=function(e){e=e.utf8Encode();for(var t=[1518500249,1859775393,2400959708,3395469782],r=(e+=String.fromCharCode(128)).length/4+2,i=Math.ceil(r/16),s=new Array(i),n=0;n<i;n++){s[n]=new Array(16);for(var a=0;a<16;a++)s[n][a]=e.charCodeAt(64*n+4*a)<<24|e.charCodeAt(64*n+4*a+1)<<16|e.charCodeAt(64*n+4*a+2)<<8|e.charCodeAt(64*n+4*a+3)}s[i-1][14]=8*(e.length-1)/Math.pow(2,32),s[i-1][14]=Math.floor(s[i-1][14]),s[i-1][15]=8*(e.length-1)&4294967295;var o,d,c,p,u,l=1732584193,h=4023233417,v=2562383102,f=271733878,m=3285377520,g=new Array(80);for(n=0;n<i;n++){for(var _=0;_<16;_++)g[_]=s[n][_];for(_=16;_<80;_++)g[_]=Sha1.ROTL(g[_-3]^g[_-8]^g[_-14]^g[_-16],1);o=l,d=h,c=v,p=f,u=m;for(_=0;_<80;_++){var y=Math.floor(_/20),b=Sha1.ROTL(o,5)+Sha1.f(y,d,c,p)+u+t[y]+g[_]&4294967295;u=p,p=c,c=Sha1.ROTL(d,30),d=o,o=b}l=l+o&4294967295,h=h+d&4294967295,v=v+c&4294967295,f=f+p&4294967295,m=m+u&4294967295}return Sha1.toHexStr(l)+Sha1.toHexStr(h)+Sha1.toHexStr(v)+Sha1.toHexStr(f)+Sha1.toHexStr(m)},Sha1.f=function(e,t,r,i){switch(e){case 0:return t&r^~t&i;case 1:return t^r^i;case 2:return t&r^t&i^r&i;case 3:return t^r^i}},Sha1.ROTL=function(e,t){return e<<t|e>>>32-t},Sha1.toHexStr=function(e){for(var t="",r=7;r>=0;r--)t+=(e>>>4*r&15).toString(16);return t},void 0===String.prototype.utf8Encode&&(String.prototype.utf8Encode=function(){return unescape(encodeURIComponent(this))}),void 0===String.prototype.utf8Decode&&(String.prototype.utf8Decode=function(){try{return decodeURIComponent(escape(this))}catch(e){return this}}),"undefined"!=typeof module&&module.exports&&(module.exports=Sha1),function(e){!function(e){e.enabled=function(){return!!localStorage},e.read=function(e,t){if(void 0===t&&(t=void 0),!localStorage)return t;try{return localStorage.getItem(e)||t}catch(e){return t}},e.write=function(e,t){if(localStorage)try{localStorage.setItem(e,t)}catch(e){}},e.del=function(e){if(localStorage)try{localStorage.removeItem(e)}catch(e){}}}(e.lstorage||(e.lstorage={}))}(advark||(advark={})),function(e){if(!e.setImmediate){e.setImmediate=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];0,new Date;var i=!1,s=!0,n=function(r){i||s||(i=!0,window.removeEventListener("message",o),window.clearTimeout(a),e.apply(void 0,t))},a=window.setTimeout(function(){return n()},0),o=function(e){return n()};window.addEventListener("message",o),window.postMessage({},"*"),s=!1}}}(advark||(advark={})),function(e){for(var t=["ms","moz","webkit","o"],r=0;r<t.length&&!e.requestAnimationFrame;r++)e.requestAnimationFrame=window[t[r]+"RequestAnimationFrame"];if(!e.requestAnimationFrame){var i=0;e.requestAnimationFrame=function(e){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),s=window.setTimeout(function(){e(t+r)},r);return i=t+r,s}}e.requestAnimationFrame=e.requestAnimationFrame.bind(window)}(advark||(advark={})),advark||(advark={}),Date.prototype.toISOString||function(){function e(e){var t=String(e);return 1===t.length&&(t="0"+t),t}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(),function(e){var t,r;t=e.spromise||(e.spromise={}),r=function(){function e(e,t){this._defferPending=e instanceof Function?e:function(r){return r(e,t)}}return e.prototype.then=function(t,r){var i=this;return this._defferPending(function(s,n,a){var o,d=n?r:t;try{var c=d instanceof Function?d.call(void 0,s):void 0===d?s:d;if(c instanceof e){if(c===i)throw"TypeError";o=c.then(function(e){return a?a.resolve(e):e},function(e){return a?a.reject(e):e})}else if(c instanceof Object&&c.then instanceof Function){var p=!1;c.then(function(e){p||(p=!0,s=e,n=!1)},function(e){p||(p=!0,s=e,n=!0)})}else s=c}catch(e){s=e,n=!0}return o||(a?n?a.reject(s):a.resolve(s):new e(s,n))})},e.prototype.catch=function(e){return this.then(void 0,e)},e.prototype.anycase=function(e){return this.then(e,e)},e.prototype.inspect=function(t){var r=function(r,i){return t(r,i),new e(r,!i)};return this.then(function(e){return r(e,!0)},function(e){return r(e,!1)})},e}(),t.Promise=r}(advark||(advark={})),function(e){!function(e){var t,r;(r=t||(t={}))[r.pending=0]="pending",r[r.resolved=1]="resolved",r[r.rejected=2]="rejected";var i=function(){function r(){var i=this;this._state=t.pending,this._recs=[];this.promise=new e.Promise(function(e){if(i._state!==t.pending)return e(i._result,i._state===t.rejected);var s=new r;return i._recs.push({deffer:s,complete:e}),s.promise})}return r.prototype.resolve=function(e){return this._complete(e,!1)},r.prototype.reject=function(e){return this._complete(e,!0)},r.prototype._complete=function(e,r){if(this._state===t.pending){for(var i=0;i<this._recs.length;i++)this._recs[i].complete(e,r,this._recs[i].deffer);this._recs=[],this._state=r?t.rejected:t.resolved,this._result=e}return this.promise},r}();e.Deffer=i}(e.spromise||(e.spromise={}))}(advark||(advark={})),function(e){!function(e){function t(){return new e.Deffer}function r(e){var r=t();return e(function(e){return r.resolve(e)},function(e){return r.reject(e)}),r.promise}function i(t){return new e.Promise(t,!1)}function s(e){if(!(e instanceof Array)||0==e.length)return i();for(var r=t(),s=0;s<e.length;s++)(e[s]&&e[s].then?e[s]:i()).then(function(e){r.resolve(e)},function(e){r.reject(e)});return r.promise}e.deffer=t,e.promise=r,e.resolved=i,e.rejected=function(t){return new e.Promise(t,!0)},e.join=function(e){if(!(e instanceof Array)||0==e.length)return i(e);for(var r=t(),s=e.length,n=[],a=[],o=function(t,i){t.push(i),0==--s&&r.resolve(e)},d=0;d<e.length;d++)(e[d]&&e[d].then?e[d]:i()).then(function(e){o(n,e)},function(e){o(a,e)});return r.promise},e.any=function(e){if(!(e instanceof Array)||0==e.length)return i(e);for(var r=t(),s=e.length,n={resolved:[],rejected:[]},a=0;a<e.length;a++)(e[a]&&e[a].then?e[a]:i()).then(function(e){r.resolve(e)},function(e){n.rejected.push(e),0==--s&&r.reject(n.rejected)});return r.promise},e.all=function(e){var r={resolved:[],rejected:[]};if(!(e instanceof Array)||0==e.length)return i(r);for(var s=t(),n=e.length,a=0;a<e.length;a++)(e[a]&&e[a].then?e[a]:i()).then(function(e){r.resolved.push(e),0==--n&&s.resolve(r)},function(e){s.reject(e)});return s.promise},e.race=s,e.timeout=function(e,t,i){return s([e,r(function(e,r){setTimeout(function(){r(i)},t)})])},e.wrap=function(e){var r=t();return e&&e.then?e.then(function(e){r.resolve(e)},function(e){r.reject(e)}):r.reject("Not a promise"),r.promise}}(e.spromise||(e.spromise={}))}(advark||(advark={})),function(e){!function(t){(e.request||(e.request={})).send=function(t,r,i,s,n,a,o,d){void 0===i&&(i=!0),void 0===s&&(s=!0),void 0===n&&(n=void 0),void 0===a&&(a=void 0),void 0===o&&(o=void 0),void 0===d&&(d=void 0);var c=!1,p=new Date;function u(t){s?e.setImmediate(t):t()}function l(e){if(c||!e)return!0;c=!0,clearTimeout(_);for(var t=0,r=["onload","onerror","ontimeout","onreadystatechange"];t<r.length;t++){var i=r[t];try{e[i]&&(e[i]=void 0,delete e[i])}catch(e){}}return!1}function h(){l(g)||u(function(){return d&&d({uri:r,delay:(new Date).getTime()-p.getTime(),succeed:!0,code:g.status||200,text:g.responseText})})}function v(e){void 0===e&&(e=void 0),l(g)||u(function(){return d&&d({uri:r,delay:(new Date).getTime()-p.getTime(),succeed:!1,code:g.status||400,error:e?e.message:"Request error",text:g.responseText})})}function f(){l(g)||u(function(){return d&&d({uri:r,delay:(new Date).getTime()-p.getTime(),succeed:!1,code:g.status||408,error:"Request timeout",text:g.responseText})})}function m(){4==g.readyState&&(200==g.status||304==g.status?h():v())}var g=new XMLHttpRequest,_=n?setTimeout(f,n):void 0;u(function(){try{if("withCredentials"in g)g.onreadystatechange=m,g.onerror=v,g.ontimeout=f;else{if(!window.XDomainRequest)throw new Error("Unable to create HTTP-request object");(g=new window.XDomainRequest).onload=h,g.onerror=v}if(g.open(t,r,!0),n&&(g.timeout=n),i&&(g.withCredentials=i),a)for(var e in a)g.setRequestHeader(e,a[e]);g.send(o)}catch(e){v(e)}})}}()}(advark||(advark={})),function(e){!function(t){(e.track||(e.track={})).send=function(e,t){!function(e,t){var r=document.createElement("img");r.style.position="absolute",r.style.width="0",r.style.height="0",r.style.border="base",r.style.margin="0",r.style.padding="0",r.src=e;var i=new Date,s=function(s){r.parentNode&&r.parentNode.removeChild(r),t&&t({uri:e,delay:(new Date).getTime()-i.getTime(),succeed:!s.error,code:s.error?404:200,error:s.error})};r.onload=s,r.onerror=s,document.body.appendChild(r)}(e,t)}}()}(advark||(advark={})),function(e){!function(t){var r="//api.advarkads.com/pub/logger/geo",i=200,s="h:5";(e.devstat||(e.devstat={})).send=function(t,n,a,o){!function(t,s,n,a,o){var d=function(e){return encodeURIComponent(btoa(encodeURIComponent(e)))},c={i:d(t?t.substr(0,i):""),g:d(s?s.substr(0,i):""),m:d(n?n.substr(0,i):""),d:a?d(a instanceof Node||a instanceof XMLDocument?(new XMLSerializer).serializeToString(a):"string"==typeof a?a:JSON.stringify(a,void 0,void 0)):void 0,r:Math.random()};if(a)e.request.send("POST",r,!1,!0,void 0,{"Content-Type":"application/json; charset=utf-8"},JSON.stringify(c),o);else{var p=r+"?i=[i]&g=[g]&m=[m]&r=[r]";for(var u in c)p=p.replace("["+u+"]",c[u]);e.track.send(p,o)}}(t=s+(t?":"+t:""),n,a,o)}}()}(advark||(advark={})),function(e){var t,r;t=e.parser||(e.parser={}),r=function(){function e(e){this._source=e,this._parse()}return Object.defineProperty(e.prototype,"protocol",{get:function(){return this._protocol},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"domain",{get:function(){return this._domain},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"port",{get:function(){return this._port},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._path},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"site",{get:function(){return(this._protocol?this._protocol+":":"")+(this._domain?"//"+this._domain:"")+(this._port?":"+this._port:"")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){for(var e=this.toString().split("/"),t=e.length-1;t>=3;t--)if(e[t])return e[t];return""},enumerable:!0,configurable:!0}),e.prototype.setProtocol=function(e){return this._protocol=e,this},e.prototype.setDomain=function(e){return this._domain=e,this},e.prototype.setPort=function(e){return this._port=e,this},e.prototype.setPath=function(e){return this._path=e,this},e.prototype.setParams=function(e){return this._params=e,this},e.prototype.setAnchor=function(e){return this._anchor=e,this},e.prototype.toString=function(){return(this._protocol?this._protocol+":":"")+(this._domain?"//"+this._domain:"")+(this._port?":"+this._port:"")+(this._path?this._path:"")+(this._params.length>0?"?"+this._params.toString():"")+(this._anchor?"#"+this._anchor:"")},e.prototype._parse=function(){try{var e=/^(([a-z0-9]+)\:)?(\/\/([^:?#\/]+))?(\:([0-9]+))?([^?#]+)?[?]?([^#]+)?[#]?(.+)?$/i.exec(this._source);if(void 0===e)throw new Error("Input string isn't URI.");this._protocol=e[2],this._domain=e[4],this._port=e[6]?Number(e[6]):void 0,this._path=e[7],this._params=new t.UriParams(e[8]),this._anchor=e[9]}catch(e){throw e}},e}(),t.Uri=r}(advark||(advark={})),function(e){var t,r;t=e.parser||(e.parser={}),r=function(){function e(e){this._changed=!1,this._items={},this._source=e,this._parse()}return Object.defineProperty(e.prototype,"length",{get:function(){var e=0;for(var t in this._items)void 0!==this._items[t]&&e++;return e},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this._changed=!0,this._items={}},e.prototype.toString=function(){var e=this._source;if(this._changed){e="";var t=!1;for(var r in this._items)void 0!==this._items[r]&&(e+=(t?"&":"")+r+"="+this._items[r],t=!0)}return e},e.prototype.get=function(e){return this._items[e]},e.prototype.set=function(e,t){this._items[e]!==t&&(this._changed=!0,this._items[e]=t)},e.prototype._parse=function(){this._items=(this._source||"").split("&").reduce(function(e,t){var r=t.split("="),i=r[0],s=r[1];return e[i]=s,e},{})},e}(),t.UriParams=r}(advark||(advark={})),function(e){!function(t){(e.str||(e.str={})).toMap=function(t){if(t){var r={};return e.each(t,function(e,t){return r[t.toString()]=e&&e.toString&&e.toString()}),r}}}()}(advark||(advark={})),function(e){function t(e,t){if(e)if(e.length&&!isNaN(Number(e.length)))for(var r=0;r<e.length;r++)t(e[r],r);else for(var r in e)e.hasOwnProperty(r)&&t(e[r],r)}e.clone=function e(t){switch(Object.prototype.toString.apply(t)){case"[object Array]":for(var r=[],i=0;i<t.length;i++)r[i]=e(t[i]);return r;case"[object Object]":var s={};for(var i in t)s[i]=e(t[i]);return s;default:return t}},e.extend=function(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return e=e||{},t(r,function(r){return t(r,function(t,r){return e[r]=t})}),e},e.each=t,e.filter=function(e,t){for(var r=[],i=0;i<e.length;i++)t(e[i],i)&&r.push(e[i]);return r}}(advark||(advark={})),function(e){var t=function(){function e(){this._queue=[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this._queue.length},enumerable:!0,configurable:!0}),e.prototype.append=function(e){var t=this,r=function(){e&&e(),t._queue.shift(),t._queue[0]&&t._queue[0]()};this._queue.push(r),this._queue[0]===r&&r()},e}();e.Conveyor=t}(advark||(advark={})),function(e){var t;(t=e.vpaid||(e.vpaid={})).VolumeMax=1,t.VolumeMin=0,t.WidthMin=0,t.HeightMin=0,t.CodeNotImplemented=-1,t.CodeUnknown=-2}(advark||(advark={})),function(e){var t,r;t=e.vpaid||(e.vpaid={}),(r=t.events||(t.events={})).AdLoaded="AdLoaded",r.AdStarted="AdStarted",r.AdStopped="AdStopped",r.AdSkipped="AdSkipped",r.AdSkippableStateChange="AdSkippableStateChange",r.AdSizeChange="AdSizeChange",r.AdLinearChange="AdLinearChange",r.AdDurationChange="AdDurationChange",r.AdExpandedChange="AdExpandedChange",r.AdRemainingTimeChange="AdRemainingTimeChange",r.AdVolumeChange="AdVolumeChange",r.AdImpression="AdImpression",r.AdVideoStart="AdVideoStart",r.AdVideoFirstQuartile="AdVideoFirstQuartile",r.AdVideoMidpoint="AdVideoMidpoint",r.AdVideoThirdQuartile="AdVideoThirdQuartile",r.AdVideoComplete="AdVideoComplete",r.AdClickThru="AdClickThru",r.AdInteraction="AdInteraction",r.AdUserAcceptInvitation="AdUserAcceptInvitation",r.AdUserMinimize="AdUserMinimize",r.AdUserClose="AdUserClose",r.AdPaused="AdPaused",r.AdPlaying="AdPlaying",r.AdLog="AdLog",r.AdError="AdError"}(advark||(advark={})),function(e){!function(e){e.getExpectedEvents=function(t){switch(t){case"initAd":return[e.events.AdLoaded];case"startAd":return[e.events.AdStarted];case"stopAd":return[e.events.AdStopped];case"pauseAd":return[e.events.AdPaused];case"resumeAd":return[e.events.AdPlaying];default:return}},e.allowMult=function(e){switch(e){case"AdError":case"AdLoaded":case"AdStarted":case"AdStopped":case"AdSkipped":case"AdVideoStart":case"AdVideoFirstQuartile":case"AdVideoMidpoint":case"AdVideoThirdQuartile":case"AdVideoComplete":return!1;default:return!0}}}(e.vpaid||(e.vpaid={}))}(advark||(advark={})),function(e){var t,r;(t=e.devstat||(e.devstat={})).strUnk="?",t.strEnd=".",t.strTo="->",t.strSuccess="+",t.strFail="-",t.strSelector=":",t.strField=".",t.strComma=",",t.strChildOn="(",t.strChildOff=")",t.strTick="t",t.strAnd="&",t.strOr="|",t.strResolve=t.strSuccess,t.strReject=t.strFail,t.strCreated="new",t.strDisposed="disposed",t.strNewAd="newad",t.strWrapper="wrap",t.strError="err",t.strDispose="dispose",t.strLinear="linear",t.strNonlinear="nonlinear",t.strDelay="delay",t.strClient="cl",t.strPlayer="pl",t.strFrame="fr",t.strChild="ch",t.strCalled=">",t.strDone="#",t.strDispatch="dispatch",t.strErrorData=t.strSelector,t.strErrorPrefix=t.strError+t.strSelector,t.strBreakPrefix="break"+t.strSelector,t.evtSelect="as",t.evtRequest="ar",t.evtVastLoad="vl",t.evtLoaded="al",t.evtWaitUser="wu",t.evtImpression="ai",t.evtImpression2s=t.evtImpression+"2s",t.evtInit="ini",t.evtStart="sta",t.evtStop="stp",t.evtSkip="skip",t.evtUserClose="uclose",t.evtError=t.strError,t.evtPause="pa",t.evtResume="re",t.evtClick="clk",t.evtViewable="av",t.evtVideoStart="vs",t.evtFirstQuartile="fq",t.evtMidpoint="mp",t.evtThridQuartile="tq",t.evtVideoComplete="vc",r="_",t.mthInit=r+t.evtInit,t.mthLoad="_l",t.mthLoadString="_ls",t.mthLoadNode="_ln",t.mthLoadElement="_le",t.mthSubscribe="_sub",t.mthStart=r+t.evtStart,t.mthStop=r+t.evtStop,t.mthPause=r+t.evtPause,t.mthResume=r+t.evtResume,t.msgToRequest=t.evtSelect+t.strTo+t.evtRequest,t.msgToVastLoad=t.evtRequest+t.strTo+t.evtVastLoad,t.msgToLoaded=t.evtVastLoad+t.strTo+t.evtLoaded,t.msgToWaitUser=t.evtLoaded+t.strTo+t.evtWaitUser,t.msgToImpression=t.evtWaitUser+t.strTo+t.evtImpression,t.msgToStarted=t.evtImpression+t.strTo+t.evtStart,t.msgToVideoStart=t.evtStart+t.strTo+t.evtVideoStart,t.msgToFirstQuartile=t.evtVideoStart+t.strTo+t.evtFirstQuartile,t.msgToViewable=t.strChild+t.strTo+t.evtViewable,t.msgToStopped=t.evtStart+t.strTo+t.evtStop,t.msgDelayToStartAd=t.strDelay+t.strSelector+t.evtStart+t.strCalled,t.msgDelayToImpression=t.strDelay+t.strSelector+t.evtImpression,t.msgUid="uid",t.msgUserAgent="user-agent",t.msgSeq="sequence",t.msgVast="vast",t.errLogicBreak=t.strErrorPrefix+"logicbreak",t.errTrack=t.strErrorPrefix+"track",t.errDispatch=t.strErrorPrefix+t.strDispatch,t.errNoUid=t.strErrorPrefix+"nouid",t.errDmpTooLate=t.strErrorPrefix+"dmptoolate",t.errBuilder=t.strErrorPrefix+"builder",t.errPlayerBuild=t.strErrorPrefix+"playerBuild",t.errHandle=t.strErrorPrefix+"handle",t.errXmlParse=t.strErrorPrefix+"xmlParse",t.errPrepr=t.strErrorPrefix+"prepr",t.errDelta=t.strErrorPrefix+"delta",t.errNoToken=t.strErrorPrefix+"notoken",t.errPrefixMethod=t.strErrorPrefix+"method"+t.strSelector,t.errViewUnd=t.strErrorPrefix+"viewUnd",t.errVastHead=t.strErrorPrefix+"vastHead",t.errCall=t.strErrorPrefix+t.strCalled,t.clVastManager="vast",t.clDissplyManager="dissply",t.clVideoManager="video",t.clVpaidManager="vpaid",t.clBannerManager="banner",t.clToroManager="toro",t.clAdLabsManager="adlabs",t.clDirectAdvertManager="directadvert",t.clMarketGidManager="marketgid",t.clTeaserNetManager="teasernet",t.clUnknownManager="unknown",t.clNoManager="undefined"}(advark||(advark={})),function(e){!function(t){var r=/\[((?:[a-z0-9]+\:)*)([a-zA-Z_][a-zA-Z0-9_]*)\]/gi;function i(t,i){void 0===i&&(i=void 0);var s,n="";do{(s=r.exec(t))&&(n+=(n.length>0?",":"")+s[0])}while(s);n.length>0&&e.devstat.send(i,e.devstat.errPrepr,"found:"+n,t)}function s(e){return void 0===e&&(e=2147483647),Math.floor(Math.random()*e)}function n(e){var t=function(e){if(0==e)return 45;if(e<11)return e+47;if(e<37)return e+54;if(37==e)return 95;if(e<64)return e+59;throw new RangeError("Allowed range is 0..63")},r="";if("number"==typeof e){var i=Math.round(e/50),s=[];do{s.push(i%64),i=Math.floor(i/64)}while(i>0);for(;s.length>0;)r+=String.fromCharCode(t(s.pop()))}return r}t.checkMissed=i,t.process=function(e,t){for(var s in t)t[s.toLowerCase()]=t[s];var n,a=[];do{if(n=r.exec(e)){var o={entry:n[0],mods:n[1].split(":"),name:n[2].toLowerCase()};a.push(o)}}while(n);for(var s in a){var d=t[(o=a[s]).name];if("function"==typeof d&&(d=d()),"number"==typeof d&&(d=d.toString()),"string"==typeof d){for(var c=o.mods.length-1;c>=0;c--)switch(o.mods[c]){case"e":d=encodeURIComponent(d);break;case"t256":d=d.substr(0,256)}e=e.replace(o.entry,d)}}return i(e,"process"),e},t.def=function(t,r){void 0===r&&(r=void 0);var i,a={random:s(1e8),cachebusting:s(1e8),session:(new Date).getTime()+""+s(1e8),timestamp:(new Date).toISOString()},o=(l=1,void 0!==window.screen.deviceXDPI&&void 0!==window.screen.logicalXDPI&&window.screen.deviceXDPI>window.screen.logicalXDPI&&(l=window.screen.deviceXDPI/window.screen.logicalXDPI),void 0!==window.devicePixelRatio&&(l=window.devicePixelRatio),l),d=screen?screen.width:NaN,c=screen?screen.height:NaN,p=d*o,u=c*o;var l;return a.dpr=o,a.screenWidthPx=isNaN(d)?"":d,a.screenHeightPx=isNaN(c)?"":c,a.screenWidthDip=isNaN(p)?"":p,a.screenHeightDip=isNaN(u)?"":u,t&&(a.autoplay=t.autoplay||"",a.domain=t.referer?new e.parser.Uri(t.referer).domain:"",a.duration=t.duration||"",a.durationRange=t.duration?(f=t.duration,m=15,f=Number(f),isNaN(f)||(m=f<31?0:f<61?1:f<91?2:f<121?3:f<181?4:f<241?5:f<301?6:f<601?7:f<901?8:f<1801?9:f<3601?10:f<5401?11:f<7201?12:13),m):"",a.hashVideoId=t.hashVideoId||"",a.isFlash=t.isFlash||"",a.isHtml=t.isHtml||"",a.mimeTypes=(h=t,v="",1===h.isFlash&&(v+=(""===v?"":",")+"application/x-shockwave-flash",v+=(""===v?"":",")+"video/x-flv"),1===h.isHtml&&(v+=(""===v?"":",")+"application/javascript",v+=(""===v?"":",")+"application/x-javascript",v+=(""===v?"":",")+"video/webm"),v),a.placement=t.advarkId?t.advarkId+"-"+(t.labelId||"0"):"",a.pr=t.pr||Math.floor((new Date).getTime()/1e3)+s(),a.publisher=t.publisher||"",a.referer=t.referer||"",a.site=t.referer?new e.parser.Uri(t.referer).site:"",a.videoId=t.videoId||"",a.videoIdReqd=t.videoId||t.hashVideoId||"",a.videoPageUrl=t.videoPageUrl||t.referer||"",a.videoTitle=t.videoTitle||"",a.videoTitleReqd=t.videoTitle||t.referer?new e.parser.Uri(t.referer).right:"",a.videoUrl=t.videoUrl||t.referer||""),r&&(a.width=r.width||"",a.height=r.height||"",a.fullscreen="fullscreen"===r.viewMode?"1":"0",a.playerSize=function(e){var t=n(e.width),r=n(e.height),i=t.length-r.length;if(0!==i){for(var s=n(0),a="",o=0;o<Math.abs(i);o++)a+=s;i>0?r=a+r:t=a+t}return t+r}(r),a.size=(i=r).width&&i.height?i.width<400&&i.height<225?5:i.width<640&&i.height<360?0:i.width<960&&i.height<540?1:i.width<1280&&i.height<720?2:3:4),a;var h,v;var f,m}}(e.prepr||(e.prepr={}))}(advark||(advark={})),function(e){var t,r;t=e.vast||(e.vast={}),(r=t.errors||(t.errors={})).XMLParsingError=100,r.VastSchemaError=101,r.VastVersionNotSupported=102,r.AdUnsupported=200,r.AdUnexpectedLinearity=201,r.AdUnexpectedDuration=202,r.AdUnexpectedSize=203,r.WrapperError=300,r.WrapperTimeout=301,r.WrapperLimit=302,r.WrapperNoAd=303,r.LinearError=400,r.LinearFileLoadError=401,r.LinearTimeout=402,r.LinearNoSupportedFile=403,r.LinearFileError=405,r.NonLinearError=500,r.NonLinearInvalidSize=501,r.NonLinearFileLoadError=502,r.NonLinearNoSupportedFile=503,r.CompanionAdsError=600,r.CompanionNoAvailableSpace=601,r.UnableDisplayCompanion=602,r.UnableFetchCompanion=603,r.CompanionResourceUnsuported=604,r.Error=900,r.VpaidError=901}(advark||(advark={})),function(e){var t,r;t=e.vast||(e.vast={}),(r=t.errors||(t.errors={})).DmpError=10001,r.DmpReject=10002,r.DmpBadRequest=10003,r.DmpParseRespError=10004,r.ExternalVpaid=2e4}(advark||(advark={})),function(e){var t,r,i,s,n;t=e.vast||(e.vast={}),r=t.trackings||(t.trackings={}),(i=r.any||(r.any={})).mute="mute",i.unmute="unmute",i.pause="pause",i.resume="resume",i.rewind="rewind",i.skip="skip",i.playerExpand="playerExpand",i.playerCollapse="playerCollapse",(s=r.linear||(r.linear={})).start="start",s.firstQuartile="firstQuartile",s.midpoint="midpoint",s.thirdQuartile="thirdQuartile",s.complete="complete",s.acceptInvitationLinear="acceptInvitationLinear",s.timeSpentViewing="timeSpentViewing",s.otherAdInteraction="otherAdInteraction",s.progress="progress",(n=r.nonlinear||(r.nonlinear={})).creativeView="creativeView",n.acceptInvitation="acceptInvitation",n.adExpand="adExpand",n.adCollapse="adCollapse",n.minimize="minimize",n.close="close",n.overlayViewDuration="overlayViewDuration",n.otherAdInteraction="otherAdInteraction",(r.companion||(r.companion={})).creativeView="creativeView:"}(advark||(advark={})),function(e){!function(e){e.parseInteractiveFile=function(e,t,r){var i={api:e.getAttribute("apiFramework"),type:e.getAttribute("type"),path:e.textContent};for(var s in i)"string"==typeof i[s]&&(i[s]=i[s].trim(),"path"!==s&&(i[s]=i[s].toLowerCase()));if(0===i.path.length)throw new Error("Interactive file has no path");if(t){var n=!1;if(!i.api)throw new Error("Not supported API");for(var a=0,o=t;a<o.length;a++)if(o[a].trim().toLowerCase()===i.api){n=!0;break}if(!n)throw new Error("Not supported API")}if(r){if(n=!1,!i.type)throw new Error("Not supported MIME-type");for(var d=0,c=r;d<c.length;d++)if(c[d].trim().toLowerCase()===i.type){n=!0;break}if(!n)throw new Error("Not supported MIME-type")}return i},e.parseInteractiveFiles=function(t,r,i,s){var n=[];if(t)for(var a=0,o=r;a<o.length;a++)for(var d=o[a],c=t.getElementsByTagName(d),p=0;p<c.length;p++)try{n.push(e.parseInteractiveFile(c[p],i,s))}catch(e){}return n},e.parseVideoFile=function(e,t){var r={type:e.getAttribute("type"),path:e.textContent,width:parseInt(e.getAttribute("width")),height:parseInt(e.getAttribute("height"))};for(var i in r)"string"==typeof r[i]&&(r[i]=r[i].trim(),"path"!==i&&(r[i]=r[i].toLowerCase()));if(0===r.path.length)throw new Error("Media file has no path");if(isNaN(r.width)||isNaN(r.height))throw new Error("Media file has no width/height attribute");if(t){var s=!1;if(!r.type)throw new Error("Not supported MIME-type");for(var n=0,a=t;n<a.length;n++)if(a[n].test(r.type)){s=!0;break}if(!s)throw new Error("Not supported MIME-type")}return r},e.parseVideoFiles=function(t,r,i){var s=[];if(t)for(var n=0,a=r;n<a.length;n++)for(var o=a[n],d=t.getElementsByTagName(o),c=0;c<d.length;c++)try{s.push(e.parseVideoFile(d[c],i))}catch(e){}return s}}(e.vast||(e.vast={}))}(advark||(advark={})),function(e){var t;(function(t){function r(){return[{lsName:"0C376D1A-6F4F-45FD-B6E9-ADFE95065D0C",jsName:"logLevel4",desc:"Включение 4 уровня лога"},{lsName:"C31FA8E4-5C16-4C54-9DDD-DACB24847D02",jsName:"logDispatchingEvents",desc:"Лог отправления событий"},{lsName:"3E5DE066-0B24-4B45-A73D-2BF00670C5A7",jsName:"logBuilders",desc:"Лог строителей объектов"},{lsName:"C8281E7E-9BE9-4F0A-8E61-87F6F2886B11",jsName:"logDebugContainer",desc:"Лог отладочного контейнера"},{lsName:"5AD29AC6-BC20-463D-B9B3-12BAD91DAE0C",jsName:"logDevstat",desc:"Лог отправки статистики разработчика"},{lsName:"A9EDC441-F2C2-40E4-9FED-BE83A8F50265",jsName:"logSand",desc:"Лог взаимодействия фрейм-клиент"},{lsName:"B409D4B8-A2DE-40F8-8997-2FB0AE4995F3",jsName:"logWrapper",desc:"Лог обёрток"},{lsName:"2196467B-F2DC-4856-80AF-43B5B4668E63",jsName:"iframe_logAdvarkManager",desc:"Лог AdvarkManager"},{lsName:"35E0F4E5-DC26-495A-B81F-69B332FE3276",jsName:"iframe_logSequence",desc:"Лог Sequence"},{lsName:"6EBF73A2-3DCB-4498-AE4C-DBA1D90A7E4F",jsName:"iframe_logVmapManager",desc:"Лог VmapManager"},{lsName:"FF2351CA-8CAD-493D-A371-E89B8F28FFA4",jsName:"iframe_logVastManager",desc:"Лог VastManager"},{lsName:"F4D3E34B-889F-4734-A789-F5B64DC55909",jsName:"iframe_logVastExtensions",desc:"Лог расширений VastManager"},{lsName:"06EFA7B4-E7AA-4C04-A5FF-C0AC10548429",jsName:"iframe_logLinearManager",desc:"Лог менеджера линейной рекламы"},{lsName:"DE1A469C-9416-41A7-A8EE-575EC96CF02C",jsName:"iframe_logNonLinearManager",desc:"Лог менеджера нелинейной рекламы"},{lsName:"4B5D16F6-912B-4F94-9026-3EF05E4AD0A9",jsName:"iframe_logEventDispatcher",desc:"Лог диспетчера событий"},{lsName:"BAE741C9-C9D0-4EFF-9FCC-594EA6F128DF",jsName:"iframe_logEventTracker",desc:"Лог отправщика событий (трекинговых ссылок)"},{lsName:"471F481D-69C5-449F-B42D-3C9B2C2EA765",jsName:"iframe_logDmpProvider",desc:"Лог поставщиков ограничений DMP"},{lsName:"E8609F4E-FAD9-4E65-90A2-590CE668C128",jsName:"iframe_skipDmpChecks",desc:"Пропуск проверок DMP"},{lsName:"90AB3ABC-4435-4434-B429-8236634BBC7F",jsName:"iframe_useTestApi",desc:"Использовать тестовое Api"},{lsName:"30CE1D10-A137-4144-8C3A-47655B6899E3",jsName:"iframe_pauseLinear",desc:"Ставить на паузу любую линейную рекламу через 5 секунд после старта"}]}t.secretKeysGetInfo=r,t.secretKeysLoad=function(){for(var t={},r=0,i=[{lsName:"0C376D1A-6F4F-45FD-B6E9-ADFE95065D0C",jsName:"logLevel4",desc:"Включение 4 уровня лога"},{lsName:"C31FA8E4-5C16-4C54-9DDD-DACB24847D02",jsName:"logDispatchingEvents",desc:"Лог отправления событий"},{lsName:"3E5DE066-0B24-4B45-A73D-2BF00670C5A7",jsName:"logBuilders",desc:"Лог строителей объектов"},{lsName:"C8281E7E-9BE9-4F0A-8E61-87F6F2886B11",jsName:"logDebugContainer",desc:"Лог отладочного контейнера"},{lsName:"5AD29AC6-BC20-463D-B9B3-12BAD91DAE0C",jsName:"logDevstat",desc:"Лог отправки статистики разработчика"},{lsName:"A9EDC441-F2C2-40E4-9FED-BE83A8F50265",jsName:"logSand",desc:"Лог взаимодействия фрейм-клиент"},{lsName:"B409D4B8-A2DE-40F8-8997-2FB0AE4995F3",jsName:"logWrapper",desc:"Лог обёрток"},{lsName:"2196467B-F2DC-4856-80AF-43B5B4668E63",jsName:"iframe_logAdvarkManager",desc:"Лог AdvarkManager"},{lsName:"35E0F4E5-DC26-495A-B81F-69B332FE3276",jsName:"iframe_logSequence",desc:"Лог Sequence"},{lsName:"6EBF73A2-3DCB-4498-AE4C-DBA1D90A7E4F",jsName:"iframe_logVmapManager",desc:"Лог VmapManager"},{lsName:"FF2351CA-8CAD-493D-A371-E89B8F28FFA4",jsName:"iframe_logVastManager",desc:"Лог VastManager"},{lsName:"F4D3E34B-889F-4734-A789-F5B64DC55909",jsName:"iframe_logVastExtensions",desc:"Лог расширений VastManager"},{lsName:"06EFA7B4-E7AA-4C04-A5FF-C0AC10548429",jsName:"iframe_logLinearManager",desc:"Лог менеджера линейной рекламы"},{lsName:"DE1A469C-9416-41A7-A8EE-575EC96CF02C",jsName:"iframe_logNonLinearManager",desc:"Лог менеджера нелинейной рекламы"},{lsName:"4B5D16F6-912B-4F94-9026-3EF05E4AD0A9",jsName:"iframe_logEventDispatcher",desc:"Лог диспетчера событий"},{lsName:"BAE741C9-C9D0-4EFF-9FCC-594EA6F128DF",jsName:"iframe_logEventTracker",desc:"Лог отправщика событий (трекинговых ссылок)"},{lsName:"471F481D-69C5-449F-B42D-3C9B2C2EA765",jsName:"iframe_logDmpProvider",desc:"Лог поставщиков ограничений DMP"},{lsName:"E8609F4E-FAD9-4E65-90A2-590CE668C128",jsName:"iframe_skipDmpChecks",desc:"Пропуск проверок DMP"},{lsName:"90AB3ABC-4435-4434-B429-8236634BBC7F",jsName:"iframe_useTestApi",desc:"Использовать тестовое Api"},{lsName:"30CE1D10-A137-4144-8C3A-47655B6899E3",jsName:"iframe_pauseLinear",desc:"Ставить на паузу любую линейную рекламу через 5 секунд после старта"}];r<i.length;r++){var s=i[r];t[s.jsName]="true"===e.lstorage.read(s.lsName)}return t}})((t=e.context||(e.context={})).utils||(t.utils={}))}(advark||(advark={})),function(e){!function(e){e.secretKeys=e.secretKeys||{};var t=e.utils.secretKeysLoad();for(var r in t)e.secretKeys[r]=t[r];e.settings=e.settings||{},e.timeouts=e.timeouts||{request:2500,initClient:5e3,initSeq:1e4,initAd:3500,startAd:3500,stopAd:3500,pauseAd:2e3,resumeAd:2e3,startVideo:3e3,disposeVpaid:500,vpaidPlayerHideLogo:3e3},e.settings.nodeEnv=e.settings.nodeEnv||"prod",e.settings.debug=e.settings.debug||!1,e.settings.clickTarget=e.settings.clickTarget||"_blank",e.taskFlags=e.taskFlags||{}}(e.context||(e.context={}))}(advark||(advark={})),function(e){!function(t){var r,i,s;t.allowMult=function(t){switch(t){case"NotViewable":case"Viewable":case"ViewUndetermined":return!1}switch(t){case"BreakPod":case"ResetPod":return!0}switch(t){case"Preload":case"PreloadError":return!1}switch(t){case"AdClickRedirect":case"Progress":case"TeaserEnd":return!0;case"AdWaitUser":case"Empty":case"VastLoad":return!1}return e.vpaid.allowMult(t)},(r=t.viewability||(t.viewability={})).viewable="Viewable",r.notViewable="NotViewable",r.viewUndetermined="ViewUndetermined",(i=t.pod||(t.pod={})).ResetPod="ResetPod",i.BreakPod="BreakPod",(s=t.flash||(t.flash={})).Preload="Preload",s.PreloadError="PreloadError",t.ClickRedirect="AdClickRedirect",t.Empty="Empty",t.Progress="Progress",t.TeaserEnd="TeaserEnd",t.VastLoad="VastLoad",t.WaitUser="AdWaitUser"}(e.events||(e.events={}))}(advark||(advark={})),function(e){!function(t){t.EventName=function(r){switch(r){case e.events.VastLoad:return t.evtVastLoad;case e.events.WaitUser:return t.evtWaitUser;case e.vpaid.events.AdLoaded:return t.evtLoaded;case e.vpaid.events.AdError:return t.strError;case e.vpaid.events.AdPaused:return t.evtPause;case e.vpaid.events.AdPlaying:return t.evtResume;case e.vpaid.events.AdStopped:return t.evtStop;case e.vpaid.events.AdStarted:return t.evtStart;case e.vpaid.events.AdSkipped:return t.evtSkip;case e.vpaid.events.AdUserClose:return t.evtUserClose;case e.vpaid.events.AdImpression:return t.evtImpression;case e.vpaid.events.AdVideoStart:return t.evtVideoStart;case e.vpaid.events.AdVideoFirstQuartile:return t.evtFirstQuartile;case e.vpaid.events.AdVideoMidpoint:return t.evtMidpoint;case e.vpaid.events.AdVideoThirdQuartile:return t.evtThridQuartile;case e.vpaid.events.AdVideoComplete:return t.evtVideoComplete;default:return}},t.MethodName=function(e){switch(e){case"initAd":return t.mthInit;case"startAd":return t.mthStart;case"stopAd":return t.mthStop;case"pauseAd":return t.mthPause;case"resumeAd":return t.mthResume;default:return}}}(e.devstat||(e.devstat={}))}(advark||(advark={})),function(e){var t;(t=e.integration||(e.integration={})).TypeSpruto=4,t.TypeVpaid=5,t.TypeJavaScript=6}(advark||(advark={})),function(e){(advark||(advark={})).getHosts=function(){var e=window.location.origin?"null"===window.location.origin?[]:[window.location.origin]:[window.location.protocol+"//"+window.location.host];if(window!=window.top)if(window.location.ancestorOrigins){var t=window.location.ancestorOrigins;e.push(t[0]),t.length>1&&e.push(t[t.length-1])}else e.push(document.referrer);return e}}(),function(e){(e.base||(e.base={})).STR_NO_VALUE="<no value>"}(advark||(advark={})),function(e){var t,r;t=e.base||(e.base={}),(r=t.errors||(t.errors={})).AlreadyDone="Something already done",r.AlreadyExist="Object already exist",r.BadFeed="Bad feed",r.Cancelled="Cancelled",r.CantInitVideo="Cannot initialize video element",r.Disposing="Disposing",r.Disposed="Disposed",r.Done="Done",r.Duplicate="Duplicate",r.Empty="Empty",r.InvalidParams="Invalid parameters",r.New="New instance",r.NoError="No error",r.NoListeners="No listeners",r.NoLogger="No logger",r.NoMessage="No message",r.NoNextHandler="No next handler",r.NoSupportedFiles="No supported files",r.NotAllowed="Not allowed",r.NotImplemented="Not implemented",r.NotPassed="Not passed",r.NotReady="Object isn't ready",r.NotSupported="Not supported",r.Reset="Reset",r.Skipped="Skipped",r.StatesLogicBreak="States logic break",r.Stopped="Stopped",r.Timeout="Timeout exceed",r.WrapperLimit="Wrapper limit exceed",r.WrongIndex="Wrong index",r.WrongSize="Wrong data size",r.Undefined="Undefined error",r.Unload="Unload"}(advark||(advark={})),function(e){var t,r;t=e.base||(e.base={}),r=function(){function r(){this._disposing=!1,this._disposed=!1}return r.prototype.dispose=function(r){return this._disposing?e.spromise.rejected(t.errors.Disposing):(this._disposing=!0,this._dispose(r))},r.prototype._dispose=function(r){return this._disposed?e.spromise.rejected(t.errors.Disposed):(this._disposed=!0,e.spromise.resolved())},r}(),t.ADisposableObject=r}(advark||(advark={}));var advark,__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();!function(e){var t,r;t=e.base||(e.base={}),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"level",{get:function(){return this._parent?this._parent.level?this._parent.level+1:0:1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return Object.getPrototypeOf(this).constructor.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pathStr",{get:function(){return(this._parent?this._parent.pathStr?this._parent.pathStr:this._parent.name?this._parent.name.substr(0,1).toLowerCase():"":"")+this.name.substr(0,1).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pathList",{get:function(){return(this._parent?this._parent.pathList?this._parent.pathList:this._parent.name?[this._parent.name]:[]:[]).concat(this.name)},enumerable:!0,configurable:!0}),t.prototype.setParent=function(e){return this._parent=e,this},t}(t.ADisposableObject),t.AParentableObject=r}(advark||(advark={})),function(e){var t,r;t=e.base||(e.base={}),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(t.AParentableObject),t.ALogWriter=r}(advark||(advark={})),function(e){var t,r;t=e.base||(e.base={}),r=function(){function t(){this.name="",this.text="",this.level=0,this.multiply=!0,this.count=0,this._tickStr=e.devstat.strTick,this._tickSize=1e3,this._ticksLeft=20,this._ticksEnabled=!1,this._created=new Date}return Object.defineProperty(t.prototype,"started",{get:function(){return""!==this.text},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ticks",{get:function(){return this._ticksEnabled},enumerable:!0,configurable:!0}),t.prototype.setLevel=function(t){for(var r=0;r<Math.abs(this.level-t);r++)this.text+=t>this.level?e.devstat.strChildOn:e.devstat.strChildOff;this.level=t},t.prototype.append=function(e,t){if(e&&""!==e){if(this.ticks){var r=this._ticksOver();r>0&&this._append((r>1?r.toString():"")+this._tickStr,this.level)}this._append(e,t)}},t.prototype._append=function(t,r){if(this.level===r){var i=this.text.length,s=this.text[i-1];0===i||s===e.devstat.strChildOff||s===e.devstat.strChildOn||(this.text+=e.devstat.strComma)}else this.setLevel(r);this.text+=t},t.prototype._ticksOver=function(){if(!this.ticks||this._ticksLeft<=0)return 0;var e=new Date,t=e.getTime()-this._ticksLast.getTime();this._ticksLast=e;var r=Math.round(t/this._tickSize);return this._ticksLeft-=r,r},t.prototype.ticksEnable=function(e,t,r){this._tickStr=e||this._tickStr,this._tickSize=t||this._tickSize,this._ticksLeft=r||this._ticksLeft,this._ticksLast=new Date,this._ticksEnabled=!0},t}(),t.ADevstatObject=r}(advark||(advark={})),function(e){var t,r;t=e.base||(e.base={}),r=function(r){function i(){var e=null!==r&&r.apply(this,arguments)||this;return e._devstatObjects={},e}return __extends(i,r),i.prototype._devstatSender=function(){return this.name},Object.defineProperty(i.prototype,"_devstatIsTracker",{get:function(){return!this.parent},enumerable:!0,configurable:!0}),i.prototype.devstatIsStarted=function(e,t){var r;if(this._devstatIsTracker){var i=this._devstatGet(t);r=i&&i.started}else r=this.parent.devstatIsStarted(e,t);return r},i.prototype.devstatWrite=function(e,t,r,i){void 0===i&&(i=void 0);var s=this.parent;s&&!this._devstatIsTracker?s.devstatWrite(e,t,r,i):this._devstatWrite(e,t,r,i)},i.prototype.devstatSend=function(e,t,r,i,s){void 0===r&&(r=void 0),void 0===i&&(i=void 0),void 0===s&&(s=void 0);var n=this.parent;n&&!this._devstatIsTracker?n.devstatSend(e,t,r,i,s):this._devstatSend(e,t,r,i,s)},i.prototype.devstatSendIfStarted=function(e,t,r,i,s){void 0===r&&(r=void 0),void 0===i&&(i=void 0),void 0===s&&(s=void 0),this.devstatIsStarted(e,t)&&this.devstatSend(e,t,r,i,s)},i.prototype._devstatTransmit=function(t,r,i,s){void 0===i&&(i=void 0),void 0===s&&(s=void 0),i=i||this._devstatSender(),e.devstat.send(i,t,r,s)},i.prototype._dispose=function(i){if(this._disposed)return e.spromise.rejected(t.errors.Disposed);for(var s in this._devstatObjects){var n=this._devstatObjects[s];n&&""!==n.text&&(0===n.count||n.multiply)&&(this._devstatTransmit(s+e.devstat.strSelector+n.count,n.text,void 0,n.data),n.text="",n.count++)}return delete this._devstatObjects,r.prototype._dispose.call(this,i)},i.prototype._devstatCreate=function(e,r,i){if(void 0===r&&(r=!1),void 0===i&&(i=!1),this._devstatIsTracker&&!this._devstatObjects[e]){var s=new t.ADevstatObject;return s.name=e,s.multiply=r,i&&s.ticksEnable(),s=this._devstatSet(e,s)}},i.prototype._devstatDelete=function(e){return!!this._devstatIsTracker&&(!!this._devstatObjects[e]&&(delete this._devstatObjects[e],!0))},i.prototype._devstatGet=function(e){if(this._devstatObjects&&this._devstatObjects[e])return this._devstatObjects[e]},i.prototype._devstatSet=function(e,t){return this._devstatObjects[e]=t,this._devstatObjects[e]},i.prototype._devstatWrite=function(e,t,r,i){void 0===i&&(i=void 0);var s=this._devstatGet(t);if(s){var n=e.level-this.level;r&&s.append(r,n),i&&!s.data&&(s.data=i)}},i.prototype._devstatSend=function(t,r,i,s,n){void 0===i&&(i=void 0),void 0===s&&(s=void 0),void 0===n&&(n=void 0),this._devstatWrite(t,r,i,s);var a=this._devstatGet(r);if(a){var o=t.level-this.level;o>0?a.setLevel(o):(0===a.count||a.multiply)&&(this._devstatTransmit(r+e.devstat.strSelector+a.count,a.text,n,a.data),a.text="",a.count++)}},i}(t.ALogWriter),t.ADevstatWriter=r}(advark||(advark={})),function(e){var t,r;t=e.base||(e.base={}),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype._devstatSender=function(){return this.pathStr},t}(t.ADevstatWriter),t.ADebugableObject=r}(advark||(advark={})),function(e){var t,r,i;t=e.base||(e.base={}),r=t.factory||(t.factory={}),i=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.setItem=function(e,t){return this["_"+e]=t,this},r.prototype.getItem=function(e){return this["_"+e]},r.prototype.setClass=function(e){return this.setItem("class",e)},r.prototype.getClass=function(){return this.getItem("class")},r.prototype.setClassName=function(e){return this.setItem("className",e)},Object.defineProperty(r.prototype,"className",{get:function(){return this.getItem("className")},enumerable:!0,configurable:!0}),r.prototype.setTargetParent=function(e){return this.setItem("targetParent",e)},Object.defineProperty(r.prototype,"targetParent",{get:function(){return this.getItem("targetParent")},enumerable:!0,configurable:!0}),r.prototype.build=function(){try{var t=this._checkCache();return t||(t=this._construct(),this._targetParent&&t.setParent(this._targetParent),this._beforeBuild(t),t.build(),this._afterBuild(t)),t}catch(t){throw this.devstatSend(this,e.devstat.errBuilder,t.message,t.data?JSON.stringify(t.data,void 0,void 0):void 0),t}},r.prototype._checkCache=function(){},r.prototype._beforeBuild=function(e){},r.prototype._afterBuild=function(e){},r}(t.ADebugableObject),r.ABuilder=i}(advark||(advark={})),function(e){var t,r,i;t=e.base||(e.base={}),r=t.factory||(t.factory={}),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._builded=!1,t}return __extends(t,e),t.prototype.build=function(){return this._builded=!0,this},t}(t.ADebugableObject),r.ABuildableItem=i}(advark||(advark={})),function(e){var t,r;t=e.request||(e.request={}),r=function(r){function i(){var t=null!==r&&r.apply(this,arguments)||this;return t._method="GET",t._timeout=e.context.timeouts.request,t._async=!0,t}return __extends(i,r),i.prototype.setMethod=function(e){return this._method=e,this},Object.defineProperty(i.prototype,"method",{get:function(){return this._method},enumerable:!0,configurable:!0}),i.prototype.setUri=function(e){return this._uri=e,this},Object.defineProperty(i.prototype,"uri",{get:function(){return this._uri},enumerable:!0,configurable:!0}),i.prototype.setCredentials=function(e){return this._credentrials=e,this},Object.defineProperty(i.prototype,"credentials",{get:function(){return this._credentrials},enumerable:!0,configurable:!0}),i.prototype.setHeaders=function(e){return this._headers=e,this},Object.defineProperty(i.prototype,"headers",{get:function(){return this._headers},enumerable:!0,configurable:!0}),i.prototype.setTimeout=function(e){return this._timeout=e,this},Object.defineProperty(i.prototype,"timeout",{get:function(){return this._timeout},enumerable:!0,configurable:!0}),i.prototype.setAsync=function(e){return this._async=e,this},Object.defineProperty(i.prototype,"async",{get:function(){return this._async},enumerable:!0,configurable:!0}),i.prototype.send=function(){var t=e.spromise.deffer();return this._send(function(e){e.succeed?t.resolve(e):t.reject(e)}),t.promise},i.prototype._send=function(e){t.send(this._method,this._uri,this._credentrials,this._async,this._timeout,this._headers,this._data,e)},i}(e.base.factory.ABuildableItem),t.Request=r}(advark||(advark={})),function(e){var t,r;t=e.module||(e.module={}),(r=t.errors||(t.errors={})).SeqEmpty=function(r,i){return new t.AdError("Sequence is empty",e.vast.errors.WrapperNoAd,r,i)},r.SeqTimeout=function(r,i){return new t.AdError("Sequence init timeout",e.vast.errors.WrapperTimeout,r,i)},r.VastEmpty=function(r,i){return new t.AdError("VAST is empty",e.vast.errors.WrapperNoAd,r,i)},r.VastTimeout=function(r,i){return new t.AdError("VAST init timeout",e.vast.errors.WrapperTimeout,r,i)},r.VastNoAd=function(r,i){return new t.AdError("VAST no ad",e.vast.errors.WrapperNoAd,r,i)},r.VastNoBanner=function(r,i){return new t.AdError("VAST no banner",e.vast.errors.WrapperNoAd,r,i)},r.VastNoNode=function(r,i){return new t.AdError("VAST no node",e.vast.errors.VastSchemaError,r,i)},r.VastNoWay=function(r,i){return new t.AdError("VAST no way to init",e.vast.errors.VastSchemaError,r,i)},r.VastNoLoad=function(r,i){return new t.AdError(r?r.message||r:"VAST no load",e.vast.errors.WrapperError,r,i)},r.VastBadXML=function(r,i){return new t.AdError(r?r.message||r:"VAST bad XML",e.vast.errors.XMLParsingError,r,i)},r.AdNoWay=function(r,i){return new t.AdError("Ad no way to init",e.vast.errors.VastSchemaError,r,i)},r.AdNoRequered=function(r,i){return new t.AdError("Ad without required element",e.vast.errors.AdUnexpectedLinearity,r,i)},r.AdNoSupportedFiles=function(r,i){return new t.AdError("Ad no supported files",e.vast.errors.AdUnsupported,r,i)},r.AdCompanionsNotSupported=function(r,i){return new t.AdError("Companion ads not supported",e.vast.errors.UnableDisplayCompanion,r,i)},r.AdLinearNoSupported=function(r,i){return new t.AdError("Linear ad has no supported files",e.vast.errors.LinearNoSupportedFile,r,i)},r.AdNonLinearNoSupported=function(r,i){return new t.AdError("Non-linear ad has no supported files",e.vast.errors.NonLinearNoSupportedFile,r,i)},r.WrapperLimit=function(r,i){return new t.AdError("Wrapper limit exceed",e.vast.errors.WrapperLimit,r,i)},r.DmpError=function(r,i){return new t.AdError(r?r.message||r:"DMP error",e.vast.errors.DmpError,r,i)},r.DmpReject=function(r,i){return new t.AdError(r?r.message||r:"DMP reject",e.vast.errors.DmpReject,r,i)},r.DmpRequest=function(r,i){return new t.AdError(r?r.message||r:"DMP request error",e.vast.errors.DmpBadRequest,r,i)},r.DmpParse=function(r,i){return new t.AdError(r?r.message||r:"DMP response parse error",e.vast.errors.DmpParseRespError,r,i)},r.AdLinearFeedError=function(r,i){return new t.AdError(r?r.message||r:"Feed load error",e.vast.errors.LinearFileLoadError,r,i)},r.AdNonLinearFeedError=function(r,i){return new t.AdError(r?r.message||r:"Feed load error",e.vast.errors.NonLinearFileLoadError,r,i)},r.ExternalVpaid=function(r,i){return new t.AdError(r?r.message||r:"External VPAID Error",e.vast.errors.ExternalVpaid+(r&r.code||e.vast.errors.Error),r,i)}}(advark||(advark={})),function(e){var t,r;t=e.module||(e.module={}),r=function(){function t(t,r,i,s){void 0===r&&(r=e.vast.errors.Error),void 0===i&&(i=void 0),void 0===s&&(s=void 0),this.name="AdError",this.message=t,this.code="string"==typeof r?parseInt(r):r,this.previous=i,this.data=s}return t.Build=function(r,i,s,n){void 0===i&&(i=void 0),void 0===s&&(s=void 0),void 0===n&&(n=void 0);try{if(r instanceof Array&&(r=r.pop()),r instanceof t)return n&&(r.data=e.extend(r.data,n)),r;if(!r)throw new Error("Undefined error passed to builder");var a="string"==typeof r?/^(\d+)\s+(.+)$/i.exec(r):void 0,o=e.base.errors.Undefined,d=e.vast.errors.Error;return new t(r?"string"==typeof r?a&&a[2]?a[2]:r:r.message?r.message:r.data&&r.data.message?r.data.message:o:s?"string"==typeof s?s:s.message?s.message:o:o,r?"string"==typeof r&&a&&a[1]?parseInt(a[1]):r.code?r.code:r.data&&r.data.code?r.data.code:d:s&&s.code?s.code:d,r instanceof Error?r:s instanceof Error?s:void 0,n||(r&&r.data?r.data:void 0))}catch(r){return new t("Undefined error",e.vast.errors.Error,r)}},Object.defineProperty(t.prototype,"stringLine",{get:function(){return this.code+" "+this.message},enumerable:!0,configurable:!0}),t}(),t.AdError=r}(advark||(advark={})),function(e){var t,r;t=e.module||(e.module={}),r=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e._listenerRecs={},e}return __extends(r,t),r.prototype.subscribe=function(e,t,r){void 0===r&&(r=void 0),this._disposing||(this._listenerRecs[t]||(this._listenerRecs[t]=[]),this._listenerRecs[t].push({listener:e,scope:r||window}))},r.prototype.unsubscribe=function(e,t){if(!this._disposing){var r=this._listenerRecs[t];if(r)for(var i=0;r&&r.length>i;)r[i].listener===e?r.splice(i,1):i++}},r.prototype._resetListeners=function(){this._listenerRecs={}},r.prototype._dispatch=function(t){for(var r=this,i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];var n=this._listenerRecs[t];if(!n||0===n.length)return e.spromise.resolved(e.base.errors.NoListeners);for(var a=e.spromise.resolved(),o=0;o<n.length;){var d=n.length;a=a.then(function(){return r._callListener(t,n[o],i)}),d===n.length&&o++}return a=a.catch(function(){return e.spromise.resolved()})},r.prototype._callListener=function(t,r,i){var s;try{s=r.listener.apply(r.scope,i)||e.spromise.resolved()}catch(a){var n={name:this.name,path:this.pathStr,args:i,listener:r.listener.toString()};this._devstatTransmit(e.devstat.errDispatch+e.devstat.strSelector+t,a.message||a,void 0,n),s=e.spromise.resolved()}return s},r}(e.base.factory.ABuildableItem),t.AEventDispatcher=r}(advark||(advark={})),function(e){var t,r;t=e.module||(e.module={}),r=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e._eventTimeoutIds={},e._eventTimes={},e._eventParams={},e._eventHandlers={},e}return __extends(r,t),r.prototype._getHandlingEvents=function(){return[]},Object.defineProperty(r.prototype,"eventDispatcher",{get:function(){},enumerable:!0,configurable:!0}),r.prototype._clearEventTimeout=function(e){this._eventTimeoutIds[e]&&(clearTimeout(this._eventTimeoutIds[e]),delete this._eventTimeoutIds[e])},r.prototype._subscribeEvents=function(t){void 0===t&&(t=void 0);for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];for(var s=0,n=this._getHandlingEvents();s<n.length;s++){var a=n[s];this._subscribeEvent.apply(this,[a,t].concat(r))}return e.spromise.resolved()},r.prototype._unsubscribeEvents=function(){for(var t=0,r=this._getHandlingEvents();t<r.length;t++){var i=r[t];this._unsubscribeEvent(i)}return e.spromise.resolved()},r.prototype._handleEvent=function(t){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return this._disposing?e.spromise.rejected(e.base.errors.Disposing):this._handleEventEnd.apply(this,[t].concat(r))},r.prototype._handleEventEnd=function(t){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return this._disposing?e.spromise.rejected(e.base.errors.Disposing):(this._clearEventTimeout(t),this._eventTimes[t]=new Date,this._eventParams[t]=r,this._dispatch.apply(this,[t].concat(r)))},r.prototype._dispose=function(r){if(this._disposed)return e.spromise.rejected(e.base.errors.Disposed);for(var i in this._unsubscribeEvents(),this._eventTimeoutIds)this._clearEventTimeout(i);return delete this._eventTimeoutIds,t.prototype._dispose.call(this,r)},r.prototype._createEventHandler=function(e){for(var t=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return this._eventHandlers[e]=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];return t._handleEvent.apply(t,[e].concat(r).concat(i))},this._eventHandlers[e]},r.prototype._deleteEventHandler=function(e){this._eventHandlers[e]=void 0},r.prototype._subscribeEvent=function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];(t=t||this.eventDispatcher)&&t.subscribe(this._createEventHandler.apply(this,[e].concat(r)),e)},r.prototype._unsubscribeEvent=function(e){this.eventDispatcher&&this.eventDispatcher.unsubscribe(this._eventHandlers[e],e)},r}(t.AEventDispatcher),t.AEventReceiver=r}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r="Wrong sequence for state: ",i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._strict=!0,t._loaded=!1,t._started=!1,t._stopped=!1,t._resumed=!1,t._paused=!1,t._loading=!1,t._starting=!1,t._stopping=!1,t._resuming=!1,t._pausing=!1,t}return __extends(t,e),t.prototype.setStrict=function(e){return this._strict=e,this},Object.defineProperty(t.prototype,"strict",{get:function(){return this._strict},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loaded",{get:function(){return this._loaded},set:function(e){if(this._check("loaded",e),this._strict&&!this._loading)throw new Error(r+"loaded");this._loading=!1,this._loaded=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"started",{get:function(){return this._started},set:function(e){if(this._check("started",e),this._strict&&!this._starting)throw new Error(r+"started");this._starting=!1,this._started=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stopped",{get:function(){return this._stopped},set:function(e){this._check("stopped",e),this._loading=!1,this._pausing=!1,this._resuming=!1,this._starting=!1,this._stopping=!1,this._stopped=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resumed",{get:function(){return this._resumed},set:function(e){if(this._check("resumed",e),this._strict&&!this._started)throw new Error(r+"resumed");this._resuming=!1,this._pausing=!1,this._resumed=!0,this._paused=!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paused",{get:function(){return this._paused},set:function(e){if(this._check("paused",e),!this._started)throw new Error(r+"paused");this._resuming=!1,this._pausing=!1,this._resumed=!1,this._paused=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loading",{get:function(){return this._loading},set:function(e){this._check("loading",e),this._loading=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"starting",{get:function(){return this._starting},set:function(e){if(this._check("starting",e),this._strict&&!this._loaded)throw new Error(r+"starting");this._starting=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stopping",{get:function(){return this._stopping},set:function(e){this._check("stopping",e),this._loading=!1,this._pausing=!1,this._resuming=!1,this._starting=!1,this._stopping=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resuming",{get:function(){return this._resuming},set:function(e){if(this._check("resuming",e),this._strict&&(!this._started||!this._paused))throw new Error(r+"resuming");this._resuming=!0,this._pausing=!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pausing",{get:function(){return this._pausing},set:function(e){if(this._check("pausing",e),this._strict&&(!this._started||this._paused))throw new Error(r+"pausing");this._resuming=!1,this._pausing=!0},enumerable:!0,configurable:!0}),t.prototype._check=function(e,t){if(this._strict){if(!0!==t)throw new Error("Manual state switching to false is not allowed for state: "+e);if(this["_"+e])throw new Error("Duplicate state switching is not allowed for state: "+e);if(this._stopped||this._stopping&&"stopped"!==e)throw new Error("Trying to change state while stopping or stopped: "+e)}},t.prototype.reset=function(){this._loaded=!1,this._started=!1,this._stopped=!1,this._resumed=!1,this._paused=!1,this._loading=!1,this._starting=!1,this._stopping=!1,this._resuming=!1,this._pausing=!1},t}(e.base.factory.ABuildableItem),t.AdStates=i}(advark||(advark={})),function(e){var t,r;t=e.module||(e.module={}),r=function(r){function i(){return null!==r&&r.apply(this,arguments)||this}return __extends(i,r),i.prototype.build=function(){return r.prototype.build.call(this),this._states=(new t.AdStates).setParent(this).build(),this},i.prototype.initAd=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return this._disposing?e.spromise.rejected(e.base.errors.Disposing):this._states.loading||this._states.loaded?e.spromise.rejected(e.base.errors.AlreadyDone):(this._states.loading=!0,e.spromise.resolved())},i.prototype.startAd=function(){return this._disposing||!this._states.loaded?e.spromise.rejected(e.base.errors.NotReady):this._states.starting||this._states.started?e.spromise.rejected(e.base.errors.AlreadyDone):(this._states.starting=!0,e.spromise.resolved())},i.prototype.stopAd=function(){return this._disposing||!this._states.started?e.spromise.rejected(e.base.errors.NotReady):this._states.stopping||this._states.stopped?e.spromise.rejected(e.base.errors.AlreadyDone):(this._states.stopping=!0,e.spromise.resolved())},i.prototype.pauseAd=function(){return this._disposing||!this._states.started?e.spromise.rejected(e.base.errors.NotReady):this._states.pausing||this._states.paused?e.spromise.rejected(e.base.errors.AlreadyDone):(this._states.pausing=!0,e.spromise.resolved())},i.prototype.resumeAd=function(){return this._disposing||!this._states.started?e.spromise.rejected(e.base.errors.NotReady):(this._states.resuming||this._states.resumed||(this._states.resuming=!0),e.spromise.resolved())},i.prototype._handleEvent=function(t){for(var i,s=[],n=1;n<arguments.length;n++)s[n-1]=arguments[n];switch(t){case e.vpaid.events.AdLoaded:this._states.loaded=!0;break;case e.vpaid.events.AdStarted:this._states.started=!0;break;case e.vpaid.events.AdError:case e.vpaid.events.AdStopped:this._states.stopped=!0;break;case e.vpaid.events.AdPaused:this._states.paused=!0;break;case e.vpaid.events.AdPlaying:this._states.resumed=!0}return(i=r.prototype._handleEvent).apply.call(i,this,[t].concat(s))},i.prototype._handleEventEnd=function(t){for(var i,s,n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];if(this._disposing)return e.spromise.rejected(e.base.errors.Disposing);switch(t){case e.vpaid.events.AdStopped:i=this._handleStop.apply(this,n);break;case e.vpaid.events.AdError:i=this._handleError.apply(this,n)}return i||(s=r.prototype._handleEventEnd).apply.call(s,this,[t].concat(n))},i.prototype._handleError=function(r){for(var i=this,s=[],n=1;n<arguments.length;n++)s[n-1]=arguments[n];if(this._disposing)return e.spromise.rejected(e.base.errors.Disposing);var a=t.AdError.Build(r),o=this._dispatch.apply(this,[e.vpaid.events.AdError,a].concat(s));return o=o.inspect(function(){return i._states.strict?i.dispose(a):void 0}).catch(function(){return e.spromise.resolved()})},i.prototype._handleStop=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this._disposing)return e.spromise.rejected(e.base.errors.Disposing);var s=this._dispatch.apply(this,[e.vpaid.events.AdStopped].concat(r));return s=s.inspect(function(){return t._states.strict?t.dispose(e.base.errors.Stopped):void 0}).catch(function(){return e.spromise.resolved()})},i}(t.AEventReceiver),t.AManager=r}(advark||(advark={})),function(e){var t,r;t=e.module||(e.module={}),r=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e._awaitRecs=[],e._awaitPromises={},e}return __extends(r,t),r.prototype.initAd=function(){for(var r=this,i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var n,a="initAd";return this._states.loaded?e.spromise.resolved():this._states.loading?this._awaitPromises[a]:(this._awaitPromises[a]=this._waitEvents([e.vpaid.events.AdLoaded],[e.vpaid.events.AdError],a),(n=t.prototype.initAd).apply.call(n,this,i).then(function(){return r.__initAd.apply(r,i)}),this._awaitPromises[a])},r.prototype.startAd=function(){var r=this,i="startAd";return this._states.started?e.spromise.resolved():this._states.starting?this._awaitPromises[i]:(this._awaitPromises[i]=this._waitEvents([e.vpaid.events.AdStarted,e.events.WaitUser],[e.vpaid.events.AdError],i).catch(function(t){return r._handleEvent(e.vpaid.events.AdError,t).then(function(){return e.spromise.rejected(t)})}),t.prototype.startAd.call(this).then(function(){return r.__startAd()}),this._awaitPromises[i])},r.prototype.stopAd=function(){var r=this,i="stopAd";return this._states.stopped?e.spromise.resolved():this._states.stopping?this._awaitPromises[i]:(this._awaitPromises[i]=this._waitEvents([e.vpaid.events.AdStopped],[e.vpaid.events.AdError],i).catch(function(t){return r._handleEvent(e.vpaid.events.AdError,t).then(function(){return e.spromise.rejected(t)})}),t.prototype.stopAd.call(this).then(function(){return r.__stopAd()}),this._awaitPromises[i])},r.prototype.pauseAd=function(){var r=this,i="pauseAd";return this._states.paused?e.spromise.resolved():this._states.pausing?this._awaitPromises[i]:(this._awaitPromises[i]=this._waitEvents([e.vpaid.events.AdPaused],[e.vpaid.events.AdError],i).catch(function(t){return r._handleEvent(e.vpaid.events.AdError,t).then(function(){return e.spromise.rejected(t)})}),t.prototype.pauseAd.call(this).then(function(){return r.__pauseAd()}),this._awaitPromises[i])},r.prototype.resumeAd=function(){var r=this,i="resumeAd";return this._states.paused?this._states.resumed?e.spromise.resolved():this._states.resuming?this._awaitPromises[i]:(this._awaitPromises[i]=this._waitEvents([e.vpaid.events.AdPlaying],[e.vpaid.events.AdError],i).catch(function(t){return r._handleEvent(e.vpaid.events.AdError,t).then(function(){return e.spromise.rejected(t)})}),t.prototype.resumeAd.call(this).then(function(){return r.__resumeAd()}),this._awaitPromises[i]):e.spromise.resolved()},r.prototype.__initAd=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=this.eventDispatcher;i?i.initAd.apply(i,t):this._handleEvent(e.vpaid.events.AdLoaded)},r.prototype.__startAd=function(){var t=this.eventDispatcher;t?t.startAd():this._handleEvent(e.vpaid.events.AdStarted)},r.prototype.__stopAd=function(){var t=this.eventDispatcher;t?t.stopAd():this._handleEvent(e.vpaid.events.AdStopped)},r.prototype.__pauseAd=function(){var t=this.eventDispatcher;t?t.pauseAd():this._handleEvent(e.vpaid.events.AdPaused)},r.prototype.__resumeAd=function(){var t=this.eventDispatcher;t?t.resumeAd():this._handleEvent(e.vpaid.events.AdPlaying)},r.prototype._handleEvent=function(r){for(var i,s=this,n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];if(this._disposing)return e.spromise.rejected(e.base.errors.Disposing);var o=this._awaitIdx(r);if(o<0)i=e.spromise.resolved();else{var d=this._awaitRecs[o][r];this._awaitRecs.splice(o,1),i=d.apply(this,n)}return i.then(function(){return(e=t.prototype._handleEvent).apply.call(e,s,[r].concat(n));var e})},r.prototype._waitEvents=function(t,r){for(var i=this,s=[],n=2;n<arguments.length;n++)s[n-2]=arguments[n];var a=e.spromise.deffer(),o={};this._awaitRecs[this._freeAwaitIdx()]=o;for(var d=function(e){o[e]=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return a.resolve(e)}},c=0,p=t;c<p.length;c++){d(h=p[c])}for(var u=0,l=r;u<l.length;u++){var h=l[u];o[h]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.reject(e[0])}}return a.promise.inspect(function(t,r){return r?void 0:i._handleEvent(e.vpaid.events.AdError,t)})},r.prototype._freeAwaitIdx=function(){for(var e=0;this._awaitRecs[e];)e++;return e},r.prototype._awaitIdx=function(e){for(var t=this._awaitRecs.length;t>=0&&(t--,!this._awaitRecs[t]||!this._awaitRecs[t][e]););return t},r}(t.AManager),t.AEventAwaiter=r}(advark||(advark={})),function(e){var t,r;t=e.module||(e.module={}),r=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e._reducingRecs=[],e}return __extends(r,t),r.prototype._handleEvent=function(r){for(var i,s=[],n=1;n<arguments.length;n++)s[n-1]=arguments[n];return this._disposing?e.spromise.rejected(e.base.errors.Disposing):this._reduceIdx([r])<0?(i=t.prototype._handleEvent).apply.call(i,this,[r].concat(s)):e.spromise.resolved()},r.prototype._reduceEvents=function(e,t){for(var r=this,i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var n=this._reduceNew();return this._reducingRecs[n]=e,t().inspect(function(t,i){r._reducingRecs.splice(r._reduceIdx(e),1)})},r.prototype._reduceNew=function(){for(var e=0;this._reducingRecs[e];)e++;return e},r.prototype._reduceIdx=function(e){for(var t=this._reducingRecs.length;t>=0;)if(t--,this._reducingRecs[t]){var r=this._reducingRecs[t],i=r.length>0;if(!i)continue;for(var s=0,n=e;s<n.length;s++){var a=n[s];if(-1===r.indexOf(a)){i=!1;break}}if(!i)continue;break}return t},r}(t.AEventAwaiter),t.AEventReducer=r}(advark||(advark={})),function(e){var t,r;t=e.module||(e.module={}),r=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.setContentData=function(e){return this._contentData=e,this},Object.defineProperty(r.prototype,"_refererDomain",{get:function(){return this._contentData&&this._contentData.referer?new e.parser.Uri(this._contentData.referer).domain:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"_videoPageDomain",{get:function(){return this._contentData&&this._contentData.videoPageUrl?new e.parser.Uri(this._contentData.videoPageUrl).domain:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"_advarkId",{get:function(){return this._contentData&&this._contentData.advarkId?this._contentData.advarkId:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"_labelId",{get:function(){return this._contentData&&this._contentData.labelId?this._contentData.labelId:0},enumerable:!0,configurable:!0}),r.prototype._devstatSender=function(){var e=this._advarkId?this._advarkId:"",r=this._videoPageDomain?this._videoPageDomain:"";return t.prototype._devstatSender.call(this)+":"+e+":"+r},r}(t.AEventReducer),t.AContentDataOwner=r}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.sand||(t.sand={}),(i=r.EAccess||(r.EAccess={}))[i.all=7]="all",i[i.read=4]="read",i[i.write=2]="write",i[i.call=1]="call",i[i.none=0]="none"}(advark||(advark={})),function(e){var t,r;t=e.module||(e.module={}),(r=t.sand||(t.sand={})).cmdBatch="batch",r.cmdFunc="func",r.cmdInit="init",r.cmdLoad="load",r.cmdBatchDone="batch-done",r.cmdFuncDone="func-done",r.cmdInitDone="init-done",r.cmdLoadDone="load-done"}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.sand||(t.sand={}),i=function(t){function i(){var r=null!==t&&t.apply(this,arguments)||this;return r._remoteFuncs={},r._localFuncs={},r.conveyor=new e.Conveyor,r._whenConnect=e.spromise.deffer(),r}return __extends(i,t),Object.defineProperty(i.prototype,"whenConnect",{get:function(){return this._whenConnect.promise},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return"Gateway"},enumerable:!0,configurable:!0}),i.prototype.setTargetWin=function(e){return this._targetWin=e,this},i.prototype.setOrigin=function(e){return this._origin=e,this},i.prototype.build=function(){return t.prototype.build.call(this),this._onMessageBound=this._onMessage.bind(this),window.addEventListener("message",this._onMessageBound),this},i.prototype._dispose=function(e){return window.removeEventListener("message",this._onMessageBound),delete this._localFuncs,delete this._remoteFuncs,delete this._origin,delete this._targetWin,delete this._onMessageBound,t.prototype._dispose.call(this,e)},i.prototype._send=function(e,t){if(this._disposing);else{var r=JSON.stringify({c:e,d:t});this._targetWin.postMessage(r,this._origin)}},i.prototype._receive=function(e,t){var r=this;this._disposing||this.conveyor.append(function(){return r._handleCommand(e,t)})},i.prototype._handleCommand=function(e,t){switch(e){case r.cmdFunc:this._callLocal(t.i,t.p)}},i.prototype._onMessage=function(e){if(!this._disposing&&("*"===this._origin||this._origin===e.origin)&&e.source===this._targetWin&&e.data){var t=JSON.parse(e.data);t.c&&this._receive(t.c,t.d)}},i.prototype._toRemoteQueryPlans=function(e){var t=[];if(e)for(var r=0,i=e;r<i.length;r++){var s=i[r];t.push({t:s.t,c:s.c,p:this._toRemoteValues(s.p)})}return t},i.prototype._toRemoteValues=function(e){var t=[];if(e)for(var r=0,i=e;r<i.length;r++){var s=i[r];t.push(this._toRemoteValue(s))}return t},i.prototype._toRemoteValue=function(t){var r=this;if("object"==typeof t){var i,s=void 0;return null===t?(s="v",i=null):(s=t instanceof Array?"a":"o",i={},e.each(t,function(e,t){i[t]=r._toRemoteValue(e)})),{t:s,v:i}}return"function"==typeof t?{t:"f",v:this._toRemoteFunc(t)}:"number"==typeof t&&isNaN(t)?{t:"n"}:{t:"v",v:t}},i.prototype._toLocalValues=function(e){var t=[];if(e)for(var r=0,i=e;r<i.length;r++){var s=i[r];t.push(this._toLocalValue(s))}return t},i.prototype._toLocalValue=function(t){var r,i=this;switch(t.t){case"f":return this._toLocalFunc(t.v);case"v":return t.v;case"o":return r={},e.each(t.v,function(e,t){r[t]=i._toLocalValue(e)}),r;case"a":return r=[],e.each(t.v,function(e,t){r[t]=i._toLocalValue(e)}),r;case"n":return NaN}},i.prototype._toLocalFunc=function(e){var t=this;return this._remoteFuncs[e]||(this._remoteFuncs[e]={code:function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];return t._send(r.cmdFunc,{i:e,p:t._toRemoteValues(i)})}}),this._remoteFuncs[e].code},i.prototype._toRemoteFunc=function(t){var r;if(e.each(this._localFuncs,function(e,i){e.code===t&&(r=i)}),!r){var i=0;do{r=Number(new Date).toString()+("0000000"+(i++).toString()).slice(-8)}while(this._localFuncs[r]);this._localFuncs[r]={code:t}}return r},i.prototype._callLocal=function(e,t){this._localFuncs[e].code.apply(window,this._toLocalValues(t))},i}(t.AEventDispatcher),r.AGateway=i}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.sand||(t.sand={}),i=r.slave||(r.slave={}),s=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.build=function(){return t.prototype.build.call(this),this._deffer=e.spromise.deffer(),this._sendTime=new Date,this},Object.defineProperty(r.prototype,"sendTime",{get:function(){return this._sendTime},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"promise",{get:function(){return this._deffer.promise},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"accessChain",{get:function(){return this._chain},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"actionType",{get:function(){return this._action},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"args",{get:function(){return this._args},enumerable:!0,configurable:!0}),r.prototype.setChain=function(e){return this._chain=e,this},r.prototype.setAction=function(e){return this._action=e,this},r.prototype.setArgs=function(e){return this._args=e,this},r.prototype.resolve=function(e){return this._deffer.resolve(e)},r.prototype.reject=function(e){throw new Error("Unexpected call")},r}(e.base.factory.ABuildableItem),i.QueryDeffer=s}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.sand||(t.sand={}),i=r.slave||(r.slave={}),s=function(t){function r(e,r){var i=t.call(this)||this;return i._resp=!0,i._processor=e,i._chain=r,i}return __extends(r,t),r.prototype.resp=function(e){return this._resp=e,this},r.prototype.select=function(e){return new r(this._processor,this._chain.concat(e)).setParent(this).resp(this._resp)},r.prototype.get=function(){return this._processor("g",this._chain,this._resp).then(function(t){return t[0]?t[0].e?e.spromise.rejected(t[0].m):e.spromise.resolved(t[0].v):e.spromise.resolved(void 0)})},r.prototype.set=function(t){return this._processor("s",this._chain,this._resp,t).then(function(t){return t[0]?t[0].e?e.spromise.rejected(t[0].m):e.spromise.resolved(t[0].v):e.spromise.resolved(void 0)})},r.prototype.call=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return this._processor.apply(this,["c",this._chain,this._resp].concat(t)).then(function(t){return t[0]?t[0].e?e.spromise.rejected(t[0].m):e.spromise.resolved(t[0].v):e.spromise.resolved(void 0)})},r.prototype.apply=function(e){return this.call.apply(this,e)},r}(e.base.ADebugableObject),i.Query=s}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.sand||(t.sand={}),i=r.slave||(r.slave={}),s=function(t){function r(r){var i=t.call(this)||this;return i._recs=[],i._idx=0,i._resp=!0,i._send=e.spromise.deffer(),i._complete=e.spromise.deffer(),i._processor=r,i}return __extends(r,t),Object.defineProperty(r.prototype,"complete",{get:function(){return this._complete.promise},enumerable:!0,configurable:!0}),r.prototype.resp=function(e){return this._resp=e,this},r.prototype.select=function(e){return this._recs[this._idx]?this._recs[this._idx].c.push(e):this._recs[this._idx]={t:void 0,c:[e],p:void 0},this},r.prototype.set=function(e){return this._recs[this._idx].t="s",this._recs[this._idx].p=[e],this._idx++,this},r.prototype.get=function(){return this._recs[this._idx].t="g",this._idx++,this},r.prototype.call=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._recs[this._idx].t="c",this._recs[this._idx].p=e,this._idx++,this},r.prototype.apply=function(e){return this.call.apply(this,e)},r.prototype.do=function(){var t=this;return this._send.resolve().then(function(){try{t._check()}catch(e){throw e}(t._recs.length>0?t._processor(t._recs,t._resp):e.spromise.resolved([])).then(function(e){return t._complete.resolve(e)})}),this.complete},r.prototype._check=function(){if(this._idx!==this._recs.length)throw new Error("Undefined record index: "+this._idx+" / "+this._recs.length);if(this._idx>0){for(var e=0,t=0,r=this._recs;t<r.length;t++){var i=r[t];if(!i.c)throw new Error("Undefined access chain on record "+e);if(!i.t)throw new Error("Undefined action on record "+e);if("s"===i.t&&!i.p)throw new Error("Undefined value on record "+e);e++}if(this._recs.length!==e)throw new Error("Unexpected records serialization")}},r}(e.base.ADebugableObject),i.Batch=s}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.sand||(t.sand={}),i=r.slave||(r.slave={}),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._queries={},t}return __extends(t,e),t.prototype.build=function(){return e.prototype.build.call(this),this.setTargetWin(window.parent),this},t.prototype.select=function(e){return new i.Query(this._processQuery.bind(this),[e]).setParent(this)},t.prototype.batch=function(){return new i.Batch(this._processBatch.bind(this)).setParent(this)},t.prototype._handleCommand=function(t,i){switch(t){case r.cmdInit:this._send(r.cmdInitDone);break;case r.cmdLoad:this._whenConnect.resolve();break;case r.cmdBatchDone:var s=i.i;this._queries[s]&&this._queries[s].resolve(i.r),delete this._queries[s];break;default:e.prototype._handleCommand.call(this,t,i)}},t.prototype._processQuery=function(e,t,r){for(var i=[],s=3;s<arguments.length;s++)i[s-3]=arguments[s];return this._processBatch([{c:t,t:e,p:i}],r)},t.prototype._processBatch=function(e,t){var s=this._newQueryId(),n=(new i.QueryDeffer).setParent(this).build();return this._send(r.cmdBatch,{i:s,b:this._toRemoteQueryPlans(e),n:t}),t?this._queries[s]=n:n.resolve([]),n.promise},t.prototype._newQueryId=function(){var e,t=0;do{e=Number(new Date).toString()+("0000000"+(t++).toString()).slice(-8)}while(this._queries[e]);return e},t}(r.AGateway),i.Gateway=s}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.platform||(t.platform={}),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"_conveyor",{get:function(){return this._gateway.conveyor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"current",{get:function(){var e=this;return this._current||(this._current=this._batch().resp(!1),this._conveyor.append(function(){e._current&&(e._current.do(),delete e._current)})),this._current},enumerable:!0,configurable:!0}),t.prototype.setGateway=function(e){return this._gateway=e,this},t.prototype.setChain=function(e){return this._chain=e,this},t.prototype._query=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var i=0,s=this._chain.concat(t);i<s.length;i++){var n=s[i];e=e?e.select(n):this._gateway.select(n)}return e},t.prototype._batch=function(){return this._gateway.batch()},t.prototype._append=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var i=0,s=this._chain.concat(t);i<s.length;i++){var n=s[i];e.select(n)}return e},t}(e.base.factory.ABuildableItem),r.AMasterWrapper=i}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.platform||(t.platform={}),i=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"linear",{get:function(){return this._linear},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"nonlinear",{get:function(){return this._nonlinear},enumerable:!0,configurable:!0}),i.prototype.build=function(){return t.prototype.build.call(this),this._linear=(new r.PlayerWrapper).setParent(this).setGateway(this._gateway).setChain(this._chain.concat(["linear"])).build(),this._nonlinear=(new r.PlayerWrapper).setParent(this).setGateway(this._gateway).setChain(this._chain.concat(["nonlinear"])).build(),this},i.prototype.connect=function(t){var r=this,i=e.spromise.deffer();return this._conveyor.append(function(){for(var e in r.current.resp(!0),r._append(r.current,"config").get(),r._append(r.current,"interactiveTypes").get(),r._append(r.current,"getSize").call(),t)r._append(r.current,"registerCallback").call(e,t[e]);r._append(r.current,"connect").call(),r.current.complete.then(function(e){return i.resolve({config:e[0].v,interactiveTypes:e[1].v,sizeRec:e[2].v})})}),i.promise},i.prototype.event=function(t){for(var r=this,i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];var n=e.spromise.deffer();return this._conveyor.append(function(){return r._append(r.current,"event").apply([t].concat(i))}),n.resolve(),n.promise},i.prototype.track=function(t,r){var i,s=this,n=e.spromise.deffer();return r?i=function(){return n.resolve()}:n.resolve(),this._conveyor.append(function(){return s._append(s.current,"track").call(t,i)}),n.promise},i.prototype.request=function(t,r,i){var s=this,n=e.spromise.deffer();return this._conveyor.append(function(){s._append(s.current,"request").call(t,r,i,function(e){return e.succeed?n.resolve(e):n.reject(e)})}),n.promise},i.prototype.initPalyer=function(e,t,r,i,s){var n=this;this._conveyor.append(function(){var a;switch(e){case"showLinearInteractive":case"showVideo":a="linear";break;case"showBanner":case"showTeaser":a="nonlinear"}n._append(n.current,"buildPalyer").call(e,t,r);for(var o=0,d=s;o<d.length;o++){var c=d[o];n._append(n.current,a,"subscribe").call(i(c),c)}n._append(n.current,a,"initAd").call()})},i}(r.AMasterWrapper),r.ClientWrapper=i}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.platform||(t.platform={}),i=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.initAd=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var s=e.spromise.deffer();return this._conveyor.append(function(){return t._append(t.current,"initAd").apply(r)}),s.resolve(),s.promise},r.prototype.reloadAd=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var s=e.spromise.deffer();return this._conveyor.append(function(){return t._append(t.current,"reloadAd").apply(r)}),s.resolve(),s.promise},r.prototype.startAd=function(){var t=this,r=e.spromise.deffer();return this._conveyor.append(function(){return t._append(t.current,"startAd").call()}),r.resolve(),r.promise},r.prototype.stopAd=function(){var t=this,r=e.spromise.deffer();return this._conveyor.append(function(){return t._append(t.current,"stopAd").call()}),r.resolve(),r.promise},r.prototype.pauseAd=function(){var t=this,r=e.spromise.deffer();return this._conveyor.append(function(){return t._append(t.current,"pauseAd").call()}),r.resolve(),r.promise},r.prototype.resumeAd=function(){var t=this,r=e.spromise.deffer();return this._conveyor.append(function(){return t._append(t.current,"resumeAd").call()}),r.resolve(),r.promise},r.prototype.subscribe=function(t,r){var i=this,s=e.spromise.deffer();return this._conveyor.append(function(){return i._append(i.current,"subscribe").call(t,r)}),s.resolve(),s.promise},r.prototype.unsubscribe=function(t,r){var i=this,s=e.spromise.deffer();return this._conveyor.append(function(){return i._append(i.current,"unsubscribe").call(t,r)}),s.resolve(),s.promise},r.prototype.dispose=function(t){var r=this,i=e.spromise.deffer();return this._conveyor.append(function(){return r._append(r.current,"dispose").call(t)}),i.resolve(),i.promise},r}(r.AMasterWrapper),r.PlayerWrapper=i}(advark||(advark={})),function(e){var t,r;t=e.token||(e.token={}),r=function(t){function r(){var r=null!==t&&t.apply(this,arguments)||this;return r._loading=!1,r._loaded=!1,r._loader=function(t){return(new e.request.Request).setUri(t).setMethod("GET").setHeaders({Accept:"text/plain"}).setTimeout(5e3).build().send()},r}return __extends(r,t),r._Def=function(){return{token:void 0,created:new Date,delta:0,source:!0}},r._Load=function(e,t,r){if(!e)throw new Error("Token is empty");var i=e.split(".");if(!i[1])throw new Error("Token bad format");var s=i[1].replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(s),a=JSON.parse(n),o=(new Date).getTime();if(o>a.exp)throw new Error("Token expired");return{token:e,created:new Date(a.iat),delta:o-a.iat+(t||0),source:r||!1}},Object.defineProperty(r.prototype,"name",{get:function(){return"TokenTracker"},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"time",{get:function(){return isNaN(this._rec&&this._rec.delta)?new Date:new Date((new Date).getTime()-this._rec.delta)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"created",{get:function(){return this._rec&&this._rec.created},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"whenLoad",{get:function(){return this._load(),this._whenLoad.promise.anycase(function(t){return e.spromise.resolved(t)})},enumerable:!0,configurable:!0}),r.prototype.setToken=function(e){return this._rec=e,this},r.prototype.setTokenStr=function(e,t){return void 0===t&&(t=void 0),this._rec={token:e,delta:t,created:void 0,source:void 0},this},r.prototype.setLoader=function(e){return this._loader=e||this._loader,this},r.prototype.drop=function(){delete this._rec,this._loading=!1,this._loaded=!1,this._load()},r.prototype._load=function(){var t=this,i=function(r){!r&&t._whenLoad||(r&&t._whenLoad&&t._whenLoad.reject(t._rec),t._whenLoad=e.spromise.deffer())};this._loading||(this._loaded||this._parse()?(i(!1),this._whenLoad.resolve(this._rec)):(this._loading=!0,i(!0),this._loader(r._Uri+"?e="+encodeURIComponent(",~ref,"+e.getHosts().join(",")+",~")+"&r="+(new Date).getTime()).inspect(function(e){t._loading=!1,t._loaded=!0,t._parse(e&&e.text,void 0,!0)?t._whenLoad.resolve(t._rec):t._whenLoad.reject(t._rec)})))},r.prototype._parse=function(e,t,i){i=(e=""===e?void 0:e)?i:this._rec&&this._rec.source,t=e?t:this._rec&&this._rec.delta;var s=!1;if(e=e||this._rec&&this._rec.token)try{this._rec=r._Load(e,t,i),s=!0}catch(e){}return s||(this._rec=r._Def()),s},r._Uri=(location.protocol,"//st.tyt.me/track/a/init"),r}(e.base.factory.ABuildableItem),t.Tracker=r}(advark||(advark={})),function(e){!function(e){var t=/(?:https?:)?\/\/(.*?)(?:\:[0-9]*?)?(?:\/|$)/i;e.getDomain=function(e){var r=t.exec(e);return r?r[1]:""},e.formatTime=function(e,t,r){void 0===t&&(t=":"),void 0===r&&(r=!1);var i=Math.floor(e%60),s=Math.floor(e/60)%60,n=Math.floor(e/3600),a=i.toString(),o=s.toString(),d="";return i<10&&(a="0"+a),s<10&&(o="0"+o),(n>0||r)&&(d=n.toString()+t,n<10&&(d="0"+d)),d+o+t+a},e.parseTime=function(e){try{for(var t=e.split("."),r=t[0].split(":"),i=Number(t[1]),s=0,n=0;n<r.length;n++)s*=60,s+=Number(r[n]);return 1e3*s+(isNaN(i)?0:i)}catch(e){return NaN}},e.parseQueryString=function(e){var t={};if(e)for(var r=e.trim().split("&"),i=0;i<r.length;i++){var s=r[i].split("=");t[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return t},e.toQueryString=function(e){var t="";for(var r in e)t+=e[r]?(""===t?"":"&")+encodeURIComponent(r)+"="+encodeURIComponent(e[r]):"";return t}}(e.StringUtils||(e.StringUtils={}))}(advark||(advark={})),function(e){!function(e){var t="children",r="text/xml",i=new DOMParser;e.getFirstElement=function(e){if(e[t])return e[t][0];for(var r=0;r<e.childNodes.length;r++)if(e.childNodes[r].nodeType==document.ELEMENT_NODE)return e.childNodes[r]},e.parseXML=function(e){return i.parseFromString(e,r)},e.textByTag=function(e,t,r){void 0===r&&(r=void 0);var i=e.getElementsByTagName(t);return i&&i[0]?i[0].textContent.trim():r}}(e.XMLUtils||(e.XMLUtils={}))}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.build=function(){return e.prototype.build.call(this),this._registrar=(new r.Registrar).setParent(this).setContentData(this._contentData).build(),this},t.prototype._trackEvent=function(e){return r.trackings.trackEvent(e)},t.prototype._dispose=function(t){var r=this;return this._registrar?this._registrar.dispose(t).anycase(function(){delete r._registrar}).anycase(function(){return e.prototype._dispose.call(r,t)}):e.prototype._dispose.call(this,t)},t}(t.AContentDataOwner),r.ARegistrarOwner=i}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=function(t){function r(){var r=null!==t&&t.apply(this,arguments)||this;return r._devstatCycle=[e.devstat.msgToRequest,e.devstat.msgToVastLoad,e.devstat.msgToLoaded,e.devstat.msgToWaitUser,e.devstat.msgToImpression,e.devstat.msgToStarted,e.devstat.msgToStopped,e.devstat.msgToVideoStart,e.devstat.msgToFirstQuartile,e.devstat.msgToViewable],r}return __extends(r,t),r.DevstatName=function(t){if(t)switch(t.name){case"Vast":return e.devstat.clVastManager;case"Dispply":return e.devstat.clDissplyManager;case"Video":return e.devstat.clVideoManager;case"Vpaid":return e.devstat.clVpaidManager;case"Banner":return e.devstat.clBannerManager;case"Toro":return e.devstat.clToroManager;case"AdLabs":return e.devstat.clAdLabsManager;case"DirectAdvert":return e.devstat.clDirectAdvertManager;case"MarketGid":return e.devstat.clMarketGidManager;case"TeaserNet":return e.devstat.clTeaserNetManager;default:return e.devstat.clUnknownManager}return e.devstat.clNoManager},r.prototype._devstatCreateMessages=function(){if(this._devstatIsTracker)for(var e=0,t=this._devstatCycle;e<t.length;e++){var r=t[e];this._devstatDelete(r),this._devstatCreate(r,!1,!0)}},r.prototype._devstatWriteStarted=function(e,t){for(var r=0,i=this._devstatCycle;r<i.length;r++){var s=i[r];this.devstatIsStarted(e,s)&&this.devstatWrite(e,s,t)}},r.prototype._devstatSendStarted=function(e,t,r){void 0===r&&(r=void 0);for(var i=0,s=this._devstatCycle;i<s.length;i++){var n=s[i];this.devstatIsStarted(this,n)&&this.devstatSend(this,n,t,r)}},r}(r.ARegistrarOwner),r.AManageNodeDevstat=i}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e._sizeRec={width:void 0,height:void 0,viewMode:void 0},e}return __extends(i,t),i.prototype.setBreak=function(e){return this._break=e,this},i.prototype.setAdParams=function(t){return this._adParams="string"==typeof t?e.StringUtils.parseQueryString(t):t,this},i.prototype.setInteractiveTypes=function(e){return this._interactiveTypes=e,this},Object.defineProperty(i.prototype,"extensionsData",{get:function(){return this._child&&this._child.extensionsData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"preprData",{get:function(){return r.prepr.def(this._contentData,this._sizeRec)},enumerable:!0,configurable:!0}),i.prototype.setSizeRec=function(e){return this._sizeRec=e,this},Object.defineProperty(i.prototype,"eventDispatcher",{get:function(){return this._child},enumerable:!0,configurable:!0}),i.prototype._getHandlingEvents=function(){return[e.events.ClickRedirect,e.events.pod.BreakPod,e.events.pod.ResetPod,e.events.Progress,e.events.VastLoad,e.events.viewability.notViewable,e.events.viewability.viewable,e.events.viewability.viewUndetermined,e.events.WaitUser,e.vpaid.events.AdClickThru,e.vpaid.events.AdDurationChange,e.vpaid.events.AdError,e.vpaid.events.AdExpandedChange,e.vpaid.events.AdImpression,e.vpaid.events.AdInteraction,e.vpaid.events.AdLinearChange,e.vpaid.events.AdLoaded,e.vpaid.events.AdLog,e.vpaid.events.AdPaused,e.vpaid.events.AdPlaying,e.vpaid.events.AdRemainingTimeChange,e.vpaid.events.AdSizeChange,e.vpaid.events.AdSkippableStateChange,e.vpaid.events.AdSkipped,e.vpaid.events.AdStarted,e.vpaid.events.AdStopped,e.vpaid.events.AdUserAcceptInvitation,e.vpaid.events.AdUserClose,e.vpaid.events.AdUserMinimize,e.vpaid.events.AdVideoFirstQuartile,e.vpaid.events.AdVideoMidpoint,e.vpaid.events.AdVideoStart,e.vpaid.events.AdVideoThirdQuartile,e.vpaid.events.AdVideoComplete,e.vpaid.events.AdVolumeChange]},i.prototype._disposeChild=function(t){var r=this;return this._child?this._child.dispose(t).anycase(function(){delete r._child}).catch(function(){return e.spromise.resolved()}):e.spromise.resolved()},i.prototype._dispose=function(r){var i=this;return this._disposed?e.spromise.rejected(e.base.errors.Disposed):this._disposeChild(r).anycase(function(){return t.prototype._dispose.call(i,r)})},i}(r.AManageNodeDevstat),r.AManageNode=i}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=function(i){function s(){var e=null!==i&&i.apply(this,arguments)||this;return e._progress={time:0,duration:NaN},e._assetUri="",e}return __extends(s,i),s.prototype.setInit=function(e){return this._init=e,this},Object.defineProperty(s.prototype,"source",{get:function(){var e=this._child;return e&&e.source?e.source:this._source},enumerable:!0,configurable:!0}),s.prototype.setSource=function(e){return this._source=e,this},s.prototype.setFactory=function(e){return this._factory=e,this},s.prototype.setSettings=function(t){return this._settings=e.clone(t),this._settings.contentData&&this.setContentData(this._settings.contentData),this},s.prototype.build=function(){var t=this;if(i.prototype.build.call(this),!this._settings)throw new Error(e.base.errors.NotPassed);return this._settings.video=this._settings.video||{},this._settings.vpaid=this._settings.vpaid||{},this._disablePod=this._settings.breakAdPodDefault,this._registrar.setPreprDataCalc(function(){return e.extend(t.preprData,{CONTENTPLAYHEAD:t._progress.time?e.StringUtils.formatTime(t._progress.time)+".000":"",ASSETURI:t._assetUri})}),this},s.prototype._trackEvent=function(t){switch(t){case e.vpaid.events.AdSkipped:return this._settings.skipAsClose?r.trackings.close:r.trackings.skip;default:return i.prototype._trackEvent.call(this,t)}},s.prototype._handleEvent=function(t){for(var r=[],s=1;s<arguments.length;s++)r[s-1]=arguments[s];var n,a=this._trackEvent(t);return!e.events.allowMult(t)&&this._eventTimes[t]?e.spromise.rejected(e.base.errors.Duplicate):(a&&this._registrar.register(a),(n=i.prototype._handleEvent).apply.call(n,this,[t].concat(r)))},s.prototype._handleEventEnd=function(t){for(var r,s=[],n=1;n<arguments.length;n++)s[n-1]=arguments[n];switch(t){case e.events.pod.BreakPod:this._disablePod=!0;break;case e.events.pod.ResetPod:this._progress={time:0,duration:NaN}}return(r=i.prototype._handleEventEnd).apply.call(r,this,[t].concat(s))},s.prototype._handleError=function(s){if(this._disposing)return e.spromise.rejected(e.base.errors.Disposing);var n=t.AdError.Build(s);return n.data=n.data||this.source,this._registrar.register(r.trackings.error,{errorcode:n.code}),i.prototype._handleError.call(this,n)},s.prototype._wbrmPrepr=function(t,i){var s=this;return void 0===i&&(i=void 0),r.prepr.weborama.preprData(t).catch(function(){return e.spromise.resolved({})}).then(function(n){return r.prepr.process(t,e.extend(i||s.preprData,n))})},s}(r.AManageNode),r.AManageItem=i}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.factory||(r.factory={}),s=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.setFactory=function(e){return this.setItem("factory",e)},i.prototype.getFactory=function(){return this.getItem("factory")},i.prototype.setInit=function(e){return this.setItem("init",e)},i.prototype.getInit=function(){return this.getItem("init")},i.prototype.setAdParams=function(e){return this.setItem("adParams",e)},i.prototype.getAdParams=function(){return this.getItem("adParams")},i.prototype.setFiles=function(e){return this.setItem("files",e)},i.prototype.getFiles=function(){return this.getItem("files")},i.prototype.setSettings=function(e){return this.setItem("settings",e)},i.prototype.getSettings=function(){return this.getItem("settings")},i.prototype.extendSettings=function(t){var r=function(t,i,s){return void 0===s&&(s=3),s<0?t:(t=t||{},e.each(i,function(e,i){return t[i]="object"==typeof t[i]?r(t[i],e,s-1):e}),t)};return this.setItem("settings",r(this.getSettings(),t))},i.prototype.setContentData=function(e){var t=this.getSettings()||{};return t.contentData=t.contentData||e,this.setSettings(t)},i.prototype.getContentData=function(){var e=this.getSettings();return void 0!==e?e.contentData:void 0},i.prototype.setSizeRec=function(e){return this.setItem("sizeRec",e)},i.prototype.getSizeRec=function(){return this.getItem("sizeRec")},i.prototype.setInteractiveTypes=function(e){return this.setItem("interactiveTypes",e)},i.prototype.getInteractiveTypes=function(){return this.getItem("interactiveTypes")},i.prototype.setBreak=function(e){return this.setItem("break",e)},i.prototype.getBreak=function(){return this.getItem("break")},i.prototype.setMode=function(e){return this.setItem("mode",e)},i.prototype.getMode=function(){return this.getItem("mode")},i.prototype._construct=function(){if(this._factory&&this._files)for(var e=0;e<this._files.length;){var t=this._files[e];if(this._factory(this,t.path,t.type,t.type))break;e++}if(this._class)switch(this._class){case r.player.AdLabs:return new r.player.AdLabs;case r.player.Banner:return new r.player.Banner;case r.player.DirectAdvert:return new r.player.DirectAdvert;case r.player.Dispply:return new r.player.Dispply;case r.player.Dummy:return new r.player.Dummy;case r.player.MarketGid:return new r.player.MarketGid;case r.player.TeaserNet:return new r.player.TeaserNet;case r.player.RedTram:return new r.player.RedTram;case r.player.Toro:return new r.player.Toro;case r.player.Video:return new r.player.Video;case r.player.Vpaid:return new r.player.Vpaid;case r.Vast:return new r.Vast;case r.Ad:return new r.Ad;default:throw new Error("Unknown class: "+this._class)}throw new Error("Unknown build method")},i.prototype._beforeBuild=function(e){e instanceof r.AManageItem?e.setFactory(this._factory).setSettings(this._settings).setInit(this._init):e instanceof r.player.ABase&&(this._files&&e.setFiles(this._files),e instanceof r.player.Dispply&&e.setMode(this._mode),e instanceof r.player.Vpaid&&e.setSettings(this._settings.vpaid),e instanceof r.player.Video&&e.setSettings(this._settings.video)),this._sizeRec&&e.setSizeRec(this._sizeRec),this._interactiveTypes&&e.setInteractiveTypes(this._interactiveTypes),this._break&&e.setBreak(this._break),this._adParams&&e.setAdParams(this._adParams)},i}(e.base.factory.ABuilder),i.Builder=s}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.manage||(t.manage={}),(i=r.factory||(r.factory={})).NoBuiltInFactory=function(){return!1},i.BuiltInFactory=function(e,t,r,s){return i.modules.getModule(e,t)}}(advark||(advark={})),function(e){var t,r,i,s,n;t=e.module||(e.module={}),r=t.manage||(t.manage={}),n=r.factory||(r.factory={}),i={"/vn.swf":function(e){return e.setClass(r.player.Dummy)},"/cu.swf":function(e){return e.setClass(r.player.Dummy)},"/pa_c.swf":function(e){return e.setClass(r.player.Dummy)},"/bg.swf":function(e){return e.setClass(r.player.Dummy)},"/mg.swf":function(e){return e.setClass(r.player.MarketGid)},"/al.swf":function(e){return e.setClass(r.player.AdLabs)},"/da.swf":function(e){return e.setClass(r.player.DirectAdvert)},"/tn.swf":function(e){return e.setClass(r.player.TeaserNet)},"/redtram":function(e){return e.setClass(r.player.RedTram)},"/dp.js":function(e){return e.setClass(r.player.Dispply).setMode("default")},"/dp_cr.js":function(e){return e.setClass(r.player.Dispply).setMode("default")},"/dp_is.js":function(e){return e.setClass(r.player.Dispply).setMode("is")},"/tr.swf":function(e){return e.setClass(r.player.Toro)}},s=!1,(n.modules||(n.modules={})).getModule=function(e,t){if(!s){s=!0;var a=function(){var e={},t=function(t){var i=n.vast.modules.records[t];e[t]=function(e){return e.setClass(r.Vast).setFactory(n.NoBuiltInFactory).extendSettings(i)}};for(var i in n.vast.modules.records)t(i);return e}();for(var o in a)o=o.toLowerCase(),i[o],i[o]=a[o]}return!!i[t.toLowerCase()]&&(i[t.toLowerCase()](e),!0)}}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.factory||(r.factory={}),((s=i.vast||(i.vast={})).modules||(s.modules={})).records={"/advark.swf":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!1},"/vast.swf":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!1},"/vast.js":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!1},"/av.swf":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!1},"/am.swf":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!1},"/pa.swf":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!1},"/ya.swf":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!1,vpaid:{frameAsSlot:!0}},"/wr.swf":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!1},"/iv_vast.swf":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!0,strictImpressionOrder:!0,sameSkipTime:!1},"/imhovi.swf":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!0,skipAsClose:!0,strictImpressionOrder:!0,vpaid:{showLogo:!1,onClickThru:"pause"}},"/vast_60.swf":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!0,skipAsClose:!0,strictImpressionOrder:!0,vpaid:{showLogo:!1,onClickThru:"pause"}},"/vast_60.js":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!0,skipAsClose:!0,strictImpressionOrder:!0,vpaid:{showLogo:!1}},"/vast_69.swf":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!1,impressionAsVideoStart:!0},"/vast_69.js":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!1,impressionAsVideoStart:!0},"/cr.swf":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!1,video:{volumeMode:"hover"},vpaid:{volumeMode:"hover"}},"/cr.js":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!1,video:{volumeMode:"hover"},vpaid:{volumeMode:"hover"}},"/gv_cr.swf":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!1,video:{volumeMode:"hover"},vpaid:{volumeMode:"hover"}},"/imhovi_cr.swf":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!0,vpaid:{volumeMode:"hover"}},"/imhovi_cr.js":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!0,vpaid:{volumeMode:"hover"}},"/cr_60.swf":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!0,vpaid:{volumeMode:"hover"}},"/cr_60.js":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!0,vpaid:{volumeMode:"hover"}},"/cr_69.swf":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!1},"/cr_69.js":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!1},"/is.js":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!1,video:{implicitSize:!0,timerTextTemplate:"До возврата на сайт осталось {s} секунд",closeTimeout:NaN,skipTimeout:0,redirectText:"",timerMode:"end",showLogo:!1},vpaid:{closeTimeout:NaN,timerTextTemplate:"До возврата на сайт осталось {s} секунд",skipTimeout:0,showLogo:!1,controls:{close:"0",label:"0",timer:"1",volume:"0",skip:"1"}}},"/vastnl.swf":{allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!1}}}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.player||(r.player={}),s=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.resetAd=function(){return e.spromise.rejected(e.base.errors.NotImplemented)},r}(r.AManageNode),i.Dummy=s}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.player||(r.player={}),s=function(r){function i(){return null!==r&&r.apply(this,arguments)||this}return __extends(i,r),i.prototype.setFiles=function(e){return this._files=e,this},i.prototype.setSettings=function(e){return this._settings=e,this},Object.defineProperty(i.prototype,"eventDispatcher",{get:function(){return this._disposing?void 0:this.player},enumerable:!0,configurable:!0}),i.prototype._buildFiles=function(){var r=this;return this._adParams&&this._adParams.url?(new t.frame.Request).setUri(this._adParams.url).setCredentials("false"!==this._adParams.credentials).send().then(function(e){return r._onFeedLoad(e)},function(e){return r._onFeedError(e)}):this._files&&this._files.length>0?e.spromise.resolved():e.spromise.rejected(e.base.errors.InvalidParams)},i.prototype._buildSettings=function(){return e.spromise.resolved()},i.prototype.initAd=function(){var t=this;return this._dispatch(e.events.VastLoad).then(function(){return t._buildFiles()}).then(function(){return t._buildSettings()}).then(function(){return r.prototype.initAd.call(t)})},i.prototype._handleEvent=function(t){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];var n,a=e.devstat.EventName(t);return a&&this._devstatWriteStarted(this,e.devstat.strPlayer+e.devstat.strField+a),(n=r.prototype._handleEvent).apply.call(n,this,[t].concat(i))},i.prototype._onFeedLoad=function(t){return e.spromise.rejected(e.base.errors.NotImplemented)},i.prototype._onFeedError=function(r){var i=r?r.error:void 0,s="linear"===this._break.type?t.errors.AdLinearFeedError(i):t.errors.AdNonLinearFeedError(i);return e.spromise.rejected(s)},i.prototype.__initAd=function(){t.frame.client.initPalyer(this.factoryName,this._files,this._settings,this._createEventHandler.bind(this),this._getHandlingEvents())},i.prototype.__startAd=function(){this.player.startAd()},i.prototype.__stopAd=function(){this.player.stopAd()},i.prototype.__pauseAd=function(){this.player.pauseAd()},i.prototype.__resumeAd=function(){this.player.resumeAd()},i._ClientTimeout=2e3,i}(r.AManageNode),i.ABase=s}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.player||(r.player={}),s=function(r){function i(){return null!==r&&r.apply(this,arguments)||this}return __extends(i,r),Object.defineProperty(i.prototype,"player",{get:function(){return t.frame.client.linear},enumerable:!0,configurable:!0}),i.prototype._handleEventEnd=function(t){for(var i,s,n=this,a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];if(this._disposing)return e.spromise.rejected(e.base.errors.Disposing);switch(t){case e.vpaid.events.AdStarted:e.context.secretKeys.iframe_pauseLinear&&setTimeout(function(){return n.pauseAd()},5e3)}return i=i||(s=r.prototype._handleEventEnd).apply.call(s,this,[t].concat(a))},i}(i.ABase),i.ALinear=s}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.player||(r.player={}),s=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"name",{get:function(){return"Dispply"},enumerable:!0,configurable:!0}),i.prototype.setMode=function(e){return this._mode=e,this},i.prototype.build=function(){t.prototype.build.call(this);var e={width:void 0,height:void 0,path:void 0,type:"image/jpeg"};return this._files=[e],this},Object.defineProperty(i.prototype,"factoryName",{get:function(){return"showVideo"},enumerable:!0,configurable:!0}),i.prototype._onFeedLoad=function(t){if(this._disposing)return e.spromise.rejected(e.base.errors.Disposing);var i,s=JSON.parse(t.text);if("success"==s.status&&s.ads[0]&&s.ads[0].creatives&&s.ads[0].creatives.image){if(this._files[0].path=s.ads[0].creatives.image.url,this._settings.redirectUrl=s.ads[0].click_url,s.ads[0].cta&&(this._settings.redirectText=s.ads[0].cta),s.ads[0].beacons)for(var n in s.ads[0].beacons)this._registrar.appendUri(r.trackings.impression,n);i=e.spromise.resolved()}else i=e.spromise.rejected(e.base.errors.BadFeed);return i},i.prototype._handleEventEnd=function(i){for(var s,n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];switch(i){case e.vpaid.events.AdStarted:this._registrar.register(r.trackings.impression)}return(s=t.prototype._handleEventEnd).apply.call(s,this,[i].concat(n))},i.prototype._buildSettings=function(){switch(this._mode){case"default":this._settings={timerMode:"default",duration:2e4,skipTimeout:NaN,closeTimeout:3e3,showLogo:!0,timerTextTemplate:"{0}",onClickThru:"end"};break;case"is":this._settings={timerMode:"end",duration:1e4,skipTimeout:0,closeTimeout:NaN,showLogo:!1,timerTextTemplate:"До возврата на сайт осталось {s} секунд",onClickThru:"end"}}return e.spromise.resolved()},i}(i.ALinear),i.Dispply=s}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.player||(r.player={}),s=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),Object.defineProperty(r.prototype,"name",{get:function(){return"Video"},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"factoryName",{get:function(){return"showVideo"},enumerable:!0,configurable:!0}),r.prototype._buildSettings=function(){var t={timerMode:"default",skipTimeout:NaN,closeTimeout:NaN,showLogo:!0,redirectText:"Перейти на сайт рекламодателя",timerTextTemplate:"{0}",duration:2e4,onClickThru:"pause",volumeMode:"default"};return this._settings=e.extend(t,this._settings),e.spromise.resolved()},r}(i.ALinear),i.Video=s}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.player||(r.player={}),s=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),Object.defineProperty(r.prototype,"name",{get:function(){return"Vpaid"},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"factoryName",{get:function(){return"showLinearInteractive"},enumerable:!0,configurable:!0}),r.prototype._buildSettings=function(){return this._settings=e.extend({volumeMode:"default",showLogo:!0,timerTextTemplate:"{0}",onClickThru:"none"},this._settings),e.spromise.resolved()},r}(i.ALinear),i.Vpaid=s}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.player||(r.player={}),s=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return __extends(r,e),Object.defineProperty(r.prototype,"player",{get:function(){return t.frame.client.nonlinear},enumerable:!0,configurable:!0}),r}(i.ABase),i.ANonLinear=s}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.player||(r.player={}),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"Banner"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"factoryName",{get:function(){return"showBanner"},enumerable:!0,configurable:!0}),t}(i.ANonLinear),i.Banner=s}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.player||(r.player={}),s=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"factoryName",{get:function(){return"showBanner"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return"Toro"},enumerable:!0,configurable:!0}),i.prototype._onFeedLoad=function(t){if(this._disposing)return e.spromise.rejected(e.base.errors.Disposing);var i,s=e.XMLUtils.parseXML(t.text),n=e.XMLUtils.textByTag(s,"creative"),a=e.XMLUtils.textByTag(s,"click"),o=e.XMLUtils.textByTag(s,"beacon");if(n&&a&&o){var d={image:n,width:468,height:60,closeTimeout:12e3,link:a};this._files=[d],this._registrar.appendUri(r.trackings.impression,o),i=e.spromise.resolved()}else i=e.spromise.rejected(e.base.errors.Empty);return i},i.prototype._handleEventEnd=function(i){for(var s,n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];switch(i){case e.vpaid.events.AdStarted:this._registrar.register(r.trackings.impression)}return(s=t.prototype._handleEventEnd).apply.call(s,this,[i].concat(n))},i}(i.ANonLinear),i.Toro=s}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.player||(r.player={}),s=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),Object.defineProperty(r.prototype,"factoryName",{get:function(){return"showTeaser"},enumerable:!0,configurable:!0}),r.prototype._buildSettings=function(){return this._settings={repeat:!0,minimizedText:"title",closeTimeout:0},e.spromise.resolved()},r.prototype._onFeedLoad=function(t){if(this._disposing)return e.spromise.rejected(e.base.errors.Disposing);var r=e.XMLUtils.parseXML(t.text);return this._files=this._parseTeasers(r),this._files&&this._files.length>0?e.spromise.resolved():e.spromise.rejected(e.base.errors.Empty)},r}(i.ANonLinear),i.ATeaser=s}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.player||(r.player={}),s=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),Object.defineProperty(r.prototype,"name",{get:function(){return"AdLabs"},enumerable:!0,configurable:!0}),r.prototype._getTeaserSettings=function(){return{repeat:!1,minimizedText:"description",closeTimeout:0}},r.prototype._parseTeasers=function(t){var r=[],i=t.getElementsByTagName("banner")[0];if(i){var s={title:e.XMLUtils.textByTag(i,"title"),description:e.XMLUtils.textByTag(i,"article"),link:e.XMLUtils.textByTag(i,"url"),image:e.XMLUtils.textByTag(i,"image")};r.push(s)}return r},r.prototype._reloadAd=function(){this.player.reloadAd(this._files)},r.prototype._handleEventEnd=function(r){for(var i,s=this,n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];switch(r){case e.events.TeaserEnd:this._buildFiles().anycase(function(){return s._reloadAd()})}return(i=t.prototype._handleEventEnd).apply.call(i,this,[r].concat(n))},r}(i.ATeaser),i.AdLabs=s}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.player||(r.player={}),s=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),Object.defineProperty(r.prototype,"name",{get:function(){return"DirectAdvert"},enumerable:!0,configurable:!0}),r.prototype._parseTeasers=function(t){var r=[],i=t.getElementsByTagName("Creative");return e.each(i,function(t){var i=e.XMLUtils.textByTag(t,"click"),s=e.XMLUtils.textByTag(t,"title"),n=e.XMLUtils.textByTag(t,"text"),a=e.XMLUtils.textByTag(t,"img");if(i&&(s||n)){var o={title:s,description:n,link:i,image:a};r.push(o)}}),r},r}(i.ATeaser),i.DirectAdvert=s}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.player||(r.player={}),s=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),Object.defineProperty(r.prototype,"name",{get:function(){return"MarketGid"},enumerable:!0,configurable:!0}),r.prototype._parseTeasers=function(t){var r=[],i=t.getElementsByTagName("item");return e.each(i,function(t){var i={title:e.XMLUtils.textByTag(t,"title"),description:e.XMLUtils.textByTag(t,"description"),link:e.XMLUtils.textByTag(t,"link"),image:e.XMLUtils.textByTag(t,"image")};i.link&&r.push(i)}),r},r}(i.ATeaser),i.MarketGid=s}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.player||(r.player={}),s=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),Object.defineProperty(r.prototype,"name",{get:function(){return"TeaserNet"},enumerable:!0,configurable:!0}),r.prototype._parseTeasers=function(t){var r=[],i=t.getElementsByTagName("itm");return e.each(i,function(t){var i={title:e.XMLUtils.textByTag(t,"ttl"),description:e.XMLUtils.textByTag(t,"desc"),link:e.XMLUtils.textByTag(t,"link"),image:e.XMLUtils.textByTag(t,"img"),bid:Number(e.XMLUtils.textByTag(t,"bid"))};i.link&&r.push(i)}),r=r.sort(function(e,t){return t.bid-e.bid})},r}(i.ATeaser),i.TeaserNet=s}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.player||(r.player={}),s=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),Object.defineProperty(r.prototype,"name",{get:function(){return"RedTram"},enumerable:!0,configurable:!0}),r.prototype._parseTeasers=function(t){var r=[],i=t.getElementsByTagName("offer");return e.each(i,function(e){return r.push({title:e.getElementsByTagName("name")[0].textContent.trim(),description:e.getElementsByTagName("description")[0].textContent.trim(),link:e.getElementsByTagName("url")[0].textContent.trim(),image:e.getElementsByTagName("picture")[0].textContent.trim()})}),r},r}(i.ATeaser),i.RedTram=s}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=function(i){function s(){return null!==i&&i.apply(this,arguments)||this}return __extends(s,i),s.prototype.devstatSend=function(e,t,s,n,a){void 0===s&&(s=void 0),void 0===n&&(n=void 0),void 0===a&&(a=void 0),this._devstatIsTracker?(a=this._devstatSender()+(a?":"+a:""),e instanceof r.tracker.Tracker?this._devstatTransmit(t,s,a,n):this._devstatFilter(e,t,a)?i.prototype.devstatSend.call(this,e,t,s,n,a):this._devstatDelete(t)):i.prototype.devstatSend.call(this,e,t,s,n,a)},s.prototype._devstatInit=function(){this._devstatCreateMessages(),this.devstatWrite(this,e.devstat.msgToRequest,e.devstat.evtSelect),this._isPrimary&&(this._contentData.uid||this._devstatTransmit(e.devstat.errNoUid,e.base.STR_NO_VALUE))},s.prototype._devstatTransmit=function(e,t,r,s){void 0===r&&(r=void 0),void 0===s&&(s=void 0),this._devstatFilter(this,e)&&i.prototype._devstatTransmit.call(this,e,t,this._devstatSender(),s)},Object.defineProperty(s.prototype,"_devstatIsTracker",{get:function(){return!!this._isPrimary},enumerable:!0,configurable:!0}),s.prototype._devstatSender=function(){var t=this._advertId?this._advertId.toString():"",r=this._isPrimary?this._isInternal?"internal":this._campaignId?this._campaignId.toString():"?":"";return i.prototype._devstatSender.call(this)+e.devstat.strSelector+this._break.id+e.devstat.strSelector+t+e.devstat.strSelector+r},s.prototype._devstatFilter=function(t,r,i){switch(r){case e.devstat.errDmpTooLate:case e.devstat.msgToViewable:return!1;default:return!0}},s.prototype._devstatBreak=function(t){if(this._isPrimary){var r,i;if("string"==typeof t)r=e.devstat.strBreakPrefix+t;else switch(r=e.devstat.strErrorPrefix+t.code+e.devstat.strErrorData+t.message,t.code){case e.vast.errors.WrapperNoAd:case e.vast.errors.DmpReject:break;default:i=t.data}this._devstatSendStarted(this,r,i)}},s.prototype._handleEvent=function(t){for(var r,s=[],n=1;n<arguments.length;n++)s[n-1]=arguments[n];if(this._devstatIsTracker){var a=e.devstat.EventName(t);switch(t){case e.vpaid.events.AdError:break;default:a&&this._devstatWriteStarted(this,a)}switch(t){case e.events.VastLoad:this.devstatSendIfStarted(this,e.devstat.msgToVastLoad),this.devstatWrite(this,e.devstat.msgToLoaded,a);break;case e.events.WaitUser:this.devstatSendIfStarted(this,e.devstat.msgToWaitUser),this.devstatWrite(this,e.devstat.msgToImpression,a);break;case e.events.viewability.viewable:case e.events.viewability.notViewable:case e.events.viewability.viewUndetermined:this.devstatSend(this,e.devstat.msgToViewable,t);break;case e.vpaid.events.AdLoaded:this.devstatSendIfStarted(this,e.devstat.msgToLoaded),this.devstatWrite(this,e.devstat.msgToWaitUser,a);break;case e.vpaid.events.AdImpression:this.devstatSendIfStarted(this,e.devstat.msgToWaitUser),this.devstatSendIfStarted(this,e.devstat.msgToImpression),this.devstatWrite(this,e.devstat.msgToStarted,a);break;case e.vpaid.events.AdStarted:this.devstatSendIfStarted(this,e.devstat.msgToWaitUser),this.devstatSendIfStarted(this,e.devstat.msgToImpression),this.devstatSendIfStarted(this,e.devstat.msgToStarted),this.devstatWrite(this,e.devstat.msgToVideoStart,a),this.devstatWrite(this,e.devstat.msgToStopped,a);break;case e.vpaid.events.AdVideoStart:this.devstatSendIfStarted(this,e.devstat.msgToWaitUser),this.devstatSendIfStarted(this,e.devstat.msgToImpression),this.devstatSendIfStarted(this,e.devstat.msgToStarted),this.devstatSendIfStarted(this,e.devstat.msgToVideoStart),this.devstatWrite(this,e.devstat.msgToFirstQuartile,a);break;case e.vpaid.events.AdVideoFirstQuartile:this.devstatSendIfStarted(this,e.devstat.msgToFirstQuartile);break;case e.vpaid.events.AdStopped:this.devstatSendIfStarted(this,e.devstat.msgToFirstQuartile),this.devstatSendIfStarted(this,e.devstat.msgToVideoStart),this.devstatSendIfStarted(this,e.devstat.msgToStopped)}}return(r=i.prototype._handleEvent).apply.call(r,this,[t].concat(s))},s.prototype.startAd=function(){return this._devstatWriteStarted(this,e.devstat.MethodName("startAd")+e.devstat.strCalled),i.prototype.startAd.call(this)},s.prototype.stopAd=function(){return this._devstatWriteStarted(this,e.devstat.MethodName("stopAd")+e.devstat.strCalled),i.prototype.stopAd.call(this)},s.prototype.pauseAd=function(){return this._devstatWriteStarted(this,e.devstat.MethodName("pauseAd")+e.devstat.strCalled),i.prototype.pauseAd.call(this)},s.prototype.resumeAd=function(){return this._devstatWriteStarted(this,e.devstat.MethodName("resumeAd")+e.devstat.strCalled),i.prototype.resumeAd.call(this)},s.prototype._handleError=function(r){return this._disposing?e.spromise.rejected(e.base.errors.Disposing):(this._devstatBreak(t.AdError.Build(r)),i.prototype._handleError.call(this,r))},s.prototype._dispose=function(t){return this._disposed?e.spromise.rejected(e.base.errors.Disposed):(this._devstatBreak(t),i.prototype._dispose.call(this,t))},s}(r.AManageItem),r.AdDevstat=i}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e._trackingMapTrackings={},e._trackingMapExtensions={},e}return __extends(i,t),i.prototype.build=function(){return t.prototype.build.call(this),this._trackingMapTrackings[e.vast.trackings.any.mute]=r.trackings.mute,this._trackingMapTrackings[e.vast.trackings.any.unmute]=r.trackings.unmute,this._trackingMapTrackings[e.vast.trackings.any.pause]=r.trackings.pause,this._trackingMapTrackings[e.vast.trackings.any.rewind]=r.trackings.rewind,this._trackingMapTrackings[e.vast.trackings.any.resume]=r.trackings.resume,this._trackingMapTrackings[e.vast.trackings.any.skip]=r.trackings.skip,this._trackingMapTrackings[e.vast.trackings.any.playerExpand]=r.trackings.playerExpand,this._trackingMapTrackings.fullscreen=r.trackings.playerExpand,this._trackingMapTrackings[e.vast.trackings.any.playerCollapse]=r.trackings.playerCollapse,this._trackingMapTrackings.exitFullscreen=r.trackings.playerCollapse,this._trackingMapTrackings[e.vast.trackings.linear.acceptInvitationLinear]=r.trackings.acceptInvintation,this._trackingMapTrackings[e.vast.trackings.linear.start]=r.trackings.start,this._trackingMapTrackings[e.vast.trackings.linear.firstQuartile]=r.trackings.videoFirstQuartile,this._trackingMapTrackings[e.vast.trackings.linear.midpoint]=r.trackings.videoMidpoint,this._trackingMapTrackings[e.vast.trackings.linear.thirdQuartile]=r.trackings.videoThridQuartile,this._trackingMapTrackings[e.vast.trackings.linear.complete]=r.trackings.videoComplete,this._trackingMapTrackings.closeLinear=r.trackings.close,this._trackingMapTrackings[e.vast.trackings.nonlinear.acceptInvitation]=r.trackings.acceptInvintation,this._trackingMapTrackings[e.vast.trackings.nonlinear.creativeView]=r.trackings.creativeView,this._trackingMapTrackings[e.vast.trackings.nonlinear.minimize]=r.trackings.minimize,this._trackingMapTrackings[e.vast.trackings.nonlinear.close]=r.trackings.close,this._trackingMapTrackings.expand=r.trackings.expand,this._trackingMapTrackings.adExpand=r.trackings.expand,this._trackingMapTrackings.collapse=r.trackings.collapse,this._trackingMapTrackings.adCollapse=r.trackings.collapse,this._trackingMapTrackings.onVastLoad=r.trackings.vastLoad,this._trackingMapTrackings.viewable=r.trackings.viewable,this._trackingMapTrackings.notViewable=r.trackings.notViewable,this._trackingMapTrackings.viewUndetermined=r.trackings.viewUndetermined,this._trackingMapExtensions.addClick=r.trackings.click,this._trackingMapExtensions.skipAd=r.trackings.skip,this._trackingMapExtensions.advideostart=r.trackings.videoStart,this._trackingMapExtensions.adselected=r.trackings.select,this._trackingMapExtensions.adrequested=r.trackings.request,this},i.prototype._loadTrackings=function(t){var r=this;t&&e.each(t.getElementsByTagName("Tracking"),function(e){return r._loadTracking(e)})},i.prototype._loadTracking=function(t){var i=t.getAttribute("event"),s=this._trackingMapTrackings[i];if(s)this._registrar.appendUri(s,t.textContent);else switch(i){case e.vast.trackings.linear.progress:this._registrar.appendProgressUri(t.getAttribute("offset"),t.textContent);break;default:var n="event: "+i;this._devstatTransmit(r.tracker.devstat.UNKNOWN_TRACKING,n,void 0,t)}},i.prototype._loadTrackingExt=function(e){var t=e.getAttribute("type"),r=this._trackingMapExtensions[t];if(r)this._registrar.appendUri(r,e.textContent);else switch(t){case"CustomTracking":this._loadTrackings(e)}},i}(r.AdDevstat),r.AdTracker=i}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e._extData={},e}return __extends(i,t),i._writeSetting=function(e,t){return void 0===t?e:t},Object.defineProperty(i.prototype,"extensionsData",{get:function(){return this._extData},enumerable:!0,configurable:!0}),i.prototype.build=function(){var e=this;return t.prototype.build.call(this),this._manager=(new r.adext.Manager).setParent(this).setContentData(this._contentData).build(),this._registrar.setUriPreprocessor(function(t,r){return e._manager.preprUri(t,r)}),this._videoSettings=this._settings.video,this._vpaidSettings=this._settings.vpaid,this},i.prototype._loadSettings=function(t){var s="linear"===this._break.type?"MediaFiles":"NonLinear",n=t.getElementsByTagName(s)[0];if(this._loadTrackings(t.getElementsByTagName("TrackingEvents")[0]),"linear"===this._break.type){this._registrar.appendUriByTagName(t,"ClickTracking",r.trackings.clickThrough);var a=t.getElementsByTagName("Duration")[0];a&&(d=e.StringUtils.parseTime(a.textContent.trim()))>0&&(this._vpaidSettings.duration=i._writeSetting(d,this._vpaidSettings.duration),this._videoSettings.duration=i._writeSetting(d,this._videoSettings.duration));var o=t.getElementsByTagName("ClickThrough")[0];if(o){var d=this._registrar.process(o.textContent.trim());this._videoSettings.redirectUrl=i._writeSetting(d,this._videoSettings.redirectUrl)}var c=t.getAttribute("skipoffset");if(c){var p=/^(\d+)\%$/.exec(c);d=p?Number(p[1])*this._videoSettings.duration/100:e.StringUtils.parseTime(c),this._vpaidSettings.skipTimeout=i._writeSetting(d,this._vpaidSettings.skipTimeout),this._videoSettings.skipTimeout=i._writeSetting(d,this._videoSettings.skipTimeout),this._vpaidSettings.closeTimeout=i._writeSetting(d,this._vpaidSettings.closeTimeout),this._videoSettings.closeTimeout=i._writeSetting(d,this._videoSettings.closeTimeout)}}else this._registrar.appendUriByTagName(n,"NonLinearClickTracking",r.trackings.clickThrough);return n},i.prototype._loadExtensions=function(e){var t=e.getElementsByTagName("Extensions")[0];if(t){var r=t.getElementsByTagName("Extension");if(0!==r.length)for(var i=0;i<r.length;i++)this._loadExtension(r[i])}},i.prototype._loadExtension=function(t){if(t.getAttribute("type"))try{this._loadSettingsExt(t),this._loadTrackingExt(t),this._manager.load(t)}catch(r){this._devstatTransmit(e.devstat.errXmlParse,r&&r.message||r,void 0,t)}},i.prototype._loadSettingsExt=function(t){var r=t.getAttribute("type"),s=t.textContent.trim();switch(r){case"label":this._extData.label=s;break;case"Urlmod":(c=t.getAttribute("final"))&&"true"===c.toLowerCase()&&this._handleEvent(e.events.pod.BreakPod);break;case"Allowblock":case"AllowBlock":"1"===s?this._disablePod=!1:this._handleEvent(e.events.pod.BreakPod);break;case"controls":var n=void 0;switch(s){case"0":n={redirect:"1"};break;case"1":n={close:"1",volume:"1",timer:"1",redirect:"1"};break;default:n={skip:"1",timer:"1",redirect:"1"};for(var a=t.getElementsByTagName("control"),o=0;o<a.length;o++){var d=a[o].attributes.id.value.toLowerCase(),c=a[o].attributes.layout.value.toLowerCase();switch(d){case"adlabel":n.label=c;break;case"soundbtn":n.volume=c;break;case"countdown":n.timer=c;break;default:n[d]=c}}}this._videoSettings.controls=i._writeSetting(n,this._videoSettings.controls),this._vpaidSettings.controls=i._writeSetting(n,this._vpaidSettings.controls);break;case"skipTime":c=e.StringUtils.parseTime(s),this._vpaidSettings.skipTimeout=i._writeSetting(c,this._vpaidSettings.skipTimeout),this._videoSettings.skipTimeout=i._writeSetting(c,this._videoSettings.skipTimeout),this._settings.sameSkipTime&&(this._vpaidSettings.closeTimeout=i._writeSetting(c,this._vpaidSettings.closeTimeout),this._videoSettings.closeTimeout=i._writeSetting(c,this._videoSettings.closeTimeout));break;case"skipTime2":c=e.StringUtils.parseTime(s),this._vpaidSettings.closeTimeout=i._writeSetting(c,this._vpaidSettings.closeTimeout),this._videoSettings.closeTimeout=i._writeSetting(c,this._videoSettings.closeTimeout),this._settings.sameSkipTime&&(this._vpaidSettings.skipTimeout=i._writeSetting(c,this._vpaidSettings.skipTimeout),this._videoSettings.skipTimeout=i._writeSetting(c,this._videoSettings.skipTimeout));break;case"linkTxt":c=decodeURIComponent(s),this._videoSettings.redirectText=i._writeSetting(c,this._videoSettings.redirectText);break;case"isClickable":"1"!==s&&(this._videoSettings.redirectUrl=i._writeSetting("",this._videoSettings.redirectUrl))}},i.prototype._dispose=function(r){var i,s=this;return this._disposed?e.spromise.rejected(e.base.errors.Disposed):(delete this._extData,delete this._settings,delete this._videoSettings,delete this._vpaidSettings,this._manager&&(i=this._manager.dispose(r),delete this._manager),i=(i||e.spromise.resolved()).anycase(function(){return t.prototype._dispose.call(s,r)}))},i}(r.AdTracker),r.AdExt=i}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=function(i){function s(){var t=null!==i&&i.apply(this,arguments)||this;return t._volume=e.vpaid.VolumeMax,t}return __extends(s,i),Object.defineProperty(s.prototype,"name",{get:function(){return"Ad"},enumerable:!0,configurable:!0}),s.prototype.initAd=function(){return this._source=this._init,this._parseHead(this._init),this._registrar.setEventTime(r.trackings._breakLoaded,this._break.timestamp),i.prototype.initAd.call(this,this._init)},s.prototype.__initAd=function(t){var r=this;this._dispatch(e.events.pod.ResetPod),this._parse(t).catch(function(t){return r._handleEvent(e.vpaid.events.AdError,t)})},s.prototype._parse=function(i){this._devstatInit(),this._loadExtensions(i),this._registrar.register(r.trackings.select),this._registrar.appendUriByTagName(i,"Impression",r.trackings.impression),this._registrar.appendUriByTagName(i,"Error",r.trackings.error);var s=i.getElementsByTagName("CompanionAds")[0],n=i.getElementsByTagName("InLine")[0],a=i.getElementsByTagName("Wrapper")[0];return s&&this._loadCompanionAds(s)||n&&this._loadInLine(n)||a&&this._loadWrapper(a)||e.spromise.rejected(t.errors.AdNoWay())},s.prototype._loadCompanionAds=function(r){switch((r?r.getAttribute("required"):"").toLowerCase()){case"all":case"any":return e.spromise.rejected(t.errors.AdCompanionsNotSupported())}},s.prototype._loadInLine=function(r){var i=this,s=r.getElementsByTagName("Creative")[0];if(s){var n="linear"===this._break.type?"Linear":"NonLinearAds",a=s.getElementsByTagName(n)[0];return a?this._manager.dmp(this.preprData).then(function(){return i._wbrmPrepr(e.XMLUtils.textByTag(a,"AdParameters"))}).then(function(t){return i._disposing?e.spromise.rejected(e.base.errors.Disposed):t}).then(function(e){return"linear"===i._break.type?i._loadLinear(a,e):i._loadNonLinear(a,e)}):e.spromise.rejected(t.errors.AdNoRequered(void 0,n))}},s.prototype._loadWrapper=function(t){var i=this;this.devstatSend(this,e.devstat.msgToRequest,e.devstat.strWrapper),this.devstatWrite(this,e.devstat.msgToVastLoad,e.devstat.strWrapper),this._registrar.appendUriByTagName(t,"ClickTracking",r.trackings.clickThrough),this._loadTrackings(t.getElementsByTagName("TrackingEvents")[0]);var s={allowPods:!0,contentData:this._contentData,breakAdPodDefault:this._disablePod,video:this._settings.video,vpaid:this._settings.vpaid,allowWrappers:this._settings.allowWrappers-1,sameSkipTime:this._settings.sameSkipTime,strictImpressionOrder:this._settings.strictImpressionOrder},n={url:this._registrar.process(e.XMLUtils.textByTag(t,"VASTAdTagURI")),credentials:this._credentials?"true":"false"};return this._buildWrapper(s,n).then(function(){return i._spawn()})},s.prototype._loadLinear=function(i,s){var n=this;this.devstatSend(this,e.devstat.msgToRequest,e.devstat.evtRequest),this.devstatWrite(this,e.devstat.msgToVastLoad,e.devstat.evtRequest),this._registrar.register(r.trackings.request);var a=this._loadSettings(i),o=e.vast.parseInteractiveFiles(a,["MediaFile","InteractiveCreativeFile","InteractiveMediaFile"],["VPAID"]),d=e.vast.parseVideoFiles(a,["MediaFile"],[/^(image|video)\//i]);return this._buildVast(o,s).catch(function(){return n._buildVpaid(o,s)}).catch(function(){return n._buildVideo(d,s)}).catch(function(){return n._dispatch(e.events.VastLoad).then(function(){return e.spromise.rejected(t.errors.AdLinearNoSupported())})}).then(function(){return n._spawn()})},s.prototype._loadNonLinear=function(i,s){var n,a=this;this.devstatSend(this,e.devstat.msgToRequest,e.devstat.evtRequest),this.devstatWrite(this,e.devstat.msgToVastLoad,e.devstat.evtRequest),this._registrar.register(r.trackings.request);var o=this._loadSettings(i);o||(n=e.spromise.rejected("NonLinear element not found"));var d=o.getElementsByTagName("StaticResource")[0];d&&d.textContent||(n=e.spromise.rejected("No static resource"));var c=d.textContent.trim(),p=d.getAttribute("creativeType"),u=o.getAttribute("apiFramework"),l=e.XMLUtils.textByTag(o,"NonLinearClickThrough"),h=Number(o.getAttribute("width")),v=Number(o.getAttribute("height")),f=u?[{api:u,path:c,type:p}]:[],m=/^image\/(gif|jpeg|png)$/i.test(p)?[{image:c,width:h,height:v,link:this._registrar.process(l)}]:[];return n=n||this._buildVast(f,s).catch(function(){return a._buildBanner(m,s)}).catch(function(){return a._dispatch(e.events.VastLoad).then(function(){return e.spromise.rejected(t.errors.AdNonLinearNoSupported())})}).then(function(){return a._spawn()})},s.prototype._buildWrapper=function(i,s){return this._settings.allowWrappers?this._build((new r.factory.Builder).setClass(r.Vast).setFactory(this._factory).setSettings(i).setAdParams(s)):e.spromise.rejected(t.errors.WrapperLimit())},s.prototype._buildVast=function(i,s){return i.length<=0?e.spromise.rejected(t.errors.AdNoSupportedFiles()):this._build((new r.factory.Builder).setFactory(this._factory).setSettings(this._settings).setFiles(i).setAdParams(s))},s.prototype._buildVpaid=function(i,s){var n=this;return e.filter(i,function(e){return-1!==n._interactiveTypes.indexOf(e.type)}).length<=0?e.spromise.rejected(t.errors.AdLinearNoSupported()):(this._settings.vpaid.creativeData={AdParameters:s},this._build((new r.factory.Builder).setClass(r.player.Vpaid).setFiles(i).setSettings({vpaid:this._settings.vpaid})))},s.prototype._buildVideo=function(i,s){return i.length<=0?e.spromise.rejected(t.errors.AdLinearNoSupported()):this._build((new r.factory.Builder).setClass(r.player.Video).setFiles(i).setSettings({video:this._settings.video}))},s.prototype._buildBanner=function(i,s){return i.length<=0?e.spromise.rejected(t.errors.AdNonLinearNoSupported()):this._build((new r.factory.Builder).setClass(r.player.Banner).setFiles(i))},s.prototype._build=function(i){var s=e.spromise.deffer();try{this._builder=i,this._child=i.setParent(this).setTargetParent(this).setInteractiveTypes(this._interactiveTypes).setSizeRec(this._sizeRec).setBreak(this._break).build(),this._devstatWriteStarted(this,e.devstat.strChild+e.devstat.strSelector+r.AManageNodeDevstat.DevstatName(this._child)),s.resolve()}catch(e){s.reject(t.errors.AdNoSupportedFiles(e))}return s.promise},s.prototype._spawn=function(){return this._subscribeEvents(),this._child.initAd()},s.prototype._parseHead=function(t){var r;if(this._adSystem=void 0,(r=t.getElementsByTagName("AdSystem")).length>0&&r[0].textContent&&(this._adSystem=r[0].textContent.trim()),this._adTitle=void 0,this._advertId=void 0,(r=t.getElementsByTagName("AdTitle")).length>0&&r[0].textContent&&(this._adTitle=r[0].textContent.trim(),/\d+/.test(this._adTitle)&&(this._advertId=parseInt(this._adTitle))),this._isPrimary=!1,this._isInternal=void 0,this._campaignId=void 0,"advark"===this._adSystem&&this._advertId){this._adId=t.getAttribute("id");var i=/^(advark_)?(internal|\d+)(_[0-9,a-f,-]{36}|_[0-9,a-f]{32})?$/i.exec(this._adId);i&&4===i.length&&i[2]&&(this._isPrimary=!0,this._isInternal="internal"===i[2],this._campaignId=!this._isInternal&&parseInt(i[2])),this._isPrimary||this._devstatTransmit(e.devstat.errVastHead,"AdSystem advark without campaignId",void 0,t)}},s.prototype._handleEventEnd=function(t){for(var s,n,a=this,o=[],d=1;d<arguments.length;d++)o[d-1]=arguments[d];if(this._disposing)return e.spromise.rejected(e.base.errors.Disposing);switch(t){case e.events.Progress:(c=o[0]).time<this._progress.time-.5&&this._registrar.register(r.trackings.rewind),this._progress=c,this._registrar.registerProgress(c.time,c.duration);break;case e.vpaid.events.AdVolumeChange:this._volume===o[0].volume?s=e.spromise.rejected(e.base.errors.AlreadyDone):(0===o[0].volume&&this._registrar.register(r.trackings.mute),0===this._volume&&this._registrar.register(r.trackings.unmute),this._volume=o[0].volume);break;case e.vpaid.events.AdSizeChange:var c=o[0];"fullscreen"!==this._sizeRec.viewMode&&"fullscreen"===c.viewMode&&this._registrar.register(r.trackings.playerExpand),"fullscreen"===this._sizeRec.viewMode&&"fullscreen"!==c.viewMode&&this._registrar.register(r.trackings.playerCollapse),this._sizeRec.width*this._sizeRec.width<c.width*c.height&&this._registrar.register(r.trackings.expand),this._sizeRec.height*this._sizeRec.height>c.width*c.height&&this._registrar.register(r.trackings.collapse),this.setSizeRec(c);break;case e.vpaid.events.AdStarted:this._manager.handleEvent(t),this._settings.strictImpressionOrder&&this._registrar.register(r.trackings.impression),this._registrar.register(r.trackings.creativeView),this._registrar.register(r.trackings.start),o[0]=o[0]||this._assetUri&&{assetUri:this._assetUri},this._assetUri=o[0]?o[0].assetUri:this._assetUri}switch(s=s||(n=i.prototype._handleEventEnd).apply.call(n,this,[t].concat(o)),t){case e.vpaid.events.AdImpression:this._settings.impressionAsVideoStart&&(s=s.then(function(){return a._handleEvent(e.vpaid.events.AdVideoStart)}))}return s},s}(r.AdExt),r.Ad=i}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.adext||(r.adext={}),s=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),Object.defineProperty(r.prototype,"name",{get:function(){return"Extensions"},enumerable:!0,configurable:!0}),r.prototype.build=function(){return t.prototype.build.call(this),this._extensions={LazyConstraint:(new i.lazy.Extension).setParent(this),FrameChecker:(new i.FrameChecker).setParent(this).setContentData(this._contentData).build(),ImpressionStat:(new i.StatCollector).setParent(this).setExtName("impressionstat").setLocalName("advark.userstataddons").build(),ImpressionGroupStat:(new i.StatCollector).setParent(this).setExtName("impressiongroupstat").setLocalName("advark.groupuserstataddons").build()},this},r.prototype._dispose=function(r){var i=this;if(this._disposed)return e.spromise.rejected(e.base.errors.Disposed);var s=e.spromise.resolved(),n=function(e){var t=a._extensions[e];t&&t.dispose&&(s=s.anycase(function(){return t.dispose(r)}).anycase(function(){delete i._extensions[e]}))},a=this;for(var o in this._extensions)n(o);return s=s.anycase(function(){return t.prototype._dispose.call(i,r)})},r.prototype._dmp=function(e){var t=[];for(var r in this._extensions){var i=this._extensions[r];i.loaded&&i.dmp&&t.push(i.dmp(e))}return t},r.prototype.dmp=function(t){return e.context.secretKeys.iframe_skipDmpChecks?e.spromise.resolved():e.spromise.all(this._dmp(t))},r.prototype.load=function(e){for(var t in this._extensions){var r=this._extensions[t];!r.loaded&&r.load&&r.load(e)}},r.prototype.handleEvent=function(e){for(var t in this._extensions){var r=this._extensions[t];r.loaded&&r.handleEvent&&r.handleEvent(e)}},r.prototype.preprUri=function(e,t){for(var r in this._extensions){var i=this._extensions[r];i.loaded&&i.preprUri&&(t=i.preprUri(e,t))}return t},r.prototype.getExtension=function(e){if(this._extensions[e])return this._extensions[e]},r}(t.AContentDataOwner),i.Manager=s}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.adext||(r.adext={}),s=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e._psds=[],e}return __extends(r,t),Object.defineProperty(r.prototype,"loaded",{get:function(){return this._psds.length>0},enumerable:!0,configurable:!0}),r.prototype.setExtName=function(e){return this._extName=e,this},r.prototype.setLocalName=function(e){return this._localName=e,this},r.prototype.load=function(e){e.getAttribute("type")===this._extName&&this._psds.push(e.textContent.trim())},r.prototype.handleEvent=function(t){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];switch(t){case e.vpaid.events.AdStarted:if(e.lstorage.enabled&&this._psds.length>0){var s=e.lstorage.read(this._localName,"");s=s?s+","+this._psds.join(","):this._psds.join(","),e.lstorage.write(this._localName,s)}}},r}(e.base.factory.ABuildableItem),i.StatCollector=s}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.adext||(r.adext={}),s=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),Object.defineProperty(r.prototype,"loaded",{get:function(){return!0},enumerable:!0,configurable:!0}),r.prototype.preprUri=function(t,r){var i=new e.parser.Uri(r),s=i.params.get("ep");if(s&&"boolean"==typeof this._contentData.isFrame){var n=",ifr,"+(this._contentData.isFrame?"1":"0");i.params.set("ep",(s||"")+n),r=i.toString()}return r},r}(t.AContentDataOwner),i.FrameChecker=s}(advark||(advark={})),function(e){var t;(t=e.lazy||(e.lazy={})).errNoNewOrder="Cannot switch to new order",t.errCantCalcLogic="Cannot calc items logic now",t.reasonLogicCalculated="Logic calculated",t.reasonNoNewWave="No new wave"}(advark||(advark={})),function(e){var t,r;t=e.lazy||(e.lazy={}),r=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e._price=0,e._isStarted=!1,e._isFinished=!1,e._isPassed=!1,e}return __extends(r,t),Object.defineProperty(r.prototype,"name",{get:function(){return"Item"},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"operand",{get:function(){return this._operand},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"order",{get:function(){return this._order},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"price",{get:function(){return this._price},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isStarted",{get:function(){return this._isStarted},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isFinished",{get:function(){return this._isFinished},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isPassed",{get:function(){return this._isPassed},enumerable:!0,configurable:!0}),r.prototype.setOperand=function(e){return this._operand=e,this},r.prototype.setOrder=function(e){return this._order=e,this},r.prototype.setPrice=function(e){return this._price=e,this},r.prototype.run=function(){var t=this;return this._isStarted?this._promise:(this._isStarted=!0,this._promise=this._run().then(function(r){return t._isFinished=!0,t._isPassed=!0,e.spromise.resolved(r)},function(r){return t._isFinished=!0,t._isPassed=!1,e.spromise.rejected(r)}),this._promise)},r}(e.base.factory.ABuildableItem),t.ALazyItem=r}(advark||(advark={})),function(e){var t,r;t=e.lazy||(e.lazy={}),r=function(r){function i(){var e=null!==r&&r.apply(this,arguments)||this;return e._items=[],e}return __extends(i,r),Object.defineProperty(i.prototype,"price",{get:function(){var e=0;if(this._items.length>0)for(var t=0,r=this._items;t<r.length;t++){e+=r[t].price}return e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return"Wave"},enumerable:!0,configurable:!0}),i.prototype.pushItem=function(e){return this._items.push(e),this},i.prototype.getItem=function(e){return this._items[e]},i.prototype.getResolvers=function(){return this._calcResolvers()},Object.defineProperty(i.prototype,"length",{get:function(){return this._items?this._items.length:0},enumerable:!0,configurable:!0}),i.prototype.setPreviousPassed=function(e){return this._previousPassed=e,this},i.prototype._run=function(){var t=e.spromise.deffer(),r=t.promise;if(!this._checkIsDone(t))for(var i=0,s=this._items;i<s.length;i++){var n=s[i];this._runItem(t,n)}return r},i.prototype._runItem=function(e,t){var r=this;t.run().anycase(function(){return r._checkIsDone(e)})},i.prototype._checkIsDone=function(e){if(!this._isFinished){var r=this._clacItemsLogic();return void 0!==r&&(r?e.resolve(t.reasonLogicCalculated):e.reject(t.reasonLogicCalculated),!0)}},i.prototype._clacItemsLogic=function(){var e,t;if(this._items.length>0)for(var r=0,i=this._items;r<i.length;r++){var s=i[r];if(void 0===e&&void 0===this._previousPassed)e=s.isPassed,t=s.isFinished;else try{e=this._calcCurrentLogic(s,void 0===e||t,void 0!==e?e:this._previousPassed),t=!0}catch(r){e=!1,t=!1}}else e=void 0===this._previousPassed||this._previousPassed,t=!0;return t?e:void 0},i.prototype._calcCurrentLogic=function(e,r,i){switch(e.operand){case"and":if(r&&!i)return!1;if(e.isFinished&&!e.isPassed)return!1;if(e.isFinished&&r&&e.isPassed&&i)return!0;throw new Error(t.errCantCalcLogic);case"or":if(r&&i)return!0;if(e.isFinished&&e.isPassed)return!0;if(e.isFinished&&r&&!e.isPassed&&!i)return!1;throw new Error(t.errCantCalcLogic)}},i.prototype._calcResolvers=function(){var e=this,t=[];try{var r=function(){return e._items&&0===e._items.length||t.length>0||!0===e._previousPassed},i=function(){for(var r=e._previousPrice?e._previousPrice:0,i=0,s=t;i<s.length;i++){var n=s[i];r+=n.price?n.price:null}return r};if(this._isFinished&&this._isPassed&&this._items.length>0)for(var s=0,n=this._items;s<n.length;s++){var a=n[s];switch(a.operand){case"or":a.isPassed?(!r()||i()>a.price)&&(t=[a]):r||(t=[]);break;case"and":a.isPassed?t.push(a):t=[]}}}catch(e){throw e}return t},i}(t.ALazyItem),t.LazyWave=r}(advark||(advark={})),function(e){var t,r;t=e.lazy||(e.lazy={}),r=function(r){function i(){return null!==r&&r.apply(this,arguments)||this}return __extends(i,r),Object.defineProperty(i.prototype,"name",{get:function(){return"Group"},enumerable:!0,configurable:!0}),i.prototype._clacOrder=function(e){var t;if(void 0===e&&(e=void 0),void 0===e)for(var r=0,i=this._items;r<i.length;r++){var s=i[r];t=void 0!==t?Math.min(t,s.order):s.order}else{for(var n=0,a=this._items;n<a.length;n++){(s=a[n]).order>e&&(t=void 0!==t?Math.min(t,s.order):s.order)}e===t&&(t=void 0)}return t},i.prototype._run=function(){var t=e.spromise.deffer(),r=t.promise;return this._runNextWawe(t),r},i.prototype._buildNewWave=function(e){var r;void 0===e&&(e=void 0);var i=this._clacOrder(e);if(void 0===i);else{r=(new t.LazyWave).setParent(this).setPreviousPassed(this._lastWavePassed).setOrder(i);for(var s=0,n=this._items;s<n.length;s++){var a=n[s];a.order===r.order&&r.pushItem(a)}}return r},i.prototype._runNextWawe=function(e,r){var i=this;void 0===r&&(r=void 0);var s=this._buildNewWave(r);s?s.run().then(function(){i._lastWavePassed=!0,i._runNextWawe(e,s.order)},function(){i._lastWavePassed=!1,i._runNextWawe(e,s.order)}):void 0===this._lastWavePassed||this._lastWavePassed?e.resolve(t.reasonNoNewWave):e.reject(t.reasonNoNewWave)},i}(t.LazyWave),t.LazyGroup=r}(advark||(advark={})),function(e){var t,r;t=e.devstat||(e.devstat={}),(r=t.lazy||(t.lazy={})).getOperand=function(e){switch(e){case"and":return t.strAnd;case"or":return t.strOr;default:return e}},r.strCache="?",r.strRequest=">",r.errNetwork="#",r.errParse="_",r.provAdFox="a",r.provDca="d",r.provAiData="i",r.provUnknown="u",r.strSequence="s",r.strConstraint="c",r.strExtension="n"}(advark||(advark={})),function(e){var t,r,i,s,n;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.adext||(r.adext={}),s=i.lazy||(i.lazy={}),n=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e._cached=!1,e}return __extends(r,t),r.DevstatName=function(t){switch(t){case"adfox":return e.devstat.lazy.provAdFox;case"aidata":return e.devstat.lazy.provAiData;case"dca":return e.devstat.lazy.provDca}return e.devstat.lazy.provUnknown},Object.defineProperty(r.prototype,"name",{get:function(){return this._type?this._type:"Provider"},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"providerName",{get:function(){return this._providerName},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"checkParam",{get:function(){return this._checkParam},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"cached",{get:function(){return this._cached},enumerable:!0,configurable:!0}),r.prototype.setType=function(e){return this._type=e,this},r.prototype.setProviderName=function(e){return this._providerName=e,this},r.prototype.setSrc=function(e){return this._src=e,this},r.prototype.setReplacements=function(e){return this._preprData=e,this},r.prototype.setPrice=function(e){return this._price=e,this},r.prototype.setCheckParam=function(e){return this._checkParam=e,this},r}(e.lazy.ALazyItem),s.AProvider=n}(advark||(advark={})),function(e){var t,r,i,s,n;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.adext||(r.adext={}),s=i.lazy||(i.lazy={}),n=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),Object.defineProperty(r.prototype,"name",{get:function(){return"Seq"+this.order+this.operand},enumerable:!0,configurable:!0}),r.prototype._run=function(){var r=this,i=e.devstat.lazy.strSequence;this instanceof s.Constraint&&(i=e.devstat.lazy.strConstraint+s.AProvider.DevstatName(this.provider.type));var n=e.devstat.lazy.getOperand(this._operand)+i;return this.devstatWrite(this,e.devstat.msgToRequest,n+e.devstat.lazy.strRequest),t.prototype._run.call(this).inspect(function(t,i){return r.devstatWrite(r,e.devstat.msgToRequest,n+(i?e.devstat.strResolve:e.devstat.strReject))})},r}(e.lazy.LazyGroup),s.Sequence=n}(advark||(advark={})),function(e){var t,r,i,s,n;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.adext||(r.adext={}),s=i.lazy||(i.lazy={}),n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"Con"+this.order+this.operand},enumerable:!0,configurable:!0}),t.prototype.setProvider=function(e){return this._provider=e,this.length>0&&(this._items=[]),e.setOrder(0),this.pushItem(e),this},Object.defineProperty(t.prototype,"provider",{get:function(){return this._provider},enumerable:!0,configurable:!0}),t}(s.Sequence),s.Constraint=n}(advark||(advark={})),function(e){var t,r,i,s,n;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.adext||(r.adext={}),s=i.lazy||(i.lazy={}),n=function(r){function i(){var e=null!==r&&r.apply(this,arguments)||this;return e._providers=[],e._sequences=[],e}return __extends(i,r),Object.defineProperty(i.prototype,"name",{get:function(){return"Lazy"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"loaded",{get:function(){return this._providers.length>0||this._sequences.length>0},enumerable:!0,configurable:!0}),i.prototype.load=function(e){var t=this;if("LazyConstraint"===e.getAttribute("type")){var r=function(e,t,r){for(var i=e.getElementsByTagName(t),s=0;s<i.length;s++)r(i[s])};r(e,"Provider",function(e){for(var r={name:e.getAttribute("name").trim(),src:e.getAttribute("src").trim(),type:e.getAttribute("type").trim()},i=0,s=["price","params"];i<s.length;i++){var n=s[i],a=e.getAttribute(n);r[n]=a?a.trim():void 0}var o=e.getElementsByTagName("socdem");if(o.length>0){for(var d=o[0],c={},p=0,u=["age","gender","revenue"];p<u.length;p++)n=u[p],a=d.getAttribute(n),c[n]=a?a.trim():void 0;r.socdem=c}t._providers.push(r)}),r(e,"Sequence",function(e){var i={order:Number(e.getAttribute("order").trim()),operand:e.getAttribute("operand").trim(),constraints:[]};r(e,"Constraint",function(e){var r={order:Number(e.getAttribute("order").trim()),operand:e.getAttribute("operand").trim(),provider:t._getProviderByName(e.getAttribute("provider").trim())};i.constraints.push(r)}),t._sequences.push(i)})}},i.prototype.dmp=function(r){var i=this;return this._devstatWriteConfig(),this._group=this._buildGroup(r),this._group.run().then(function(t){return i.devstatWrite(i,e.devstat.msgToRequest,e.devstat.lazy.strExtension+e.devstat.strResolve),e.spromise.resolved(t)}).catch(function(t){return i.devstatWrite(i,e.devstat.msgToRequest,e.devstat.lazy.strExtension+e.devstat.strReject),e.spromise.rejected(t)}).catch(function(r){return e.spromise.rejected(t.errors.DmpReject())})},i.prototype.preprUri=function(t,r){var i=new e.parser.Uri(r),s=i.params.get("ep");if(this._group&&s){var n={};if(this._uriParamsCache)n=this._uriParamsCache;else{n.dmp=",~dmp";for(var a=0;a<this._group.length;a++)for(var o=this._group.getItem(a),d=0;d<o.length;d++){var c=o.getItem(d).provider;n.dmp+=","+c.type+"-"+c.providerName+","+(c.checkParam?encodeURIComponent(c.checkParam):"")}n.dmp+=",~",n.dmp_sell=",~dmp_sel";for(var p=0,u=this._getResolvers(this._group);p<u.length;p++)c=u[p],n.dmp_sell+=","+c.type+"-"+c.providerName;n.dmp_sell+=",~",this._uriParamsCache=n}i.params.set("ep",s+n.dmp+n.dmp_sell),r=i.toString()}return r},i.prototype._devstatWriteConfig=function(){for(var t="",r=!1,i=0,n=this._sequences;i<n.length;i++){var a=n[i];t+=(r?e.devstat.strComma:"")+e.devstat.lazy.getOperand(a.operand)+e.devstat.strChildOn,r=!0;for(var o=0,d=a.constraints;o<d.length;o++){var c=d[o];t+=""+e.devstat.lazy.getOperand(c.operand)+s.AProvider.DevstatName(c.provider.type)}t+=e.devstat.strChildOff}t+=e.devstat.lazy.strExtension+e.devstat.lazy.strRequest,this.devstatWrite(this,e.devstat.msgToRequest,t)},i.prototype._getProviderByName=function(e){for(var t=0,r=this._providers;t<r.length;t++){var i=r[t];if(i.name===e)return i}throw new Error("Trying to get unexisted provider: "+e)},i.prototype._buildGroup=function(t){for(var r=(new e.lazy.LazyGroup).setParent(this),i=0,n=this._sequences;i<n.length;i++){for(var a=n[i],o=(new s.Sequence).setParent(r),d=0,c=a.constraints;d<c.length;d++){var p=c[d],u=(new s.Constraint).setParent(o);o.pushItem(u.setOrder(p.order).setOperand(p.operand).setProvider((new s.ProviderBuilder).setParent(u).setProviderName(p.provider.name).setType(p.provider.type).setSrc(p.provider.src).setSocdem(p.provider.socdem).setPrice(p.provider.price).setCheckParam(p.provider.params).setPreprData(t).setTargetParent(this).build()))}r.pushItem(o.setOrder(a.order).setOperand(a.operand))}return r},i.prototype._getResolvers=function(t){var r=[],i=t.getResolvers();if(i&&i.length>0)for(var n=0,a=i;n<a.length;n++){var o=a[n];o instanceof s.Constraint?o.provider.cached||r.push(o.provider):o instanceof e.lazy.LazyWave&&(r=r.concat(this._getResolvers(o)))}return r},i}(e.base.ADebugableObject),s.Extension=n}(advark||(advark={})),function(e){var t,r,i,s,n;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.adext||(r.adext={}),s=i.lazy||(i.lazy={}),n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setSocdem=function(e){return this.setItem("socdem",e)},t.prototype.getSocdem=function(){return this.getItem("socdem")},t.prototype.setType=function(e){return this.setItem("type",e)},t.prototype.getType=function(){return this.getItem("type")},t.prototype.setSrc=function(e){return this.setItem("src",e)},t.prototype.getSrc=function(){return this.getItem("src")},t.prototype.setProviderName=function(e){return this.setItem("providerName",e)},t.prototype.getProviderName=function(){return this.getItem("providerName")},t.prototype.setPreprData=function(e){return this.setItem("preprData",e)},t.prototype.getPreprData=function(){return this.getItem("preprData")},t.prototype.setPrice=function(e){return this.setItem("price",e)},t.prototype.getPrice=function(){return this.getItem("price")},t.prototype.setCheckParam=function(e){return this.setItem("checkParam",e)},t.prototype.getCheckParam=function(){return this.getItem("checkParam")},t.prototype._checkCache=function(){return this._providerName&&t._providers[this._providerName]?t._providers[this._providerName]:e.prototype._checkCache.call(this)},t.prototype._construct=function(){if(this._type)switch(this._type){case"adfox":this.setClass(s.ProviderAdFox);break;case"aidata":this.setClass(s.ProviderAiData);break;case"dca":this.setClass(s.ProviderDca);break;default:throw new Error("Unknown type: "+this._type)}if(this._class)switch(this._class){case s.ProviderAdFox:return new s.ProviderAdFox;case s.ProviderAiData:return new s.ProviderAiData;case s.ProviderDca:return new s.ProviderDca;default:throw new Error("Unknown class: "+this._class)}throw new Error("Unknown build method")},t.prototype._beforeBuild=function(e){this._providerName&&(t._providers[this._providerName]=e),e instanceof s.ProviderAdFox&&(this._socdem&&e.setSocdem(this._socdem),this._checkParam&&e.setCheckParam(this._checkParam)),this._type&&e.setType(this._type),this._price&&e.setPrice(this._price),this._type&&e.setType(this._type),this._providerName&&e.setProviderName(this._providerName),this._src&&e.setSrc(this._src),this._preprData&&e.setReplacements(this._preprData)},t._providers={},t}(e.base.factory.ABuilder),s.ProviderBuilder=n}(advark||(advark={})),function(e){var t,r,i,s,n;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.adext||(r.adext={}),s=i.lazy||(i.lazy={}),n=function(i){function n(){var e=null!==i&&i.apply(this,arguments)||this;return e._socdem={age:2147483647,gender:2147483647,revenue:2147483647},e}return __extends(n,i),n.prototype.setSocdem=function(e){for(var t in e)e[t]&&(this._socdem[t]=Number(e[t]));return this},n.prototype._run=function(){var i,n,a,o=this,d=e.spromise.deffer(),c=!1,p=!1,u=!1,l=!1,h=!1,v=!1;if(e.lstorage.enabled){this.devstatWrite(this,e.devstat.msgToRequest,s.AProvider.DevstatName(this._type)+e.devstat.lazy.strCache);var f=Number(e.lstorage.read(t.frame.lstorage.adfoxExpire))<(new Date).getTime();i=e.lstorage.read(t.frame.lstorage.adfoxGender),n=e.lstorage.read(t.frame.lstorage.adfoxAge),a=e.lstorage.read(t.frame.lstorage.adfoxRevenue),i=i&&!f?i:2147483647,n=n&&!f?n:2147483647,a=a&&!f?a:2147483647,l=0==(i&this._socdem.gender),h=0==(n&this._socdem.age),v=0==(a&this._socdem.revenue),c=(i|this._socdem.gender)==this._socdem.gender,p=(n|this._socdem.age)==this._socdem.age,u=(a|this._socdem.revenue)==this._socdem.revenue}if(l||h||v)this._cached=!0,d.reject(t.errors.DmpReject("AdFox none of bit masks matches"));else if(c&&p&&u)this._cached=!0,d.resolve("AdFox bit masks matched");else{var m=r.prepr.process(this._src,this._preprData);this.devstatWrite(this,e.devstat.msgToRequest,s.AProvider.DevstatName(this._type)+e.devstat.lazy.strRequest),(new t.frame.Request).setUri(m).setCredentials(!0).send().then(function(e){return o._handleRespone(d,e,m,i,n,a)}).catch(function(e){return d.reject(t.errors.DmpRequest("AdFox request error"))})}var g=d.promise;return g=g.then(function(t){return o.devstatWrite(o,e.devstat.msgToRequest,s.AProvider.DevstatName(o._type)+e.devstat.strResolve),e.spromise.resolved(t)}).catch(function(r){return o.devstatWrite(o,e.devstat.msgToRequest,s.AProvider.DevstatName(o._type)+function(r){switch(t.AdError.Build(r).code){case e.vast.errors.DmpReject:return e.devstat.strReject;case e.vast.errors.DmpBadRequest:return e.devstat.lazy.errNetwork;case e.vast.errors.DmpParseRespError:return e.devstat.lazy.errParse;default:return e.devstat.strUnk}}(r)),e.spromise.rejected(r)})},n.prototype._handleRespone=function(r,i,s,n,a,o){if(this._disposing)throw new Error("AdFox disposed when handle request");var d=!1;try{var c=e.XMLUtils.parseXML(i.text).getElementsByTagName("MediaFile");c&&c.length>0&&(d=-1!=c[0].textContent.indexOf("advarkads")),d?(e.lstorage.write(t.frame.lstorage.adfoxExpire,((new Date).getTime()+864e5).toString()),e.lstorage.write(t.frame.lstorage.adfoxGender,(n&this._socdem.gender).toString()),e.lstorage.write(t.frame.lstorage.adfoxAge,(a&this._socdem.age).toString()),e.lstorage.write(t.frame.lstorage.adfoxRevenue,(o&this._socdem.revenue).toString())):r.reject(t.errors.DmpReject("AdFox respone isn't matches"))}catch(e){r.reject(t.errors.DmpParse("AdFox respone parsing error"))}r.resolve("AdFox handle respone success")},n}(s.AProvider),s.ProviderAdFox=n}(advark||(advark={})),function(e){var t,r,i,s,n;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.adext||(r.adext={}),s=i.lazy||(i.lazy={}),n=function(i){function n(){var e=null!==i&&i.apply(this,arguments)||this;return e._re=/1/i,e}return __extends(n,i),n.prototype._run=function(){var i=this,n=e.spromise.deffer(),a=r.prepr.process(this._src,this._preprData);this.devstatWrite(this,e.devstat.msgToRequest,s.AProvider.DevstatName(this._type)+e.devstat.lazy.strRequest),(new t.frame.Request).setUri(a).setCredentials(!0).setHeaders({Accept:"application/json"}).send().then(function(e){return i._handleRespone(n,e,a)}).catch(function(e){return n.reject(t.errors.DmpRequest("LazyConstraint request error"))});var o=n.promise;return o=o.then(function(t){return i.devstatWrite(i,e.devstat.msgToRequest,s.AProvider.DevstatName(i._type)+e.devstat.strResolve),e.spromise.resolved(t)}).catch(function(r){return i.devstatWrite(i,e.devstat.msgToRequest,s.AProvider.DevstatName(i._type)+function(r){switch(t.AdError.Build(r).code){case e.vast.errors.DmpReject:return e.devstat.strReject;case e.vast.errors.DmpBadRequest:return e.devstat.lazy.errNetwork;case e.vast.errors.DmpParseRespError:return e.devstat.lazy.errParse;default:return e.devstat.strUnk}}(r)),e.spromise.rejected(r)})},n.prototype._handleRespone=function(e,r,i){if(this._disposing)throw new Error("LazyConstraint disposed when handle request");try{var s=JSON.parse(r.text);if(void 0===s.ok)throw new Error("LazyConstraint respone unsoppurted format");var n=s.ok;this._checkParam=s.result,String(n).match(this._re)||e.reject(t.errors.DmpReject("LazyConstraint respone isn't matches"))}catch(r){e.reject(t.errors.DmpParse("LazyConstraint respone parsing error"))}e.resolve("LazyConstraint respone handled")},n}(s.AProvider),s.ProviderDca=n}(advark||(advark={})),function(e){var t,r,i,s,n;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.adext||(r.adext={}),s=i.lazy||(i.lazy={}),n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(s.ProviderDca),s.ProviderAiData=n}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=function(i){function s(){var e=null!==i&&i.apply(this,arguments)||this;return e._used=!1,e}return __extends(s,i),Object.defineProperty(s.prototype,"break",{get:function(){return this._break||this._load(),this._break},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"timeOffset",{get:function(){return this._timeOffset},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"breakType",{get:function(){return this._breakType},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"breakId",{get:function(){return this._breakId},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"repeatAfter",{get:function(){return this._repeatAfter},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"used",{get:function(){return this._used},set:function(e){this._used=e},enumerable:!0,configurable:!0}),s.prototype.setSource=function(e){return this._source=e,this},s.prototype.setVmapNs=function(e){return this._vmapNs=e,this},s.prototype.build=function(){return i.prototype.build.call(this),this._registrar.setEventTime(r.trackings._vmapLoaded),this._parseSource(),this},s.prototype._parseSource=function(){var t=this,i=this._source.attributes;this._breakType=i.breakType.value,this._repeatAfter=i.repeatAfter?i.repeatAfter.value.split(","):[],this._timeOffset=i.timeOffset.value,this._breakId=i.breakId?i.breakId.value:void 0,this._sequence=i.sequence?i.sequence.value:0;var s=this._source.getElementsByTagName("VAST");s.length>0?this._vast=s[0]:(s=this._source.getElementsByTagNameNS(this._vmapNs,"AdTagURI")).length>0&&s[0].textContent&&(this._vastUrl=r.prepr.process(s[0].textContent.trim(),r.prepr.def(this._contentData)));var n=this._source.getElementsByTagNameNS(this._vmapNs,"Extensions");n.length>0&&(n=n[0].getElementsByTagNameNS(this._vmapNs,"Extension"),e.each(n,function(e){try{switch(e.getAttribute("type")){case"request":t._registrar.appendUri(r.trackings._breakRequested,e.textContent);break;case"requestComplete":t._registrar.appendUri(r.trackings._breakLoaded,e.textContent)}}catch(e){}}))},s.prototype._load=function(){var i,s=this;return this._break={type:this._breakType,id:this._breakId,offset:this.timeOffset,sequence:Number(this._sequence),timestamp:void 0},this._registrar.register(r.trackings._breakRequested),this._vast?(this._setVast(this._vast),i=e.spromise.resolved()):i=(new t.frame.Request).setUri(this._vastUrl).setCredentials(!0).setLocal(!0).send().inspect(function(e,t){return t?s._parseResp(e).then(function(e){return s._setVast(e)},function(e){return s._setError(void 0,e)}):s._setError(e)}),this._break.promise=i,this._break.promise},s.prototype._parseResp=function(r){var i=e.XMLUtils.parseXML(r.text);return i?e.spromise.resolved(i):e.spromise.rejected(t.errors.VastNoLoad())},s.prototype._setVast=function(e){this._registrar.register(r.trackings._breakLoaded,{status:200,campaigns:this._campaigns(e)}),this._break.vast=e,this._break.timestamp=this._registrar.getEventTime(r.trackings._breakLoaded)},s.prototype._setError=function(e,i){void 0===e&&(e=void 0),void 0===i&&(i=void 0),this._registrar.register(r.trackings._breakLoaded,{status:e&&e.code||600,campaigns:""}),this._break.error=i||t.errors.VastNoLoad(e?e.error:void 0),this._break.timestamp=this._registrar.getEventTime(r.trackings._breakLoaded)},s.prototype._campaigns=function(e){for(var t="",r=e.getElementsByTagName("Extension"),i=0;i<r.length;i++)switch(r[i].getAttribute("type")){case"name":var s=r[i].textContent;t+=s?s.trim()+",":""}return t},s}(r.ARegistrarOwner),r.BreakLoader=i}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=function(i){function s(){return null!==i&&i.apply(this,arguments)||this}return __extends(s,i),Object.defineProperty(s.prototype,"queue",{get:function(){return this._queue},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"break",{get:function(){return this._queue.breaks[this._idx]},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"startTime",{get:function(){return this._startTime},enumerable:!0,configurable:!0}),s.prototype.setQueue=function(e){return this._queue=e,this},s.prototype.setAutoStart=function(e){return this._autoStart=e,this},Object.defineProperty(s.prototype,"name",{get:function(){return this.queue?"linear"===this.queue.breakType?"Linear":"NonLinear":"Sequence"},enumerable:!0,configurable:!0}),s.prototype.initAd=function(){var r=this;return this._disposing?e.spromise.rejected(e.base.errors.Disposing):this._states.loading||this._states.loaded?e.spromise.rejected(e.base.errors.AlreadyDone):(this._states.loading=!0,this._reduceEvents([e.vpaid.events.AdError],function(){return e.spromise.timeout(r._loadNext(t.errors.SeqEmpty(),!0),e.context.timeouts.initSeq,t.errors.SeqTimeout())}).inspect(function(t,i){return i||r._handleEvent(e.vpaid.events.AdError,t)}))},s.prototype._loadNext=function(t,r){var i=this;return this._next()?this._spawn().catch(function(e){return i._loadNext(e,!0)}):e.spromise.rejected(t)},s.prototype._spawn=function(){var i;this._disposeChild(e.base.errors.New);var s=this.break;if(s.error)i=e.spromise.rejected(s.error);else{var n=s.vast;n&&0!==n.childElementCount?(this._child=(new r.factory.Builder).setClass(r.Vast).setFactory(r.factory.BuiltInFactory).setSettings({allowPods:!0,allowWrappers:5,breakAdPodDefault:!1,sameSkipTime:!1,contentData:this._contentData}).setTargetParent(this).setInteractiveTypes(this._interactiveTypes).setSizeRec(this._sizeRec).setBreak(this._queue.breaks[this._idx]).setInit(n).build(),this._subscribeEvents(),i=this._child.initAd()):i=e.spromise.rejected(t.errors.VastEmpty())}return i},s.prototype._handleEventEnd=function(t){for(var r,s=[],n=1;n<arguments.length;n++)s[n-1]=arguments[n];if(this._disposing)return e.spromise.rejected(e.base.errors.Disposing);switch(t){case e.vpaid.events.AdLoaded:this._autoStart&&this.startAd()}return(r=i.prototype._handleEventEnd).apply.call(r,this,[t].concat(s))},s.prototype._next=function(){return!this._disposing&&(this._idx=void 0===this._idx?0:this._idx+1,this._queue.breaks&&this._idx<this._queue.breaks.length)},s}(r.AManageNode),r.Sequence=i}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=function(i){function s(){var t=null!==i&&i.apply(this,arguments)||this;return t._queues=[],t._loaders=[],t._loadBegin=e.spromise.deffer(),t._loadEnd=e.spromise.deffer(),t}return __extends(s,i),Object.defineProperty(s.prototype,"name",{get:function(){return"Vmap"},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"whenLoadBegin",{get:function(){return this._loadBegin.promise},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"whenLoadEnd",{get:function(){return this._loadEnd.promise},enumerable:!0,configurable:!0}),s.prototype.setTargetId=function(e){return this._targetId=e,this},s.prototype.setTypeId=function(e){return this._typeId=e,this},s.prototype.setTokenRec=function(e){return this._tokenRec=e,this},s.prototype.setStatRec=function(e){return this._statRec=e,this},s.prototype.build=function(){i.prototype.build.call(this),this._options={userGA:void 0,uid:void 0},this._tokenRec.token&&""!==this._tokenRec.token||this._devstatTransmit(e.devstat.errNoToken,"build()");var t={id:this._contentData.advarkId,autoplay:this._contentData.autoplay,category_id:this._contentData.categoryId,video_title:this._contentData.videoTitle,label_id:this._contentData.labelId,page_url:this._contentData.videoPageUrl,duration:this._contentData.duration,referer_url:this._contentData.referer,publisher:this._contentData.publisher,seed:Math.random(),session_id:this._tokenRec.token,target_id:this._targetId,type_id:this._typeId,uid:this._statRec.uid,psd:this._statRec.userPsd,gpsd:this._statRec.groupPsd,personal_stat:this._statRec.userStat,group_personal_stat:this._statRec.groupStat},r=e.StringUtils.toQueryString(e.str.toMap(t)),n=s._VmapRoot;return e.context.secretKeys.iframe_useTestApi&&(n=s._TestVmapRoot),this._vmapUri=n+"?"+r,this},s.prototype.queueSpawn=function(i,s){var n=this;if(this._disposing)return e.spromise.rejected(e.base.errors.Disposing);if(!this._promise){this._registrar.setEventTime(r.trackings._vmapRequested),this._loadBegin.resolve();var a=!0;e.context.secretKeys.iframe_useTestApi&&(a=!1),this._promise=(new t.frame.Request).setUri(this._vmapUri).setCredentials(a).setLocal(!0).send().inspect(function(e,t){return t?n._onVmapLoaded(e):n._onVmapError(e)})}return this._promise.then(function(e){return n._queueSpawn(i,s)})},s.prototype.queueNext=function(){var t=this;return this._loadEnd.promise.then(function(r){var i=t._queues.shift();return i?i.promise.catch(function(e){return t.queueNext()}):e.spromise.rejected(e.base.errors.NotImplemented)})},s.prototype._queueSpawn=function(e,t){var i=(new r.Queue).setBreakType(e).setTimeOffset(t).setLoaders(this._loaders).build();return this._queues.push(i),i.promise},s.prototype._onVmapLoaded=function(t){var i=this;if(!this._disposing){var s=e.XMLUtils.parseXML(t.text),n=e.XMLUtils.getFirstElement(s),a=n.namespaceURI,o=n.getElementsByTagNameNS(a,"AdBreak");e.each(o,function(e){i._loaders.push((new r.BreakLoader).setParent(i).setSource(e).setVmapNs(n.namespaceURI).setContentData(i._contentData).build())});var d=this._parseExtensions(n,a);this._registrar.register(r.trackings._vmapLoaded),this._loadEnd.resolve(d)}},s.prototype._onVmapError=function(e){this._disposing||this._loadEnd.reject(e.error)},s.prototype._parseExtensions=function(i,s){var n=this,a={isEmpty:0===this._loaders.length},o=i.getElementsByTagNameNS(s,"Extension");return e.each(o,function(i){var s=i.textContent.trim();switch(i.getAttribute("type")){case"userstat":a.userStat=s,e.lstorage.write(t.frame.lstorage.userStat,a.userStat),e.lstorage.del(t.frame.lstorage.userPsd);break;case"groupuserstat":a.groupStat=s,e.lstorage.write(t.frame.lstorage.groupStat,a.groupStat),e.lstorage.del(t.frame.lstorage.groupPsd);break;case"uid":n._options.uid=s,a.uid=s,e.lstorage.write(t.frame.lstorage.uid,a.uid);break;case"userga":n._options.userGA=s;break;case"track":n._registrar.appendUri(r.trackings._vmapLoaded,s)}}),a},s.prototype._dispose=function(e){return delete this._loaders,delete this._queues,i.prototype._dispose.call(this,e)},s._VmapRoot="//api.advarkads.com/api/vmap",s._TestVmapRoot="http://apitest.advarkads.com/api/vmap",s}(r.ARegistrarOwner),r.VmapLoader=i}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.frame||(t.frame={}),i=function(i){function s(){var e=null!==i&&i.apply(this,arguments)||this;return e._sequences={},e}return __extends(s,i),s.prototype._getHandlingEvents=function(){return[e.events.VastLoad,e.vpaid.events.AdClickThru,e.vpaid.events.AdDurationChange,e.vpaid.events.AdError,e.vpaid.events.AdExpandedChange,e.vpaid.events.AdImpression,e.vpaid.events.AdInteraction,e.vpaid.events.AdLinearChange,e.vpaid.events.AdLoaded,e.vpaid.events.AdLog,e.vpaid.events.AdPaused,e.vpaid.events.AdPlaying,e.vpaid.events.AdRemainingTimeChange,e.vpaid.events.AdSizeChange,e.vpaid.events.AdSkippableStateChange,e.vpaid.events.AdSkipped,e.vpaid.events.AdStarted,e.vpaid.events.AdStopped,e.vpaid.events.AdUserAcceptInvitation,e.vpaid.events.AdUserClose,e.vpaid.events.AdUserMinimize,e.vpaid.events.AdVideoFirstQuartile,e.vpaid.events.AdVideoMidpoint,e.vpaid.events.AdVideoStart,e.vpaid.events.AdVideoThirdQuartile,e.vpaid.events.AdVideoComplete,e.vpaid.events.AdVolumeChange]},Object.defineProperty(s.prototype,"_current",{get:function(){return this._sequences.linear||this._sequences.nonlinear},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"_statRec",{get:function(){return{uid:this._contentData.uid||e.lstorage.read(r.lstorage.uid),userStat:e.lstorage.read(r.lstorage.userStat),userPsd:e.lstorage.read(r.lstorage.userPsd),groupStat:e.lstorage.read(r.lstorage.groupStat),groupPsd:e.lstorage.read(r.lstorage.groupPsd)}},enumerable:!0,configurable:!0}),s.prototype.setTokenRec=function(e){return this._tokenRec=e,this},s.prototype.setIntegrationType=function(e){return this._integrationType=e,this},Object.defineProperty(s.prototype,"name",{get:function(){return"Frame"},enumerable:!0,configurable:!0}),s.prototype.build=function(){return i.prototype.build.call(this),this._states.setStrict(!1),this._registrar.setEventTime(t.manage.trackings._tokenCreated,r.token.tracker.created),this._connect(),this},s.prototype._connect=function(){var e=this,i={setupAd:this.setupAd.bind(this),initAd:this.initAd.bind(this),startAd:this.startAd.bind(this),stopAd:this.stopAd.bind(this),pauseAd:this.pauseAd.bind(this),resumeAd:this.resumeAd.bind(this)};return this._connecting=r.client.connect(i).then(function(t){return r=t,e._config=r.config,e._interactiveTypes=r.interactiveTypes,void(e._sizeRec=r.sizeRec);var r}).then(function(){return r.token.tracker.whenLoad.then(function(t){return e.setTokenRec(t)})}).then(function(){return e._registerEvent(t.manage.trackings._frameInit)}),this._connecting},s.prototype._reset=function(){var i=this;return e.spromise.join([this._disposeChild("linear",e.base.errors.Reset),this._disposeChild("nonlinear",e.base.errors.Reset)]).inspect(function(){r.token.tracker.drop()}).then(function(){return r.token.tracker.whenLoad.then(function(e){return i.setTokenRec(e)})}).then(function(){return i._registerEvent(t.manage.trackings._frameInit)})},s.prototype.setupAd=function(t,r,i,s){var n=this;this.setContentData(t),this._contentData.advarkId=this._contentData.advarkId||r,this._contentData.referer=this._contentData.referer||document.referrer,this._contentData.hashVideoId=this._contentData.referer?Sha1.hash(this._contentData.referer):"",this._contentData.videoUrl=this._contentData.videoUrl||this._contentData.videoPageUrl||this._contentData.referer,this._contentData.videoUrl=this._contentData.videoPageUrl||this._contentData.referer;var a=!!this._configuring;return this._configuring=this._connecting.then(function(){return a?n._reset():e.spromise.resolved()}).then(function(){return n._buildVmapLoader(i,s)}),this._configuring},s.prototype.initAd=function(r,i){var s=this;return void 0===r&&(r=void 0),void 0===i&&(i=void 0),this._states.reset(),this._states.loading=!0,this._configuring.then(function(){return r?s._vmapLoader.queueSpawn(r,i):e.spromise.join([s._vmapLoader.queueSpawn("linear",i),s._vmapLoader.queueSpawn("nonlinear",i)])}).then(function(){return s._vmapLoader.queueNext().then(function(e){return s._spawn(e)})}).catch(function(r){return s._handleEvent(e.vpaid.events.AdError,void 0,t.errors.SeqEmpty(r))})},s.prototype.startAd=function(){return this._states.starting=!0,this._current?this._current.startAd():e.spromise.resolved()},s.prototype.stopAd=function(){return this._states.stopping=!0,this._current?this._current.stopAd():e.spromise.resolved()},s.prototype.pauseAd=function(){return this._states.pausing=!0,this._current?this._current.pauseAd():e.spromise.resolved()},s.prototype.resumeAd=function(){return this._states.resuming=!0,this._current?this._current.resumeAd():e.spromise.resolved()},s.prototype._handleEvent=function(t,r){for(var s,n=this,a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];if(this._disposing)return e.spromise.rejected(e.base.errors.Disposing);var d,c=a[0]||{};if(r){var p=void 0,u=void 0,l=void 0,h=this._sequences[r.breakType];switch(h&&(p=h.break?h.break.id:void 0,u=h.extensionsData&&h.extensionsData.label,l=h.startTime&&h.startTime.getTime()),t){case e.vpaid.events.AdPaused:this._gaTrack(e.ga.events.PAUSE,p,void 0,!0,!1);break;case e.vpaid.events.AdVideoStart:this._gaTrack(e.ga.events.IMPRESSION,p,void 0,!0,!1),this._gaTrack(e.ga.events.IMPRESSION,u,void 0,!1,!0);break;case e.vpaid.events.AdVideoComplete:this._gaTrack(e.ga.events.FULL_VIEWED,p,void 0,!0,!1);break;case e.vpaid.events.AdClickThru:this._gaTrack(e.ga.events.CLICK,p,void 0,!0,!1),this._gaTrack(e.ga.events.CLICK,u,void 0,!1,!0);break;case e.vpaid.events.AdUserClose:case e.vpaid.events.AdSkipped:this._gaTrack(e.ga.events.SKIP,p,void 0,!0,!1);break;case e.vpaid.events.AdStopped:if(l){var v=((new Date).getTime()-l)/1e3;this._gaTrack(e.ga.events.VIEWED,p,v,!0,!1)}break;case e.vpaid.events.AdVolumeChange:a[0].volume===e.vpaid.VolumeMin&&this._gaTrack(e.ga.events.MUTE,p,void 0,!0,!1)}switch(c.breakType=r.breakType,c.timeOffset=r.timeOffset,a[0]=c,t){case e.vpaid.events.AdStarted:this._sequences.nonlinear&&"linear"===r.breakType&&this._sequences.nonlinear.pauseAd();break;case e.vpaid.events.AdStopped:case e.vpaid.events.AdError:var f=t===e.vpaid.events.AdStopped?e.base.errors.Stopped:a[0];s=this._dispatch.apply(this,[t].concat(a)).then(function(){return n._disposeChild(r.breakType,f)}).then(function(){return"end"!==r.timeOffset&&n._current&&"nonlinear"===n._current.queue.breakType?n.resumeAd():n._vmapLoader.queueNext().then(function(e){return n._spawn(e)})})}}return s=s||(d=i.prototype._handleEvent).apply.call(d,this,[t,c])},s.prototype._dispatch=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return r.client.event.apply(r.client,[e].concat(t))},s.prototype._dispose=function(t){var r=this;return e.spromise.join([this._disposeChild("linear",t),this._disposeChild("nonlinear",t)]).then(function(){return i.prototype._dispose.call(r,t)})},s.prototype._spawn=function(r){var i=this;if(!this._sequences[r.breakType]){for(var s=[],n=0,a=r.breaks;n<a.length;n++){var o=a[n];-1===s.indexOf(o.id)&&(s.push[o.id],this._gaTrack(e.ga.events.INVENTORY,o.id,void 0,!0,!0))}this._states.reset();var d=(new t.manage.Sequence).setParent(this).setContentData(this._contentData).setSizeRec(this._sizeRec).setInteractiveTypes(this._interactiveTypes).setAutoStart(this._config.autoStart).setQueue(r).build();this._sequences[r.breakType]=d,this._subscribeEvents(d,r),d.initAd(),"nonlinear"===r.breakType&&this._vmapLoader.queueNext().then(function(e){return i._spawn(e)})}},s.prototype._disposeChild=function(t,r){var i=this;return this._sequences[t]?this._sequences[t].dispose(r).anycase(function(){delete i._sequences[t]}).catch(function(){return e.spromise.resolved()}):e.spromise.resolved()},s.prototype._registerEvent=function(t){if(this._tokenRec.token){var r=void 0;switch(t){case"_frameInit":var i=this._tokenRec.source?"":encodeURIComponent(",~ref,"+e.getHosts().join(","));r=s._StatUrlEvent.replace("{event_name}","1").replace("{token}",this._tokenRec.token)+"?ep="+this._integrationType+"&et=[ctimestamp]&ed=[delta]"+(i?"&e="+i:"");break;case"_vmapRequested":r=s._StatUrlEvent.replace("{token}",this._tokenRec.token).replace("{event_name}","2")+"?ep="+this._contentData.advarkId+"-"+this._labelId+"&et=[ctimestamp]&ed=[delta]";break;case"_vmapLoaded":var n=this._contentData.uid?this._contentData.uid.replace(/-/gi,""):"";r=s._StatUrlEvent.replace("{token}",this._tokenRec.token).replace("{event_name}","3")+"?ep="+n+"-"+this._advarkId+"-"+this._labelId+"&et=[ctimestamp]&ed=[delta]"}this._registrar.appendUri(t,r)}this._registrar.register(t)},s.prototype._buildVmapLoader=function(r,i){var s=this;this._vmapLoader=(new t.manage.VmapLoader).setParent(this).setContentData(this._contentData).setTargetId(r).setTypeId(i).setTokenRec(this._tokenRec).setStatRec(this._statRec).build(),this._vmapLoader.whenLoadBegin.then(function(){return s._registerEvent(t.manage.trackings._vmapRequested)}),this._vmapLoader.whenLoadEnd.then(function(r){return i=r,s._contentData.uid=i.uid,s._registerEvent(t.manage.trackings._vmapLoaded),i.isEmpty?s._dispatch(e.events.Empty):(s._vmapLoader.options.userGA&&(s._googleTracker=new e.GoogleAnalytics,s._vmapLoader.options.userGA&&s._googleTracker.create(s._vmapLoader.options.userGA,"user")),e.spromise.resolved());var i}).catch(function(t){return s._dispatch(e.events.Empty)})},s.prototype._gaTrack=function(e,t,r,i,s){void 0===r&&(r=void 0),void 0===i&&(i=!0),void 0===s&&(s=!0),this._googleTracker&&s&&this._vmapLoader.options.userGA&&this._googleTracker.track("user","Advark",e,t)},s._StatUrlEvent=(location.protocol,"//st.tyt.me/track/a/{event_name}/{token}"),s}(t.manage.ARegistrarOwner),r.Frame=i}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=function(i){function s(){var e=null!==i&&i.apply(this,arguments)||this;return e._ads=[],e._adPlayed=!1,e}return __extends(s,i),Object.defineProperty(s.prototype,"name",{get:function(){return"Vast"},enumerable:!0,configurable:!0}),s.prototype.initAd=function(){var i,s=this;if(this._disposing)return e.spromise.rejected(e.base.errors.Disposing);if(this._source=this._init||this._adParams,!(i=this._source?this._states.loading||this._states.loaded?e.spromise.rejected(e.base.errors.AlreadyDone):void 0:e.spromise.rejected(e.base.errors.Empty))){this._registrar.setEventTime(r.trackings._breakLoaded,this._break.timestamp),this.devstatWrite(this,e.devstat.msgToVastLoad,e.devstat.mthInit+e.devstat.strCalled),this._states.loading=!0;var n=function(){return e.spromise.timeout(s._loadNext(t.errors.VastEmpty(),!0),e.context.timeouts.initAd,t.errors.VastTimeout())};i=this._parse().then(function(){return s._reduceEvents([e.vpaid.events.AdError],n)}).inspect(function(t,r){return r||s._handleEvent(e.vpaid.events.AdError,t)})}return i},s.prototype._handleEventEnd=function(t){for(var r,s=[],n=1;n<arguments.length;n++)s[n-1]=arguments[n];if(this._disposing)return e.spromise.rejected(e.base.errors.Disposing);switch(t){case e.events.pod.ResetPod:this._registrar.reset();break;case e.events.WaitUser:case e.vpaid.events.AdStarted:this._adPlayed=!0}return(r=i.prototype._handleEventEnd).apply.call(r,this,[t].concat(s))},s.prototype._parse=function(){var r,i=this;return!this._init&&this._adParams?("1"===this._adParams.nologo&&(this._settings.video.showLogo=!1,this._settings.vpaid.showLogo=!1),this._credentials=!this._adParams.credentials||"false"!==this._adParams.credentials.toString().toLowerCase(),r=this._adParams.match?this._wbrmPrepr(this._adParams.match).then(function(e){return t.frame.client.track([e],!0)}).anycase(function(){return i._load(i._adParams.vast,i._adParams.url)}):this._load(this._adParams.vast,this._adParams.url)):r=this._init?this._loadNode(this._init).then(function(e){return i._loadElement(e)}):void 0,r||e.spromise.rejected(t.errors.VastNoWay())},s.prototype._loadNext=function(t,r){var i=this;return this._next()?this._spawn().catch(function(e){return i._loadNext(e,!0)}):e.spromise.rejected(t)},s.prototype._next=function(){if(this._disposing)return!1;this._registrar.clear(),void 0===this._idx?(this._idx=0,this._subIdx=0):this._subIdx++;var e=!1;return this._idx<this._ads.length&&(this._subIdx<this._ads[this._idx].length?e=!this._disablePod:(this._idx++,this._subIdx=0,e=!this._adPlayed&&this._idx<this._ads.length&&this._ads[this._idx].length>this._subIdx)),e},s.prototype._spawn=function(){return this._disposeChild(e.base.errors.New),this._disablePod&&this._dispatch(e.events.pod.BreakPod),this._child=(new r.factory.Builder).setParent(this).setClass(r.Ad).setTargetParent(this).setSettings(this._settings).setFactory(this._factory).setBreak(this._break).setInteractiveTypes(this._interactiveTypes).setSizeRec(this._sizeRec).setInit(this._ads[this._idx][this._subIdx]).build(),this._subscribeEvents(),this._child.initAd()},s.prototype._load=function(i,s){var n,a=this;return this._disposing?e.spromise.rejected(e.base.errors.Disposed):(this.devstatWrite(this,e.devstat.msgToVastLoad,e.devstat.mthLoad+e.devstat.strCalled),i?n=this._loadString(i):s&&(s=r.prepr.process(s,r.prepr.def(this._contentData)),n=(new t.frame.Request).setUri(s).setCredentials(this._credentials).send().then(function(e){return a._loadString(e.text)},function(r){return e.spromise.rejected(t.errors.VastNoLoad(r.error,r))})),n)},s.prototype._loadString=function(r){var i,s=this;if(this._disposing)return e.spromise.rejected(e.base.errors.Disposing);if(r&&r.trim&&r.trim().length>0){this._source=r,this.devstatWrite(this,e.devstat.msgToVastLoad,e.devstat.mthLoadString+e.devstat.strCalled);var n=void 0;try{var a=(n=e.XMLUtils.parseXML(r)).getElementsByTagName("parsererror")[0];if(a){var o=a.getElementsByTagName("div")[0],d=o?o.textContent.trim():"Parser error";throw new Error(d)}}catch(r){i=e.spromise.rejected(t.errors.VastBadXML(r))}i=i||this._loadNode(n).then(function(e){return s._loadElement(e)})}else i=e.spromise.rejected(t.errors.VastEmpty());return i},s.prototype._loadNode=function(r){return this._source=r,this.devstatWrite(this,e.devstat.msgToVastLoad,e.devstat.mthLoadNode+e.devstat.strCalled),r?r.getElementsByTagName("nobanner")[0]?e.spromise.rejected(t.errors.VastNoBanner()):r.getElementsByTagName("noad")[0]?e.spromise.rejected(t.errors.VastNoAd()):("VAST"!==r.nodeName&&(r=e.XMLUtils.getFirstElement(r)),"VAST"!==r.nodeName?e.spromise.rejected(t.errors.VastNoNode()):e.XMLUtils.getFirstElement(r)?e.spromise.resolved(r):e.spromise.rejected(t.errors.VastEmpty())):e.spromise.rejected(t.errors.VastNoNode())},s.prototype._loadElement=function(t){var i=this;this._source=t,this.devstatWrite(this,e.devstat.msgToVastLoad,e.devstat.mthLoadElement+e.devstat.strCalled);var s=t.getElementsByTagName("Ad"),n=[];e.each(s,function(e){e.attributes.getNamedItem("sequence")&&n.push(e)}),n.length>0&&this._ads.push(n),e.each(s,function(e){e.attributes.getNamedItem("sequence")||i._ads.push([e])});var a=t.getElementsByTagName("Error");e.each(a,function(e){e&&e.parentElement==t&&i._registrar.appendUri(r.trackings.error,e.textContent)})},s}(r.AManageItem),r.Vast=i}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e._breaks=[],e}return __extends(r,t),Object.defineProperty(r.prototype,"timeOffset",{get:function(){return this._timeOffset},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"breakType",{get:function(){return this._breakType},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"breaks",{get:function(){return this._breaks},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"promise",{get:function(){var t=this;if(!this._promise)if(0===this._breaks.length)this._promise=e.spromise.rejected(e.base.errors.Empty);else{for(var r=[],i=0,s=this._breaks;i<s.length;i++){var n=s[i];r.push(n.promise)}this._promise=e.spromise.join(r).then(function(){return t})}return this._promise},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"name",{get:function(){return"Queue_"+this._breakType+"_"+this._timeOffset},enumerable:!0,configurable:!0}),r.prototype.setTimeOffset=function(e){return this._timeOffset=e,this},r.prototype.setBreakType=function(e){return this._breakType=e,this},r.prototype.setLoaders=function(e){return this._loaders=e,this},r.prototype.build=function(){return t.prototype.build.call(this),this._load(),this},r.prototype._load=function(){this._breakType=this._breakType||(this._loaders[0]?this._loaders[0].breakType:void 0);for(var e=0,t=this._loaders;e<t.length;e++)(s=t[e]).used||s.breakType!==this._breakType||this._timeOffset&&s.timeOffset!==this._timeOffset||(s.used=!0,this._breaks.push(s.break));if(0==this._breaks.length)for(var r=0,i=this._loaders;r<i.length;r++){var s;(s=i[r]).breakType===this._breakType&&-1!==s.repeatAfter.indexOf(this._timeOffset)&&this._breaks.push(s.break)}return this._breaks.sort(function(e,t){return e.sequence-t.sequence}),this.promise},r}(e.base.factory.ABuildableItem),r.Queue=i}(advark||(advark={})),function(e){var t,r;t=e.ga||(e.ga={}),(r=t.events||(t.events={})).PAUSE="Pause",r.IMPRESSION="Impression",r.FULL_VIEWED="FullViewed",r.CLICK="AdClick",r.SKIP="Skip",r.VIEWED="Viewed",r.MUTE="Mute",r.INVENTORY="Inventory"}(advark||(advark={})),function(e){var t=function(){function e(){var e=this;this._preQueue=[],this._iframe=document.createElement("iframe"),this._iframe.src="about:blank",this._iframe.style.width="1px",this._iframe.style.height="1px",this._iframe.style.position="absolute",this._iframe.style.left="-90000px",this._iframe.style.top="0",this._iframe.style.border="0",this._iframe.onload=function(){e._window=e._iframe.contentWindow,e._window.ga=e._window.ga||function(){(this._window.ga.q=this._window.ga.q||[]).push(arguments)}.bind(e),e._window.ga.l=+new Date;for(var t=0;t<e._preQueue.length;t++)switch(e._preQueue[t].command){case"send":e._window.ga(e._preQueue[t].trackerName+".send","event",e._preQueue[t].category,e._preQueue[t].action,e._preQueue[t].label,e._preQueue[t].value);break;case"create":e._window.ga("create",e._preQueue[t].trackerId,"auto",e._preQueue[t].trackerName),e._window.ga(e._preQueue[t].trackerName+".set","checkProtocolTask",null)}e._preQueue.length=0;var r=document.createElement("script");r.async=!0,r.src="//www.google-analytics.com/analytics.js",e._window.document.body.appendChild(r)},document.body.appendChild(this._iframe)}return e.prototype.create=function(e,t){this._window?(this._window.ga("create",e,"auto",t),this._window.ga(t+".set","checkProtocolTask",null)):this._preQueue.push({command:"create",trackerId:e,trackerName:t})},e.prototype.track=function(e,t,r,i,s){this._window?this._window.ga(e+".send","event",t,r,i,s):this._preQueue.push({command:"send",trackerName:e,category:t,action:r,label:i,value:s})},e.prototype.dispose=function(){this._iframe&&this._iframe.parentNode&&this._iframe.parentNode.removeChild(this._iframe)},e}();e.GoogleAnalytics=t}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),i=t.manage||(t.manage={}),(r=i.trackings||(i.trackings={})).trackEvent=function(t){switch(t){case e.events.ClickRedirect:return r.click;case e.events.VastLoad:return r.vastLoad;case e.events.viewability.viewable:return r.viewable;case e.events.viewability.notViewable:return r.notViewable;case e.events.viewability.viewUndetermined:return r.viewUndetermined;case e.vpaid.events.AdImpression:return r.impression;case e.vpaid.events.AdVideoStart:return r.videoStart;case e.vpaid.events.AdVideoFirstQuartile:return r.videoFirstQuartile;case e.vpaid.events.AdVideoMidpoint:return r.videoMidpoint;case e.vpaid.events.AdVideoThirdQuartile:return r.videoThridQuartile;case e.vpaid.events.AdVideoComplete:case e.vpaid.events.AdVideoStart:return r.videoComplete;case e.vpaid.events.AdUserAcceptInvitation:return r.acceptInvintation;case e.vpaid.events.AdClickThru:return r.clickThrough;case e.vpaid.events.AdPlaying:return r.resume;case e.vpaid.events.AdPaused:return r.pause;case e.vpaid.events.AdUserClose:return r.close;case e.vpaid.events.AdSkipped:return r.skip;default:return}},r.allowMult=function(e){switch(e){case r.expand:case r.collapse:case r.click:case r.playerCollapse:case r.playerExpand:case r.acceptInvintation:case r.clickThrough:case r.resume:case r.pause:case r.rewind:return!0;default:return!1}},r._frameInit="_frameInit",r._vmapRequested="_vmapRequested",r._vmapLoaded="_vmapLoaded",r._breakRequested="_breakRequested",r._breakLoaded="_breakLoaded",r._tokenCreated="_tokenCreated",r.vastLoad="vastLoad",r.clickThrough="clickThrough",r.impression="impression",r.error="error",r.click="adClick",r.expand="adExpand",r.collapse="adCollapse",r.request="adRequest",r.select="adSelect",r.skip=e.vast.trackings.any.skip,r.mute=e.vast.trackings.any.mute,r.unmute=e.vast.trackings.any.unmute,r.pause=e.vast.trackings.any.pause,r.resume=e.vast.trackings.any.resume,r.rewind=e.vast.trackings.any.rewind,r.playerExpand=e.vast.trackings.any.playerExpand,r.playerCollapse=e.vast.trackings.any.playerCollapse,r.start=e.vast.trackings.linear.start,r.videoStart="adVideoStart",r.videoFirstQuartile=e.vast.trackings.linear.firstQuartile,r.videoMidpoint=e.vast.trackings.linear.midpoint,r.videoThridQuartile=e.vast.trackings.linear.thirdQuartile,r.videoComplete=e.vast.trackings.linear.complete,r.creativeView=e.vast.trackings.nonlinear.creativeView,r.acceptInvintation=e.vast.trackings.nonlinear.acceptInvitation,r.close=e.vast.trackings.nonlinear.close,r.minimize=e.vast.trackings.nonlinear.minimize,r.progress=e.vast.trackings.linear.progress,r.viewable=e.events.viewability.viewable,r.notViewable=e.events.viewability.notViewable,r.viewUndetermined=e.events.viewability.viewUndetermined}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.frame||(t.frame={}),(i=r.lstorage||(r.lstorage={})).uid="advark.uid",i.userStat="advark.userstat",i.userPsd="advark.userstataddons",i.groupStat="advark.groupuserstat",i.groupPsd="advark.groupuserstataddons",i.adfoxExpire="advark.adfoxExpire",i.adfoxAge="advark.adfoxAge",i.adfoxGender="advark.adfoxGender",i.adfoxRevenue="advark.adfoxRevenue",i.wbrmExpire="advark.wbrmExpire",i.wbrmAge="advark.wbrmAge",i.wbrmAudiences="advark.wbrmAudiences",i.wbrmClusters="advark.wbrmClusters",i.wbrmGender="advark.wbrmGender",i.wbrmSocialClass="advark.wbrmSocialClass"}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),i=t.manage||(t.manage={}),(r=i.prepr||(i.prepr={})).process=function(t,r){return e.prepr.process(t,r)},r.def=function(t,i){void 0===i&&(i=void 0);var s=e.prepr.def(t,i),n=r.DeviceDetector.detectOS(navigator.userAgent);return s.device=n.device,s.platform=n.platform,t&&(s.uid=t.uid||"",s.puid12=t.isFlash?13:r.DeviceDetector.detectIV(navigator.userAgent)),s}}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.prepr||(r.prepr={}),s=function(){function e(){}return e._GetPlatform=function(t,r){for(var i=0;i<r.length;++i){var s=r[i];if(s.regex.test(t))return s.platform}return e.Default},e.detectIV=function(t){var r=e._GetPlatform(t,e._regsIV);switch(r){case e.Android:var i=window.screen.width,s=window.screen.height,n=window.devicePixelRatio;return i*(n=void 0!=n?n:1)>1280||s*n>1280?e.AndroidLarge:e.AndroidSmall;default:return r}},e.detectOS=function(t){switch(e._GetPlatform(t,e._regsOS)){case e.Android:var r=window.screen.width,i=window.screen.height,s=window.devicePixelRatio;return r*(s=void 0!=s?s:1)>1280||i*s>1280?{platform:e.Android,device:e.Tablet}:{platform:e.Android,device:e.Phone};case e.IPad:return{platform:e.IOS,device:e.Tablet};case e.IPhone:return{platform:e.IOS,device:e.Phone};case e.WinTablet:return{platform:e.Windows,device:e.Tablet};case e.WinMobile:return{platform:e.Windows,device:e.Phone}}return{platform:"",device:""}},e.IPhone=1,e.IPad=2,e.WinMobile=5,e.WinTablet=6,e.TizenMobile=7,e.TizenTablet=8,e.LG=9,e.Samsung=10,e.Philips=11,e.Sony=12,e.AndroidSmall=3,e.AndroidLarge=4,e.Default=16,e.Tablet="tablet",e.Phone="phone",e.Android="android",e.IOS="ios",e.Windows="windows",e._regsIV=[{platform:e.LG,regex:new RegExp("((\\b(lg\\-)|(lgm))\\w\\d+)|(\\bas\\d{3}\\b)|(\\blg\\b)","i")},{platform:e.Samsung,regex:new RegExp("((sm\\-|shw\\-|shv\\-|sch\\-|sgh\\-|gt\\-|sam\\-)\\w+)|samsung","i")},{platform:e.Philips,regex:new RegExp("(philips)|(\\bSA3CNT\\b)","gi")},{platform:e.Sony,regex:new RegExp("(\\bSony)|(SonyEricsson)|(\\bPLAYSTATION\\b)|(\\bso\\-\\d{2})|(Sony Xperia)|(\\blt\\d{2}\\w{1,2}\\b)|(\\b(C[1-6]|D[2-6]|E[2-6])\\d{3}\\b)|(sgpt?\\d+\\b)|(\\bsol\\d+\\b)","i")},{platform:e.WinMobile,regex:new RegExp("(windows phone)|wm5|(Windows CE)|(WindowsMobile)|(Windows Mobile)","i")},{platform:e.WinTablet,regex:new RegExp("windows.+Touch","i")},{platform:e.TizenMobile,regex:new RegExp("tizen.+?Mobile","i")},{platform:e.TizenTablet,regex:new RegExp("tizen","i")},{platform:e.Android,regex:new RegExp("(\\badr\\s)|(android)|(Puffin/[\\.0-9]+A[PT])","i")},{platform:e.IPad,regex:new RegExp("(Ipad)|(\\bipd\\s)|(Puffin/[\\.0-9]+IT)","i")},{platform:e.IPhone,regex:new RegExp("(iphone)|(\\bios\\b)|(\\biph\\s)|(Puffin/[\\.0-9]+IP)","i")}],e._regsOS=[{platform:e.WinMobile,regex:new RegExp("(windows phone)|wm5|(Windows CE)|(WindowsMobile)|(Windows Mobile)","i")},{platform:e.WinTablet,regex:new RegExp("windows.+Touch","i")},{platform:e.Android,regex:new RegExp("(\\badr\\s)|(android)|(Puffin/[\\.0-9]+A[PT])","i")},{platform:e.IPad,regex:new RegExp("(Ipad)|(\\bipd\\s)|(Puffin/[\\.0-9]+IT)","i")},{platform:e.IPhone,regex:new RegExp("(iphone)|(\\bios\\b)|(\\biph\\s)|(Puffin/[\\.0-9]+IP)","i")}],e}(),i.DeviceDetector=s}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.prepr||(r.prepr={}),function(r){var s=/\[(?:.*?:)?wbrm.*?\]/i,n="//wam.solution.weborama.fr/fcgi-bin/dispatch.fcgi?d.A=prd&d.key=n9d9C9I4XN1I&d.format=json&d.top_clusters=10";function a(r){var i,s=JSON.parse(r),n={wbrmAge:"",wbrmGender:"",wbrmAudiences:"",wbrmClusters:"",wbrmSocialClass:""};return n.wbrmGender=s.socio_demographics.gender,n.wbrmAge=s.socio_demographics.age,n.wbrmSocialClass=s.socio_demographics.social_class,n.wbrmClusters=s.clusters.join(":"),n.wbrmAudiences=s.audiences.slice(0,10).join(":"),i=n,e.lstorage.write(t.frame.lstorage.wbrmExpire,((new Date).getTime()+864e5).toString()),e.lstorage.write(t.frame.lstorage.wbrmGender,i.wbrmGender),e.lstorage.write(t.frame.lstorage.wbrmAge,i.wbrmAge),e.lstorage.write(t.frame.lstorage.wbrmSocialClass,i.wbrmSocialClass),e.lstorage.write(t.frame.lstorage.wbrmClusters,i.wbrmClusters),e.lstorage.write(t.frame.lstorage.wbrmAudiences,i.wbrmAudiences),n}(i.weborama||(i.weborama={})).preprData=function(r){if(s.test(r)){var i=function(){var r=e.lstorage.read(t.frame.lstorage.wbrmExpire);if(!(r&&(new Date).getTime()>=Number(r)))return{wbrmAge:e.lstorage.read(t.frame.lstorage.wbrmAge),wbrmAudiences:e.lstorage.read(t.frame.lstorage.wbrmAudiences),wbrmClusters:e.lstorage.read(t.frame.lstorage.wbrmClusters),wbrmGender:e.lstorage.read(t.frame.lstorage.wbrmGender),wbrmSocialClass:e.lstorage.read(t.frame.lstorage.wbrmSocialClass)}}();return i?e.spromise.resolved(i):e.spromise.promise(function(e,r){return(new t.frame.Request).setUri(n).setCredentials(!0).send().inspect(function(t,r){return e(r?a(t.text):{wbrmAge:"",wbrmGender:"",wbrmAudiences:"",wbrmClusters:"",wbrmSocialClass:""})})})}return e.spromise.rejected(e.base.errors.NotSupported)}}()}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.tracker||(r.tracker={}),(s=i.errors||(i.errors={})).UNDEFINED="Tracking uri is null or undefined",s.EMPTY="Tracking uri is empty string",s.DOUBLE="Double tracking uri",s.NODOMIAN="Tracking uri has no domain",s.NoSuchEventUri="No such URI to track",s.AlreadyTracked="This tracking event was already tracked"}(advark||(advark={})),function(e){var t,r,i,s,n;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.tracker||(r.tracker={}),s=i.devstat||(i.devstat={}),n=e.devstat.strErrorPrefix+"tracker"+e.devstat.strSelector,s.UNKNOWN_TRACKING=n+"unknown",s.DOUBLE_TRACKING=n+"double",s.NOVALUE_TRACKING=n+"novalue",s.EMPTY_TRACKING=n+"emptystr",s.NODOMAIN_TRACKING=n+"nodomain",s.UNEXPECTED_TRACKING=n+"unexpected"}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=function(i){function s(){var e=null!==i&&i.apply(this,arguments)||this;return e._totalPauseTime=0,e}return __extends(s,i),Object.defineProperty(s.prototype,"name",{get:function(){return"Registrar"},enumerable:!0,configurable:!0}),s.prototype.setPreprDataCalc=function(e){return this._preprDataCalc=e,this},s.prototype.setUriPreprocessor=function(e){return this._uriPreprocessor=e,this._tracker&&this._tracker.setPrepr(this._uriPreprocessor),this},s.prototype.setEventTime=function(e,r){return void 0===r&&(r=t.frame.token.tracker.time),this._eventTimes[e]=r,this},s.prototype.getEventTime=function(e){return this._eventTimes[e]},s.prototype.process=function(e){var i;i=this._preprDataCalc?this._preprDataCalc():this._contentData?r.prepr.def(this._contentData):{};var s=t.frame.token.tracker.time;return i.ctimestamp=s.toISOString(),r.prepr.process(e,i)},s.prototype.build=function(){return i.prototype.build.call(this),this._tracker=(new r.tracker.Tracker).setParent(this).setPrepr(this._uriPreprocessor).build(),this},s.prototype.appendUri=function(e,t){this._tracker.appendUri(e,t)},s.prototype.appendUriByTagName=function(t,r,i){var s=this;if(t){var n=t.getElementsByTagName(r);e.each(n,function(e){return s.appendUri(i,e.textContent)})}},s.prototype.appendProgressUri=function(e,t){this._tracker.appendProgressUri(e,t)},s.prototype.clear=function(){this._tracker.clear(),this.reset()},s.prototype.reset=function(){var t=this,i=this._eventTimes[r.trackings._breakLoaded];e.each(this._eventTimes,function(e,r){return t._eventTimes[r]=void 0}),this._eventTimes[r.trackings._breakLoaded]=i},s.prototype.register=function(e,t){void 0===t&&(t=void 0),r.trackings.allowMult(e)&&this._eventTimes[e]||(this.setEventTime(e),this._tracker.track(e,this._preprData(e,t)))},s.prototype.registerProgress=function(e,t){this.setEventTime(r.trackings.progress),this._tracker.trackProgress(e,t,this._preprData(r.trackings.progress))},s.prototype._preprData=function(e,t){var i;void 0===t&&(t=void 0),i=this._preprDataCalc?this._preprDataCalc():this._contentData?r.prepr.def(this._contentData):{};var s=this.getEventTime(e);return i.ctimestamp=s.toISOString(),i.delta=this._delta(e,s),t&&(i.ERRORCODE=t.errorcode,i.status=t.status,i.campaigns=t.campaigns),i},s.prototype._delta=function(t,i){var s,n=t;do{var a=n;s=(s=(n=this._linkedEvent(n))?this._eventTimes[n]:i)||(n===a?i:void 0)}while(!s);n||this._devstatTransmit(e.devstat.errDelta,t);var o=Math.floor((i.getTime()-s.getTime())/1e3);switch(t){case r.trackings.resume:n===r.trackings.pause&&(this._totalPauseTime+=o);break;case r.trackings.videoStart:case r.trackings.videoFirstQuartile:case r.trackings.videoMidpoint:case r.trackings.videoThridQuartile:case r.trackings.videoComplete:o-=this._totalPauseTime}return o},s.prototype._linkedEvent=function(e){switch(e){case r.trackings._frameInit:return r.trackings._tokenCreated;case r.trackings._vmapRequested:return r.trackings._frameInit;case r.trackings._vmapLoaded:return r.trackings._vmapRequested;case r.trackings._breakRequested:return r.trackings._vmapLoaded;case r.trackings._breakLoaded:return r.trackings._breakRequested;case r.trackings.select:return r.trackings._breakLoaded;case r.trackings.request:return r.trackings.select;case r.trackings.vastLoad:case r.trackings.impression:case r.trackings.start:return r.trackings.request;case r.trackings.error:return r.trackings.select;case r.trackings.creativeView:return r.trackings.start;case r.trackings.videoStart:case r.trackings.videoFirstQuartile:case r.trackings.videoMidpoint:case r.trackings.videoThridQuartile:case r.trackings.videoComplete:case r.trackings.mute:return r.trackings.creativeView;case r.trackings.unmute:return r.trackings.mute;case r.trackings.expand:return r.trackings.creativeView;case r.trackings.collapse:return r.trackings.expand;case r.trackings.playerExpand:return r.trackings.creativeView;case r.trackings.playerCollapse:return r.trackings.playerExpand;case r.trackings.clickThrough:case r.trackings.pause:return r.trackings.creativeView;case r.trackings.resume:return r.trackings.pause;case r.trackings.close:case r.trackings.skip:case r.trackings.acceptInvintation:case r.trackings.rewind:case r.trackings.progress:case r.trackings.viewable:case r.trackings.notViewable:return r.trackings.creativeView;case r.trackings.viewUndetermined:return r.trackings.request;default:return}},s}(t.AContentDataOwner),r.Registrar=i}(advark||(advark={})),function(e){var t,r,i,s;t=e.module||(e.module={}),r=t.manage||(t.manage={}),i=r.tracker||(r.tracker={}),s=function(i){function s(){var e=null!==i&&i.apply(this,arguments)||this;return e._trackings={},e._progressTrackings=[],e}return __extends(s,i),Object.defineProperty(s.prototype,"name",{get:function(){return"Tracker"},enumerable:!0,configurable:!0}),s.prototype.setPrepr=function(e){return this._prepr=e,this},s.prototype.appendUri=function(t,r){this._trackings[t]=this._trackings[t]||[];var i=this._trackings[t];if((r=r&&r.trim())&&""!==r){var n=new e.parser.Uri(r).domain;n&&(i.indexOf(r)>-1&&s._SelfDomains.indexOf(n)>-1||i.push(r))}},s.prototype.appendProgressUri=function(e,t){(t=t&&t.trim())&&""!==t&&this._progressTrackings.push({time:e,uri:t,sent:!1})},s.prototype.track=function(i,s){var n=this,a=this._trackings[i];if(a&&a.length>0){var o=[];e.each(a,function(e){return o.push(r.prepr.process(n._prepr?n._prepr(i,e):e,s))}),t.frame.client.track(o)}},s.prototype.trackProgress=function(e,i,s){var n=this._progressTrackings;if(n&&n.length>0){for(var a=[],o=0,d=n;o<d.length;o++){var c=d[o];!c.sent&&this._getTimeOffset(c.time,i)<1e3*e&&(c.sent=!0,a.push(r.prepr.process(c.uri,s)))}a.length>0&&t.frame.client.track(a)}},s.prototype.clear=function(){this._trackings={},this._progressTrackings=[]},s.prototype._getTimeOffset=function(t,r){var i=/(\d+)\%/.exec(t);return i?Number(i[1])/100*r*1e3:e.StringUtils.parseTime(t)},s._SelfDomains=["st.tyt.me","api.advarkads.com"],s}(e.base.factory.ABuildableItem),i.Tracker=s}(advark||(advark={})),function(e){var t,r,i;t=e.module||(e.module={}),r=t.frame||(t.frame={}),i=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.SetLocaLDomains=function(e){i._LocalDomains=e},i.SetConveyor=function(e){i._Conveyor=e},Object.defineProperty(i.prototype,"local",{get:function(){return this._local},enumerable:!0,configurable:!0}),i.prototype.setLocal=function(e){return this._local=e,this},i.prototype.send=function(){var s=e.spromise.deffer();return(this._local||-1!==i._LocalDomains.indexOf(new e.parser.Uri(this._uri).domain)?t.prototype.send.call(this):r.client.request(this._uri,this._credentrials,this._headers)).inspect(function(e,t){return i._Conveyor.append(function(){return t?s.resolve(e):s.reject(e)})}),s.promise},i}(e.request.Request),r.Request=i}(advark||(advark={})),function(e){var t;(function(r){var i,s=e.StringUtils.parseQueryString(window.location.href.split("?")[1]);(i=r.token||(r.token={})).tracker=(new e.token.Tracker).setTokenStr(s.token,Number(s.delta)).setLoader(function(e){return(new r.Request).setUri(e).setCredentials(!0).setLocal(!1).setHeaders({Accept:"text/plain"}).build().send()}).build();var n=(new t.sand.slave.Gateway).setOrigin(s.origin?s.origin:"*").build();r.Request.SetLocaLDomains("api.advarkads.com,apitest.advarkads.com".split(",")),r.Request.SetConveyor(n.conveyor),r.client=(new t.platform.ClientWrapper).setParent(n).setGateway(n).setChain(["advark"]).build(),e.spromise.all([n.whenConnect,i.tracker.whenLoad]).then(function(){var t=(new r.Frame).setParent(n).setIntegrationType(Number(s.module)).build();window.addEventListener("beforeunload",function(r){t.dispose(e.base.errors.Unload)},!0),window.addEventListener("unload",function(r){t.dispose(e.base.errors.Unload)},!0)})})((t=e.module||(e.module={})).frame||(t.frame={}))}(advark||(advark={}));
// a847947c
// 2018-02-14 15:22:28